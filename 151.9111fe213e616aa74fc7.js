/*! For license information please see 151.9111fe213e616aa74fc7.js.LICENSE.txt */
(self.webpackChunkresourcemanager=self.webpackChunkresourcemanager||[]).push([[151],{78923:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(64931),t)},64931:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorContextPreprocessSourceToDestination=void 0;const a=r(834),n=r(73564);class s extends a.ActorContextPreprocess{constructor(e){super(e)}async test(e){return!0}async run(e){if(e.context&&e.context.get(n.KeysRdfResolveQuadPattern.sources)&&!e.context.get(n.KeysRdfUpdateQuads.destination)){const t=e.context.get(n.KeysRdfResolveQuadPattern.sources);if(1===t.length)return{context:e.context.set(n.KeysRdfUpdateQuads.destination,t[0])}}return e}}t.ActorContextPreprocessSourceToDestination=s},87816:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(41950),t)},41950:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CONTEXT_DATETIME=t.ActorHttpMemento=void 0;const a=r(74864),n=r(73564);r(31905);const s=r(28490);class i extends a.ActorHttp{constructor(e){super(e)}async test(e){var t;if(!(e.context&&e.context.has(n.KeysHttpMemento.datetime)&&e.context.get(n.KeysHttpMemento.datetime)instanceof Date))throw new Error("This actor only handles request with a set valid datetime.");if(e.init&&new Headers(null!==(t=e.init.headers)&&void 0!==t?t:{}).has("accept-datetime"))throw new Error("The request already has a set datetime.");return!0}async run(e){var t;const r=e.init?Object.assign({},e.init):{},a=r.headers=new Headers(null!==(t=r.headers)&&void 0!==t?t:{});e.context&&e.context.has(n.KeysHttpMemento.datetime)&&a.append("accept-datetime",e.context.get(n.KeysHttpMemento.datetime).toUTCString());const i={context:e.context,input:e.input,init:r},p=await this.mediatorHttp.mediate(i);if(a.has("accept-datetime")&&p.headers&&!p.headers.has("memento-datetime")){const t=p.headers.has("link")&&s(p.headers.get("link"));if(t&&t.timegate){p.body&&await p.body.cancel();const a={context:e.context,input:t.timegate.url,init:r};return this.mediatorHttp.mediate(a)}}return p}}t.ActorHttpMemento=i,t.KEY_CONTEXT_DATETIME=n.KeysHttpMemento.datetime},14790:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(37547),t)},37547:(e,t,r)=>{"use strict";var a=r(34155);Object.defineProperty(t,"__esModule",{value:!0}),t.ActorHttpNodeFetch=void 0;const n=r(74864),s=r(73564);r(31905);const i=r(50752);class p extends n.ActorHttp{constructor(e){super(e),this.userAgent=p.createUserAgent(),this.fetchInitPreprocessor=new i.FetchInitPreprocessor(e.agentOptions?JSON.parse(e.agentOptions):void 0)}static createUserAgent(){return`Comunica/actor-http-node-fetch (${void 0===r.g.navigator?`Node.js ${a.version}; ${a.platform}`:`Browser-${r.g.navigator.userAgent}`})`}async test(e){return{time:Number.POSITIVE_INFINITY}}run(e){var t;const r=e.init&&e.init.headers||{};return e.init=e.init?e.init:{},e.init.headers=new Headers(r),e.init.headers.has("user-agent")||e.init.headers.append("user-agent",this.userAgent),e.context&&e.context.get(s.KeysHttp.auth)&&e.init.headers.append("Authorization",`Basic ${Buffer.from(e.context.get(s.KeysHttp.auth)).toString("base64")}`),this.logInfo(e.context,`Requesting ${"string"==typeof e.input?e.input:e.input.url}`,(()=>({headers:n.ActorHttp.headersToHash(new Headers(e.init.headers)),method:e.init.method||"GET"}))),((null===(t=e.context)||void 0===t?void 0:t.get(s.KeysHttp.fetch))||fetch)(e.input,this.fetchInitPreprocessor.handle(Object.assign(Object.assign({},e.init),e.context&&e.context.get(s.KeysHttp.includeCredentials)?{credentials:"include"}:{}))).then((e=>(e.body&&!e.body.cancel&&(e.body.cancel=async t=>e.body.destroy(t)),e)))}}t.ActorHttpNodeFetch=p},50752:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FetchInitPreprocessor=void 0,t.FetchInitPreprocessor=class{handle(e){return Object.assign({keepalive:!0},e)}}},10697:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(87862),t),n(r(18329),t),n(r(31270),t)},87862:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CONTEXT_HTTPPROXYHANDLER=t.ActorHttpProxy=void 0;const a=r(74864),n=r(73564);class s extends a.ActorHttp{constructor(e){super(e)}async test(e){if(!e.context)throw new Error(`Actor ${this.name} could not find a context.`);const t=e.context.get(n.KeysHttpProxy.httpProxyHandler);if(!t)throw new Error(`Actor ${this.name} could not find a proxy handler in the context.`);if(!await t.getProxy(e))throw new Error(`Actor ${this.name} could not determine a proxy for the given request.`);return{time:Number.POSITIVE_INFINITY}}async run(e){const t="string"==typeof e.input?e.input:e.input.url;if(!e.context)throw new Error("Illegal state: missing context");const r=e.context.get(n.KeysHttpProxy.httpProxyHandler),a=await this.mediatorHttp.mediate(Object.assign(Object.assign({},await r.getProxy(e)),{context:e.context.delete(n.KeysHttpProxy.httpProxyHandler)}));return Object.defineProperty(a,"url",{configurable:!0,enumerable:!0,get:()=>{var e;return null!==(e=a.headers.get("x-final-url"))&&void 0!==e?e:t}}),a}}t.ActorHttpProxy=s,t.KEY_CONTEXT_HTTPPROXYHANDLER=n.KeysHttpProxy.httpProxyHandler},18329:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},31270:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyHandlerStatic=void 0,t.ProxyHandlerStatic=class{constructor(e){this.prefixUrl=e}async getProxy(e){return{init:e.init,input:this.modifyInput(e.input)}}modifyInput(e){return"string"==typeof e?this.prefixUrl+e:new Request(this.prefixUrl+e.url,e)}}},40488:(e,t,r)=>{const a=new(r(94292).LoggerVoid)(void 0),n=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-init/Bus/Init"}),s=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http/Bus/Http"}),i=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-join/Bus/RdfJoin"}),p=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-parse/Bus/RdfParse"}),o=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-dereference/Bus/RdfDereference"}),c=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-parse-html/Bus/RdfParseHtml"}),u=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-serialize/Bus/RdfSerialize"}),l=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata/Bus/RdfMetadata"}),d=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-metadata-extract/Bus/RdfMetadataExtract"}),y=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-hypermedia/Bus/RdfUpdateHypermedia"}),f=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-http-invalidate/Bus/HttpInvalidate"}),h=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-quads/Bus/RdfUpdateQuads"}),m=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-quad-pattern/Bus/RdfResolveQuadPattern"}),g=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-hypermedia/Bus/RdfResolveHypermedia"}),E=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-hypermedia-links/Bus/RdfResolveHypermediaLinks"}),b=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-resolve-hypermedia-links-queue/Bus/RdfResolveHypermediaLinksQueue"}),T=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-optimize-query-operation/Bus/OptimizeQueryOperation"}),O=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-sparql-parse/Bus/SparqlParse"}),R=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-sparql-serialize/Bus/SparqlSerialize"}),S=new(r(41709).Bus)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-context-preprocess/Bus/ContextPreprocess"}),v=new(r(41709).BusIndexed)({actorIdentifierFields:["operationName"],actionIdentifierFields:["operation","type"],name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-query-operation/Bus/QueryOperation"}),w=new(r(99114).MediatorNumber)({field:"time",type:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/mediator-number/Mediator/Number/type/TypeMin",ignoreErrors:!0,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/http.json#mediatorHttp",bus:s}),P=new(r(14790).ActorHttpNodeFetch)({agentOptions:'{ "keepAlive": true, "maxSockets": 5 }',name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/http.json#myHttpFetcher",bus:s}),A=new(r(69390).ActionObserverHttp)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-sparql-serialize-stats/Actor/SparqlSerialize/Stats/httpObserver/default",bus:s}),x=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#mediatorRdfJoin",bus:i}),j=(new(r(94357).ActorRdfJoinSymmetricHash)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/join.json#myRdfJoinActorSymmetricHash",bus:i}),new(r(53836).ActorRdfJoinNestedLoop)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/join.json#myRdfJoinActorNestedLoop",bus:i}),new(r(66479).MediatorCombineUnion)({field:"mediaTypes",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-dereference.json#mediatorRdfParseMediatypes",bus:p})),N=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-dereference.json#mediatorRdfParseHandle",bus:p}),_=(new(r(45521).ActorRdfParseN3)({mediaTypes:{"application/n-quads":"1.0","application/trig":"0.95","application/n-triples":"0.8","text/turtle":"0.6","text/n3":"0.35"},mediaTypeFormats:{"application/n-quads":"http://www.w3.org/ns/formats/N-Quads","application/trig":"http://www.w3.org/ns/formats/TriG","application/n-triples":"http://www.w3.org/ns/formats/N-Triples","text/turtle":"http://www.w3.org/ns/formats/Turtle","text/n3":"http://www.w3.org/ns/formats/N3"},priorityScale:"1",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserN3",bus:p}),new(r(58128).ActorRdfParseRdfXml)({mediaTypes:{"application/rdf+xml":"1.0"},mediaTypeFormats:{"application/rdf+xml":"http://www.w3.org/ns/formats/RDF_XML"},priorityScale:"5.0E-1",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserRdfXml",bus:p}),new(r(5722).ActorRdfParseXmlRdfa)({mediaTypes:{"application/xml":"1.0","text/xml":"1.0","image/svg+xml":"1.0"},mediaTypeFormats:{"application/xml":"http://www.w3.org/ns/formats/RDFa","text/xml":"http://www.w3.org/ns/formats/RDFa","image/svg+xml":"http://www.w3.org/ns/formats/RDFa"},priorityScale:"3.0E-1",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserXmlRdfa",bus:p}),new(r(66479).MediatorCombineUnion)({field:"mediaTypes",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#mediatorRdfParseMediatypes",bus:p})),I=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#mediatorRdfParseHandle",bus:p}),C=new(r(202).ActorRdfDereferenceFallback)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-dereference.json#myRdfDereferencerFallback",bus:o}),D=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#mediatorRdfDereference",bus:o}),q=(new(r(96222).ActorRdfParseHtml)({busRdfParseHtml:c,mediaTypes:{"text/html":"1.0","application/xhtml+xml":"0.9"},mediaTypeFormats:{"text/html":"http://www.w3.org/ns/formats/HTML","application/xhtml+xml":"http://www.w3.org/ns/formats/HTML"},priorityScale:"2.0E-1",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserHtml",bus:p}),new(r(66328).ActorRdfParseHtmlMicrodata)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserHtmlMicrodata",bus:c}),new(r(88628).ActorRdfParseHtmlRdfa)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserHtmlRdfa",bus:c}),new(r(80637).ActorRdfSerializeN3)({mediaTypes:{"application/trig":"1.0","application/n-quads":"0.7","text/turtle":"0.6","application/n-triples":"0.3","text/n3":"0.2"},mediaTypeFormats:{"application/trig":"http://www.w3.org/ns/formats/TriG","application/n-quads":"http://www.w3.org/ns/formats/N-Quads","text/turtle":"http://www.w3.org/ns/formats/Turtle","application/n-triples":"http://www.w3.org/ns/formats/N-Triples","text/n3":"http://www.w3.org/ns/formats/N3"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-serializers.json#myRdfSerializerN3",bus:u}),new(r(87489).ActorRdfSerializeJsonLd)({jsonStringifyIndentSpaces:2,mediaTypes:{"application/ld+json":"1.0"},mediaTypeFormats:{"application/ld+json":"http://www.w3.org/ns/formats/JSON-LD"},priorityScale:"9.0E-1",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-serializers.json#myRdfSerializeJsonLd",bus:u}),new(r(66479).MediatorCombineUnion)({field:"mediaTypes",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#mediatorRdfSerializeMediatypes",bus:u})),M=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#mediatorRdfSerialize",bus:u}),L=new(r(66479).MediatorCombineUnion)({field:"mediaTypeFormats",name:"df_757_0",bus:u}),k=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#mediatorMetadata",bus:l}),U=(new(r(72349).ActorRdfMetadataPrimaryTopic)({metadataToData:!1,dataToMetadataOnInvalidMetadataGraph:!0,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myRdfMetadataPrimaryTopic",bus:l}),new(r(11361).ActorRdfMetadataAll)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myRdfMetadataAll",bus:l}),new(r(66479).MediatorCombineUnion)({field:"metadata",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#mediatorMetadataExtract",bus:d})),G=(new(r(18259).ActorRdfMetadataExtractPatchSparqlUpdate)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myRdfMetadataExtractPatchSparqlUpdate",bus:d}),new(r(60148).ActorRdfMetadataExtractAllowHttpMethods)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myRdfMetadataExtractAllowHttpMethods",bus:d}),new(r(18085).ActorRdfMetadataExtractPutAccepted)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myRdfMetadataExtractPutAccepted",bus:d}),new(r(61951).ActorRdfMetadataExtractHydraControls)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myRdfMetadataExtractHydraControls",bus:d}),new(r(60623).ActorRdfMetadataExtractHydraCount)({predicates:["http://www.w3.org/ns/hydra/core#totalItems","http://rdfs.org/ns/void#triples"],name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myRdfMetadataExtractHydraCount",bus:d}),new(r(76424).ActorRdfMetadataExtractSparqlService)({inferHttpsEndpoint:!0,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-sparql.json#myRdfMetadataExtractSparqlService",bus:d}),new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-update-rdfjs.json#mediatorRdfUpdateHypermedia",bus:y})),H=new(r(87941).ActorHttpInvalidateListenable)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/bus-rdf-update-quads/Actor/RdfUpdateQuads/Hypermedia/httpInvalidator#default",bus:f}),B=new(r(87941).ActorHttpInvalidateListenable)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-rdf-resolve-quad-pattern-hypermedia/Actor/RdfResolveQuadPattern/Hypermedia/httpInvalidator#default",bus:f}),F=new(r(27930).MediatorAll)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-init.json#mediatorHttpInvalidate",bus:f}),Q=(new(r(25639).ActorRdfUpdateQuadsRdfJsStore)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-update-rdfjs.json#myRdfUpdateQuadsRdfJsStore",bus:h}),new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-update.json#mediatorUpdateQuads",bus:h})),J=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#mediatorResolveQuadPattern",bus:m}),V=(new(r(20598).ActorRdfResolveQuadPatternRdfJsSource)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-rdfjs.json#myRdfRdfJsSourceQuadPatternResolver",bus:m}),new(r(60355).ActorRdfResolveHypermediaNone)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myHypermediaNoneResolver",bus:g}),new(r(99114).MediatorNumber)({field:"filterFactor",type:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/mediator-number/Mediator/Number/type/TypeMax",ignoreErrors:!0,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#mediatorRdfResolveHypermedia",bus:g})),X=new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#mediatorRdfResolveHypermediaLinks",bus:E}),$=(new(r(64187).ActorRdfResolveHypermediaLinksNext)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myHypermediaLinksNext",bus:E}),new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#mediatorRdfResolveHypermediaLinksQueue",bus:b})),K=(new(r(87386).ActorRdfResolveHypermediaLinksQueueFifo)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myHypermediaLinksQueue",bus:b}),new(r(64437).MediatorCombinePipeline)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-init.json#mediatorOptimizeQueryOperation",bus:T})),Z=(new(r(85688).ActorOptimizeQueryOperationJoinBgp)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-optimize.json#myJoinBgpOptimizer",bus:T}),new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-init.json#mediatorSparqlParse",bus:O})),z=(new(r(50529).ActorSparqlParseGraphql)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/graphql-parsers.json#myGraphqlParser",bus:O}),new(r(6051).ActorSparqlParseAlgebra)({prefixes:{rdf:"http://www.w3.org/1999/02/22-rdf-syntax-ns#",rdfs:"http://www.w3.org/2000/01/rdf-schema#",owl:"http://www.w3.org/2002/07/owl#",xsd:"http://www.w3.org/2001/XMLSchema#",dc:"http://purl.org/dc/terms/",dcterms:"http://purl.org/dc/terms/",dc11:"http://purl.org/dc/elements/1.1/",foaf:"http://xmlns.com/foaf/0.1/",geo:"http://www.w3.org/2003/01/geo/wgs84_pos#",dbpedia:"http://dbpedia.org/resource/","dbpedia-owl":"http://dbpedia.org/ontology/",dbpprop:"http://dbpedia.org/property/",schema:"http://schema.org/",skos:"http://www.w3.org/2008/05/skos#"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-parsers.json#mySparqlParser",bus:O}),new(r(26277).MediatorRace)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-init.json#mediatorSparqlSerialize",bus:R})),Y=new(r(66479).MediatorCombineUnion)({field:"mediaTypes",name:"df_743_0",bus:R}),W=new(r(66479).MediatorCombineUnion)({field:"mediaTypeFormats",name:"df_743_1",bus:R}),ee=(new(r(40677).ActorSparqlSerializeJson)({mediaTypes:{"application/json":"1.0"},mediaTypeFormats:{"application/json":"https://comunica.linkeddatafragments.org/#results_JSON"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#myJsonSparqlSerializer",bus:R}),new(r(88519).ActorSparqlSerializeSimple)({mediaTypes:{simple:"0.9"},mediaTypeFormats:{simple:"https://comunica.linkeddatafragments.org/#results_simple"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#mySimpleSparqlSerializer",bus:R}),new(r(21965).ActorSparqlSerializeSparqlCsv)({mediaTypes:{"text/csv":"0.75"},mediaTypeFormats:{"text/csv":"http://www.w3.org/ns/formats/SPARQL_Results_CSV"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#mySparqlCsvSparqlSerializer",bus:R}),new(r(14897).ActorSparqlSerializeSparqlJson)({mediaTypes:{"application/sparql-results+json":"0.8"},mediaTypeFormats:{"application/sparql-results+json":"http://www.w3.org/ns/formats/SPARQL_Results_JSON"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#mySparqlJsonSparqlSerializer",bus:R}),new(r(31052).ActorSparqlSerializeSparqlTsv)({mediaTypes:{"text/tab-separated-values":"0.75"},mediaTypeFormats:{"text/tab-separated-values":"http://www.w3.org/ns/formats/SPARQL_Results_TSV"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#mySparqlTsvSparqlSerializer",bus:R}),new(r(3597).ActorSparqlSerializeSparqlXml)({mediaTypes:{"application/sparql-results+xml":"0.8"},mediaTypeFormats:{"application/sparql-results+xml":"http://www.w3.org/ns/formats/SPARQL_Results_XML"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#mySparqlXmlSparqlSerializer",bus:R}),new(r(26124).ActorSparqlSerializeTable)({columnWidth:50,mediaTypes:{table:"0.6"},mediaTypeFormats:{table:"https://comunica.linkeddatafragments.org/#results_table"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#myTableSparqlSerializer",bus:R}),new(r(21619).ActorSparqlSerializeTree)({mediaTypes:{tree:"0.5"},mediaTypeFormats:{tree:"https://comunica.linkeddatafragments.org/#results_tree"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#myTreeSparqlSerializer",bus:R}),new(r(64437).MediatorCombinePipeline)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-init.json#mediatorContextPreprocess",bus:S})),te=(new(r(78923).ActorContextPreprocessSourceToDestination)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-update.json#myActorContextPreprocessSourceToDestination",bus:S}),new(r(99114).MediatorNumber)({field:"httpRequests",type:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/mediator-number/Mediator/Number/type/TypeMin",ignoreErrors:!0,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#mediatorQueryOperation",bus:v})),re=(new(r(23833).ActorQueryOperationBgpEmpty)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myEmptyBgpQueryOperator",bus:v}),new(r(70963).ActorQueryOperationValues)({name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myValuesQueryOperator",bus:v}),new(r(66036).ActorRdfParseJsonLd)({mediatorHttp:w,mediaTypes:{"application/ld+json":"1.0","application/json":"0.5"},mediaTypeFormats:{"application/ld+json":"http://www.w3.org/ns/formats/JSON-LD","application/json":"http://www.w3.org/ns/formats/JSON-LD"},priorityScale:"9.0E-1",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserJsonLd",bus:p}),new(r(26571).ActorRdfUpdateHypermediaPatchSparqlUpdate)({mediatorHttp:w,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-update-rdfjs.json#myRdfUpdateHypermediaPatchSparqlUpdate",bus:y}),new(r(22951).ActorRdfUpdateHypermediaSparql)({mediatorHttp:w,checkUrlSuffixSparql:!0,checkUrlSuffixUpdate:!0,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-update-rdfjs.json#myRdfUpdateHypermediaSparql",bus:y}),new(r(60298).ActorRdfResolveHypermediaSparql)({mediatorHttp:w,checkUrlSuffix:!0,forceHttpGet:!1,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-sparql.json#mySparqlQuadPatternResolver",bus:g}),new(r(1514).ActorQueryOperationSparqlEndpoint)({mediatorHttp:w,forceHttpGet:!1,checkUrlSuffixSparql:!0,checkUrlSuffixUpdate:!0,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-sparql.json#mySparqlEndpointResolver",bus:v}),new(r(69390).ActorSparqlSerializeStats)({httpObserver:A,mediaTypes:{stats:"0.5"},mediaTypeFormats:{stats:"https://comunica.linkeddatafragments.org/#results_stats"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#myStatsSparqlSerializer",bus:R}),new(r(86474).ActorRdfJoinMultiSmallest)({mediatorJoin:x,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/join.json#myRdfJoinMultiActor",bus:i}),new(r(71598).ActorRdfParseHtmlScript)({mediatorRdfParseMediatypes:_,mediatorRdfParseHandle:I,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-parsers.json#myRdfParserHtmlScript",bus:c}),new(r(5208).ActorRdfUpdateHypermediaPutLdp)({mediatorHttp:w,mediatorRdfSerializeMediatypes:q,mediatorRdfSerialize:M,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-update-rdfjs.json#myRdfUpdateHypermediaPutLdp",bus:y}),new(r(90611).ActorSparqlSerializeRdf)({mediatorRdfSerialize:M,mediatorMediaTypeCombiner:q,mediatorMediaTypeFormatCombiner:L,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-serializers.json#myRdfSparqlSerializer",bus:R}),new(r(366).ActorRdfResolveHypermediaQpf)({mediatorMetadata:k,mediatorMetadataExtract:U,mediatorRdfDereference:D,subjectUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#subject",predicateUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#predicate",objectUri:"http://www.w3.org/1999/02/22-rdf-syntax-ns#object",graphUri:"http://www.w3.org/ns/sparql-service-description#graph",name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myHypermediaQpfResolver",bus:g}),new(r(71664).ActorRdfUpdateQuadsHypermedia)({mediatorRdfDereference:D,mediatorMetadata:k,mediatorMetadataExtract:U,mediatorRdfUpdateHypermedia:G,cacheSize:100,httpInvalidator:H,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-update-rdfjs.json#myRdfUpdateQuadsHypermedia",bus:h}),new(r(84280).ActorRdfResolveQuadPatternFederated)({mediatorResolveQuadPattern:J,skipEmptyPatterns:!1,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-federated.json#myFederatedQuadPatternResolver",bus:m}),new(r(78010).ActorQueryOperationQuadpattern)({mediatorResolveQuadPattern:J,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myQuadPatternQueryOperator",bus:v}),new(r(26261).ActorRdfResolveQuadPatternHypermedia)({mediatorRdfDereference:D,mediatorMetadata:k,mediatorMetadataExtract:U,mediatorRdfResolveHypermedia:V,mediatorRdfResolveHypermediaLinks:X,mediatorRdfResolveHypermediaLinksQueue:$,cacheSize:100,httpInvalidator:B,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/resolve-hypermedia.json#myQuadPatternHypermediaResolver",bus:m}),new(r(87816).ActorHttpMemento)({mediatorHttp:w,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/http-memento.json#myHttpFetcher",bus:s,beforeActors:[P]}),new(r(10697).ActorHttpProxy)({mediatorHttp:w,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/http.json#myHttpProxy",bus:s,beforeActors:[P]}),new(r(3657).ActorRdfDereferenceHttpParse)({mediatorHttp:w,mediatorRdfParseMediatypes:j,mediatorRdfParseHandle:N,maxAcceptHeaderLength:1024,maxAcceptHeaderLengthBrowser:128,mediaMappings:{ttl:"text/turtle",turtle:"text/turtle",nt:"application/n-triples",ntriples:"application/n-triples",nq:"application/n-quads",nquads:"application/n-quads",rdf:"application/rdf+xml",rdfxml:"application/rdf+xml",owl:"application/rdf+xml",n3:"text/n3",trig:"application/trig",jsonld:"application/ld+json",json:"application/json",html:"text/html",htm:"text/html",xhtml:"application/xhtml+xml",xht:"application/xhtml+xml",xml:"application/xml",svg:"image/svg+xml",svgz:"image/svg+xml"},name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/rdf-dereference.json#myRdfDereferencer",bus:o,beforeActors:[C]}),new(r(36875).ActorInitSparql)({mediatorOptimizeQueryOperation:K,mediatorQueryOperation:te,mediatorSparqlParse:Z,mediatorSparqlSerialize:z,mediatorSparqlSerializeMediaTypeCombiner:Y,mediatorSparqlSerializeMediaTypeFormatCombiner:W,mediatorContextPreprocess:ee,mediatorHttpInvalidate:F,logger:a,contextKeyShortcuts:{source:"@comunica/bus-rdf-resolve-quad-pattern:source",sources:"@comunica/bus-rdf-resolve-quad-pattern:sources",destination:"@comunica/bus-rdf-update-quads:destination",initialBindings:"@comunica/actor-init-sparql:initialBindings",queryFormat:"@comunica/actor-init-sparql:queryFormat",baseIRI:"@comunica/actor-init-sparql:baseIRI",log:"@comunica/core:log",datetime:"@comunica/actor-http-memento:datetime",queryTimestamp:"@comunica/actor-init-sparql:queryTimestamp",httpProxyHandler:"@comunica/actor-http-proxy:httpProxyHandler",lenient:"@comunica/actor-init-sparql:lenient",httpIncludeCredentials:"@comunica/bus-http:include-credentials",httpAuth:"@comunica/bus-http:auth",fetch:"@comunica/bus-http:fetch",readOnly:"@comunica/bus-query-operation:readOnly",extensionFunctions:"@comunica/actor-init-sparql:extensionFunctions",extensionFunctionCreator:"@comunica/actor-init-sparql:extensionFunctionCreator"},name:"urn:comunica:sparqlinit",bus:n}));new(r(71009).ActorQueryOperationAsk)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myAskQueryOperator",bus:v}),new(r(12885).ActorQueryOperationService)({forceSparqlEndpoint:!1,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myServiceQueryOperator",bus:v}),new(r(32299).ActorQueryOperationSlice)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#mySliceQueryOperator",bus:v}),new(r(78640).ActorQueryOperationBgpSingle)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#mySingleBgpQueryOperator",bus:v}),new(r(59844).ActorQueryOperationBgpLeftDeepSmallest)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myLeftDeepSmallestBgpQueryOperator",bus:v}),new(r(41825).ActorQueryOperationConstruct)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myConstructQueryOperator",bus:v}),new(r(54111).ActorQueryOperationDescribeSubject)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myDescribeQueryOperator",bus:v}),new(r(836).ActorQueryOperationDistinctHash)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myDistinctQueryOperator",bus:v}),new(r(50776).ActorQueryOperationExtend)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myExtendQueryOperator",bus:v}),new(r(76790).ActorQueryOperationReducedHash)({cacheSize:100,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myReducedQueryOperator",bus:v}),new(r(89190).ActorQueryOperationFilterSparqlee)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myFilterQueryOperator",bus:v}),new(r(88642).ActorQueryOperationFromQuad)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myFromQueryOperator",bus:v}),new(r(68834).ActorQueryOperationGroup)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myGroupQueryOperator",bus:v}),new(r(21318).ActorQueryOperationJoin)({mediatorJoin:x,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myJoinQueryOperator",bus:v}),new(r(62299).ActorQueryOperationLeftJoinLeftDeep)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myLeftJoinQueryOperator",bus:v}),new(r(71293).ActorQueryOperationOrderBySparqlee)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myOrderByQueryOperator",bus:v}),new(r(80651).ActorQueryOperationProject)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myProjectQueryOperator",bus:v}),new(r(75766).ActorQueryOperationUnion)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myUnionQueryOperator",bus:v}),new(r(85609).ActorQueryOperationMinus)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myMinusQueryOperator",bus:v}),new(r(43411).ActorQueryOperationNop)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myNopQueryOperator",bus:v}),new(r(70540).ActorQueryOperationPathAlt)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#myAltPathOperator",bus:v}),new(r(29986).ActorQueryOperationPathInv)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#myInvPathOperator",bus:v}),new(r(27667).ActorQueryOperationPathLink)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#myLinkPathOperator",bus:v}),new(r(78030).ActorQueryOperationPathNps)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#myNpsPathOperator",bus:v}),new(r(71828).ActorQueryOperationPathOneOrMore)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#myOneOrMorePathOperator",bus:v}),new(r(32687).ActorQueryOperationPathSeq)({mediatorJoin:x,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#mySeqPathOperator",bus:v}),new(r(25665).ActorQueryOperationPathZeroOrMore)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#myZeroOrMorePathOperator",bus:v}),new(r(67521).ActorQueryOperationPathZeroOrOne)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-path.json#myZeroOrOnePathOperator",bus:v}),new(r(64207).ActorQueryOperationUpdateCompositeUpdate)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-update.json#myCompositeUpdateOperator",bus:v}),new(r(96595).ActorQueryOperationUpdateDeleteInsert)({mediatorUpdateQuads:Q,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-update.json#myDeleteInsertOperator",bus:v}),new(r(55295).ActorQueryOperationLoad)({mediatorUpdateQuads:Q,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myLoadQueryOperator",bus:v}),new(r(28034).ActorQueryOperationClear)({mediatorUpdateQuads:Q,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myClearQueryOperator",bus:v}),new(r(287).ActorQueryOperationDrop)({mediatorUpdateQuads:Q,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myDropQueryOperator",bus:v}),new(r(7632).ActorQueryOperationCreate)({mediatorUpdateQuads:Q,mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperators.json#myCreateQueryOperator",bus:v}),new(r(73569).ActorQueryOperationAddRewrite)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-update.json#myAddOperator",bus:v}),new(r(63260).ActorQueryOperationMoveRewrite)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-update.json#myMoveOperator",bus:v}),new(r(86585).ActorQueryOperationCopyRewrite)({mediatorQueryOperation:te,name:"https://linkedsoftwaredependencies.org/bundles/npm/@comunica/actor-init-sparql/^1.0.0/config/sets/sparql-queryoperator-update.json#myCopyOperator",bus:v}),e.exports=re},36875:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.evaluateQuery=t.newEngine=t.bindingsStreamToGraphQl=void 0,n(r(7345),t);var s=r(21619);function i(){return r(40488)}Object.defineProperty(t,"bindingsStreamToGraphQl",{enumerable:!0,get:function(){return s.bindingsStreamToGraphQl}}),t.newEngine=i,t.evaluateQuery=function(e,t){return i().query(e,t)}},7345:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CONTEXT_QUERY=t.KEY_CONTEXT_LENIENT=t.KEY_CONTEXT_GRAPHQL_SINGULARIZEVARIABLES=t.KEY_CONTEXT_QUERYFORMAT=t.KEY_CONTEXT_INITIALBINDINGS=t.ActorInitSparql=void 0;const a=r(98147),n=r(67213),s=r(28575),i=r(73564),p=r(41709),o=r(69132);class c extends a.ActorInit{constructor(e){super(e)}static enhanceQueryResults(e){return e.bindingsStream?e.bindings=()=>new Promise(((t,r)=>{const a=[];e.bindingsStream.on("data",(e=>{a.push(e)})),e.bindingsStream.on("end",(()=>{t(a)})),e.bindingsStream.on("error",r)})):e.quadStream&&(e.quads=()=>new Promise(((t,r)=>{const a=[];e.quadStream.on("data",(e=>{a.push(e)})),e.quadStream.on("end",(()=>{t(a)})),e.quadStream.on("error",r)}))),e}async test(e){return!0}async query(e,t){t=t||{};for(const e in t)if(this.contextKeyShortcuts[e]){const r=t[e];t[this.contextKeyShortcuts[e]]=r,delete t[e]}t[i.KeysCore.log]||(t[i.KeysCore.log]=this.logger),t[i.KeysInitSparql.queryTimestamp]||(t[i.KeysInitSparql.queryTimestamp]=new Date),Array.isArray(t[i.KeysRdfResolveQuadPattern.sources])&&t[i.KeysRdfResolveQuadPattern.sources].forEach((e=>{s.isDataSourceRawType(e)||"auto"!==e.type&&"hypermedia"!==e.type||delete e.type}));let r,a,o="sparql";if((t=p.ActionContext(t))&&t.has(i.KeysInitSparql.queryFormat)&&(o=t.get(i.KeysInitSparql.queryFormat),t=t.delete(i.KeysInitSparql.queryFormat),"graphql"!==o||t.has(i.KeysInitSparql.graphqlSingularizeVariables)||(t=t.set(i.KeysInitSparql.graphqlSingularizeVariables,{}))),t&&t.has(i.KeysInitSparql.baseIRI)&&(r=t.get(i.KeysInitSparql.baseIRI)),t=(await this.mediatorContextPreprocess.mediate({context:t})).context,"string"==typeof e){const n=await this.mediatorSparqlParse.mediate({context:t,query:e,queryFormat:o,baseIRI:r});a=n.operation,n.baseIRI&&(t=t.set(i.KeysInitSparql.baseIRI,n.baseIRI))}else a=e;if(t.has(i.KeysInitSparql.initialBindings)){const e=t.get(i.KeysInitSparql.initialBindings);a=n.materializeOperation(a,n.ensureBindings(e))}const u=await this.mediatorOptimizeQueryOperation.mediate({context:t,operation:a});a=u.operation;const l={context:t=(t=u.context||t).set(i.KeysInitSparql.query,a),operation:a};let d=await this.mediatorQueryOperation.mediate(l);return d=c.enhanceQueryResults(d),d.context=t,d}async getResultMediaTypes(e){return(await this.mediatorSparqlSerializeMediaTypeCombiner.mediate({context:e,mediaTypes:!0})).mediaTypes}async getResultMediaTypeFormats(e){return(await this.mediatorSparqlSerializeMediaTypeFormatCombiner.mediate({context:e,mediaTypeFormats:!0})).mediaTypeFormats}async resultToString(e,t,r){if(r=p.ActionContext(r),!t)switch(e.type){case"bindings":t="application/json";break;case"quads":t="application/trig";break;default:t="simple"}const a=e;return a.context=r,(await this.mediatorSparqlSerialize.mediate({context:r,handle:a,handleMediaType:t})).handle}invalidateHttpCache(e){return this.mediatorHttpInvalidate.mediate({url:e})}async run(e){throw new Error("ActorInitSparql#run is not supported in the browser.")}}t.ActorInitSparql=c,c.ALGEBRA_TYPES=Object.keys(o.Algebra.types).reduce(((e,t)=>(e[o.Algebra.types[t]]=!0,e)),{}),t.KEY_CONTEXT_INITIALBINDINGS=i.KeysInitSparql.initialBindings,t.KEY_CONTEXT_QUERYFORMAT=i.KeysInitSparql.queryFormat,t.KEY_CONTEXT_GRAPHQL_SINGULARIZEVARIABLES=i.KeysInitSparql.graphqlSingularizeVariables,t.KEY_CONTEXT_LENIENT=i.KeysInitSparql.lenient,t.KEY_CONTEXT_QUERY=i.KeysInitSparql.query},69132:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.toSparqlJs=t.toSparql=t.Factory=t.Algebra=t.translate=void 0;const a=r(41152);t.translate=a.default;const n=r(25299);t.Algebra=n;const s=r(97100);t.Factory=s.default;const i=r(20060);Object.defineProperty(t,"toSparql",{enumerable:!0,get:function(){return i.toSparql}}),Object.defineProperty(t,"toSparqlJs",{enumerable:!0,get:function(){return i.toSparqlJs}});const p=r(13489);t.Util=p.default},25299:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expressionTypes=t.types=void 0,t.types={ALT:"alt",ASK:"ask",BGP:"bgp",CONSTRUCT:"construct",DESC:"desc",DESCRIBE:"describe",DISTINCT:"distinct",EXPRESSION:"expression",EXTEND:"extend",FILTER:"filter",FROM:"from",GRAPH:"graph",GROUP:"group",INV:"inv",JOIN:"join",LEFT_JOIN:"leftjoin",LINK:"link",MINUS:"minus",NOP:"nop",NPS:"nps",ONE_OR_MORE_PATH:"OneOrMorePath",ORDER_BY:"orderby",PATH:"path",PATTERN:"pattern",PROJECT:"project",REDUCED:"reduced",SEQ:"seq",SERVICE:"service",SLICE:"slice",UNION:"union",VALUES:"values",ZERO_OR_MORE_PATH:"ZeroOrMorePath",ZERO_OR_ONE_PATH:"ZeroOrOnePath",COMPOSITE_UPDATE:"compositeupdate",DELETE_INSERT:"deleteinsert",LOAD:"load",CLEAR:"clear",CREATE:"create",DROP:"drop",ADD:"add",MOVE:"move",COPY:"copy"},t.expressionTypes={AGGREGATE:"aggregate",EXISTENCE:"existence",NAMED:"named",OPERATOR:"operator",TERM:"term",WILDCARD:"wildcard"}},97100:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(25299),n=r(41640),s=r(22086),i=r(9619);t.default=class{constructor(e){this.dataFactory=e||new n.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(e,t){return{type:a.types.ALT,left:e,right:t}}createAsk(e){return{type:a.types.ASK,input:e}}createBoundAggregate(e,t,r,a,n){let s=this.createAggregateExpression(t,r,a,n);return s.variable=e,s}createBgp(e){return{type:a.types.BGP,patterns:e}}createConstruct(e,t){return{type:a.types.CONSTRUCT,input:e,template:t}}createDescribe(e,t){return{type:a.types.DESCRIBE,input:e,terms:t}}createDistinct(e){return{type:a.types.DISTINCT,input:e}}createExtend(e,t,r){return{type:a.types.EXTEND,input:e,variable:t,expression:r}}createFrom(e,t,r){return{type:a.types.FROM,input:e,default:t,named:r}}createFilter(e,t){return{type:a.types.FILTER,input:e,expression:t}}createGraph(e,t){return{type:a.types.GRAPH,input:e,name:t}}createGroup(e,t,r){return{type:a.types.GROUP,input:e,variables:t,aggregates:r}}createInv(e){return{type:a.types.INV,path:e}}createJoin(e,t){return{type:a.types.JOIN,left:e,right:t}}createLeftJoin(e,t,r){return r?{type:a.types.LEFT_JOIN,left:e,right:t,expression:r}:{type:a.types.LEFT_JOIN,left:e,right:t}}createLink(e){return{type:a.types.LINK,iri:e}}createMinus(e,t){return{type:a.types.MINUS,left:e,right:t}}createNop(){return{type:a.types.NOP}}createNps(e){return{type:a.types.NPS,iris:e}}createOneOrMorePath(e){return{type:a.types.ONE_OR_MORE_PATH,path:e}}createOrderBy(e,t){return{type:a.types.ORDER_BY,input:e,expressions:t}}createPath(e,t,r,n){return n?{type:a.types.PATH,subject:e,predicate:t,object:r,graph:n}:{type:a.types.PATH,subject:e,predicate:t,object:r,graph:this.dataFactory.defaultGraph()}}createPattern(e,t,r,n){let s=this.dataFactory.quad(e,t,r,n);return s.type=a.types.PATTERN,s}createProject(e,t){return{type:a.types.PROJECT,input:e,variables:t}}createReduced(e){return{type:a.types.REDUCED,input:e}}createSeq(e,t){return{type:a.types.SEQ,left:e,right:t}}createService(e,t,r){return{type:a.types.SERVICE,input:e,name:t,silent:r}}createSlice(e,t,r){return t=t||0,void 0!==r?{type:a.types.SLICE,input:e,start:t,length:r}:{type:a.types.SLICE,input:e,start:t}}createUnion(e,t){return{type:a.types.UNION,left:e,right:t}}createValues(e,t){return{type:a.types.VALUES,variables:e,bindings:t}}createZeroOrMorePath(e){return{type:a.types.ZERO_OR_MORE_PATH,path:e}}createZeroOrOnePath(e){return{type:a.types.ZERO_OR_ONE_PATH,path:e}}createAggregateExpression(e,t,r,n){return n?{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,separator:n,distinct:r}:{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,distinct:r}}createExistenceExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.EXISTENCE,not:e,input:t}}createNamedExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.NAMED,name:e,args:t}}createOperatorExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.OPERATOR,operator:e,args:t}}createTermExpression(e){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.TERM,term:e}}createWildcardExpression(){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.WILDCARD,wildcard:new i.Wildcard}}createTerm(e){return s.stringToTerm(e,this.dataFactory)}createCompositeUpdate(e){return{type:a.types.COMPOSITE_UPDATE,updates:e}}createDeleteInsert(e,t,r){const n={type:a.types.DELETE_INSERT};return e&&(n.delete=e),t&&(n.insert=t),r&&(n.where=r),n}createLoad(e,t,r){const n={type:a.types.LOAD,source:e};return t&&(n.destination=t),this.addSilent(n,r)}createClear(e,t){return this.addSilent({type:a.types.CLEAR,source:e},t)}createCreate(e,t){return this.addSilent({type:a.types.CREATE,source:e},t)}createDrop(e,t){return this.addSilent({type:a.types.DROP,source:e},t)}createAdd(e,t,r){return this.addSilent({type:a.types.ADD,source:e,destination:t},r)}createMove(e,t,r){return this.addSilent({type:a.types.MOVE,source:e,destination:t},r)}createCopy(e,t,r){return this.addSilent({type:a.types.COPY,source:e,destination:t},r)}addSilent(e,t){return t&&(e.silent=t),e}}},20060:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSparqlJs=t.toSparql=void 0;const a=r(76065),n=r(22086),s=r(9619),i=r(25299),p=r(97100),o=r(13489),c=i.types,u=i.expressionTypes;let l;const d=new p.default;function y(e){f();let t=h(e=function(e){return A(e,{})}(e));return"group"===t.type?t.patterns[0]:t}function f(){l={project:!1,extend:[],group:[],aggregates:[],order:[]}}function h(e){switch(e.type!==c.EXTEND&&e.type!==c.ORDER_BY&&e.type!==c.GRAPH&&(l.project=!1),e.type){case c.EXPRESSION:return m(e);case c.ASK:return R(e,c.ASK);case c.BGP:return function(e){let t=e.patterns.map(T);return 0===t.length?null:{type:"bgp",triples:t}}(e);case c.CONSTRUCT:return function(e){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:e.template.map(T),where:o.default.flatten([h(e.input)])}}(e);case c.DESCRIBE:return R(e,c.DESCRIBE);case c.DISTINCT:return function(e){let t=h(e.input);return t.patterns[0].distinct=!0,t}(e);case c.EXTEND:return function(e){return l.project?(l.extend.push(e),h(e.input)):o.default.flatten([h(e.input),{type:"bind",variable:e.variable,expression:m(e.expression)}])}(e);case c.FROM:return function(e){const t=h(e.input);return t.patterns[0].from={default:e.default,named:e.named},t}(e);case c.FILTER:return function(e){return{type:"group",patterns:o.default.flatten([h(e.input),{type:"filter",expression:m(e.expression)}])}}(e);case c.GRAPH:return function(e){return{type:"graph",patterns:o.default.flatten([h(e.input)]),name:e.name}}(e);case c.GROUP:return function(e){const t=h(e.input),r=e.aggregates.map(b);return l.aggregates.push(...r),l.group.push(...e.variables),t}(e);case c.JOIN:return function(e){return o.default.flatten([h(e.left),h(e.right)]).reduce(((e,t)=>("bgp"!==t.type||0==e.length||"bgp"!==e[e.length-1].type?e.push(t):e[e.length-1].triples.push(...t.triples),e)),[])}(e);case c.LEFT_JOIN:return function(e){const t={type:"optional",patterns:[h(e.right)]};return e.expression&&t.patterns.push({type:"filter",expression:m(e.expression)}),t.patterns=o.default.flatten(t.patterns),o.default.flatten([h(e.left),t])}(e);case c.MINUS:return function(e){let t=h(e.right);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),o.default.flatten([h(e.left),{type:"minus",patterns:t}])}(e);case c.NOP:return{};case c.ORDER_BY:return function(e){return l.order.push(...e.expressions),h(e.input)}(e);case c.PATH:return function(e){return{type:"bgp",triples:[{subject:e.subject,predicate:g(e.predicate),object:e.object}]}}(e);case c.PATTERN:return T(e);case c.PROJECT:return R(e,c.PROJECT);case c.REDUCED:return function(e){let t=h(e.input);return t.patterns[0].reduced=!0,t}(e);case c.SERVICE:return function(e){let t=h(e.input);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),{type:"service",name:e.name,silent:e.silent,patterns:t}}(e);case c.SLICE:return function(e){let t=h(e.input),r=t;return t.type&&"group"===t.type&&(r=t.patterns[0]),0!==e.start&&(r.offset=e.start),void 0!==e.length&&(r.limit=e.length),t}(e);case c.UNION:return function(e){return{type:"union",patterns:o.default.flatten([h(e.left),h(e.right)])}}(e);case c.VALUES:return function(e){return{type:"values",values:e.bindings.map((t=>{let r={};for(let a of e.variables){let e=`?${a.value}`;t[e]?r[e]=t[e]:r[e]=void 0}return r}))}}(e);case c.COMPOSITE_UPDATE:return function(e){return{prefixes:{},type:"update",updates:e.updates.map((e=>h(e).updates[0]))}}(e);case c.DELETE_INSERT:return function(e){let t,r=e.where;if(r&&r.type===c.FROM){let a=e.where;r=a.input,t={default:a.default,named:a.named}}const n=[{updateType:"insertdelete",delete:P(e.delete),insert:P(e.insert)}];if(t&&(n[0].using=t),!r||r.type===c.BGP&&0===r.patterns.length)n[0].where=[];else{const e={};let t=h(A(r,e));"group"===t.type?n[0].where=t.patterns:n[0].where=[t];const a=Object.keys(e);if(a.length>0){if(1!==a.length)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");""!==e[a[0]].graph.value&&(n[0].where=[{type:"graph",patterns:n[0].where,name:e[a[0]].graph}])}}return e.delete||e.where?e.insert||e.where?!e.insert&&e.where&&"bgp"===e.where.type&&a.isomorphic(e.delete,e.where.patterns)&&(delete n[0].where,n[0].updateType="deletewhere"):(delete n[0].insert,delete n[0].where,e.delete.some((e=>"Variable"===e.subject.termType||"Variable"===e.predicate.termType||"Variable"===e.object.termType))?n[0].updateType="deletewhere":n[0].updateType="delete"):(n[0].updateType="insert",delete n[0].delete,delete n[0].where),{prefixes:{},type:"update",updates:n}}(e);case c.LOAD:return function(e){const t=[{type:"load",silent:Boolean(e.silent),source:e.source}];return e.destination&&(t[0].destination=e.destination),{prefixes:{},type:"update",updates:t}}(e);case c.CLEAR:return function(e){return v(e,"clear")}(e);case c.CREATE:return function(e){return v(e,"create")}(e);case c.DROP:return function(e){return v(e,"drop")}(e);case c.ADD:return function(e){return w(e,"add")}(e);case c.MOVE:return function(e){return w(e,"move")}(e);case c.COPY:return function(e){return w(e,"copy")}(e)}throw new Error(`Unknown Operation type ${e.type}`)}function m(e){switch(e.expressionType){case u.AGGREGATE:return function(e){const t={expression:m(e.expression),type:"aggregate",aggregation:e.aggregator,distinct:e.distinct};return e.separator&&(t.separator=e.separator),t}(e);case u.EXISTENCE:return function(e){return{type:"operation",operator:e.not?"notexists":"exists",args:o.default.flatten([h(e.input)])}}(e);case u.NAMED:return function(e){return{type:"functionCall",function:e.name,args:e.args.map(m)}}(e);case u.OPERATOR:return function(e){if("desc"===e.operator){return{expression:m(e.args[0]),descending:!0}}const t={type:"operation",operator:e.operator,args:e.args.map(m)};return"in"!==t.operator&&"notin"!==t.operator||(t.args=[t.args[0]].concat([t.args.slice(1)])),t}(e);case u.TERM:return function(e){return e.term}(e);case u.WILDCARD:return function(e){return e.wildcard}(e)}throw new Error(`Unknown Expression Operation type ${e.expressionType}`)}function g(e){switch(e.type){case c.ALT:return function(e){const t=g(e.left),r=g(e.right);return"pathType"in t&&"!"===t.pathType&&"pathType"in r&&"!"===r.pathType?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:[].concat(t.items,r.items)}]}:{type:"path",pathType:"|",items:[t,r]}}(e);case c.INV:return function(e){if(e.path.type===c.NPS){const t=e.path.iris.map((e=>({type:"path",pathType:"^",items:[e]})));return t.length<=1?{type:"path",pathType:"!",items:t}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:t}]}}return{type:"path",pathType:"^",items:[g(e.path)]}}(e);case c.LINK:return function(e){return e.iri}(e);case c.NPS:return function(e){return e.iris.length<=1?{type:"path",pathType:"!",items:e.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:e.iris}]}}(e);case c.ONE_OR_MORE_PATH:return function(e){return{type:"path",pathType:"+",items:[g(e.path)]}}(e);case c.SEQ:return function(e){return{type:"path",pathType:"/",items:[g(e.left),g(e.right)]}}(e);case c.ZERO_OR_MORE_PATH:return function(e){return{type:"path",pathType:"*",items:[g(e.path)]}}(e);case c.ZERO_OR_ONE_PATH:return function(e){return{type:"path",pathType:"?",items:[g(e.path)]}}(e)}throw new Error(`Unknown Path type ${e.type}`)}function E(e){return n.termToString(e)}function b(e){return e}function T(e){return{subject:e.subject,predicate:e.predicate,object:e.object}}function O(e,t){let r=o.default.isSimpleTerm(e)?E(e):e;if("string"==typeof r){if(t[r])return t[r]}else if(Array.isArray(e))e=e.map((e=>O(e,t)));else for(let r of Object.keys(e))e[r]=O(e[r],t);return e}function R(e,t){const r={type:"query",prefixes:{}},a=r;let n;t===c.PROJECT?(r.queryType="SELECT",n=e.variables):t===c.ASK?r.queryType="ASK":t===c.DESCRIBE&&(r.queryType="DESCRIBE",n=e.terms);const i=l.extend,p=l.group,u=l.aggregates,d=l.order;f(),l.project=!0;let y=o.default.flatten([h(e.input)]);1===y.length&&"group"===y[0].type&&(y=y[0].patterns),r.where=y;let g={};for(let e of l.aggregates)g[E(e.variable)]=m(e);let b={};for(let e=l.extend.length-1;e>=0;--e){let t=l.extend[e];b[E(t.variable)]=O(m(t.expression),g)}if(l.group.length>0&&(a.group=l.group.map((e=>{let t=E(e);if(b[t]){let r=b[t];return delete b[t],{variable:e,expression:r}}return{expression:e}}))),l.order.length>0&&(a.order=l.order.map(h).map((e=>e.descending?e:{expression:e}))),n&&(a.variables=n.map((e=>{let t=E(e);return b[t]?{variable:e,expression:b[t]}:e})),0===a.variables.length&&(a.variables=[new s.Wildcard])),r.where.length>0&&"filter"===r.where[r.where.length-1].type){const e=r.where[r.where.length-1];S(e,Object.keys(g))&&(a.having=o.default.flatten([O(e.expression,g)]),r.where.splice(-1))}return l.extend=i,l.group=p,l.aggregates=u,l.order=d,{type:"group",patterns:[a]}}function S(e,t){return o.default.isSimpleTerm(e)?t.indexOf(E(e))>=0:Array.isArray(e)?e.some((e=>S(e,t))):e===Object(e)?Object.keys(e).some((r=>S(e[r],t))):t.indexOf(e)>=0}function v(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return"DEFAULT"===e.source?r[0].graph={default:!0}:"NAMED"===e.source?r[0].graph={named:!0}:"ALL"===e.source?r[0].graph={all:!0}:r[0].graph={type:"graph",name:e.source},{prefixes:{},type:"update",updates:r}}function w(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return r[0].source="DEFAULT"===e.source?{type:"graph",default:!0}:{type:"graph",name:e.source},r[0].destination="DEFAULT"===e.destination?{type:"graph",default:!0}:{type:"graph",name:e.destination},{prefixes:{},type:"update",updates:r}}function P(e){if(!e)return[];const t={};return e.forEach((e=>{const r=e.graph.value;t[r]||(t[r]=[]),t[r].push(e)})),Object.keys(t).map((e=>""===e?{type:"bgp",triples:t[e].map(T)}:{type:"graph",triples:t[e].map(T),name:t[e][0].graph}))}function A(e,t){if(Array.isArray(e))return e.map((e=>A(e,t)));if(!e.type)return e;if(e.type===c.DELETE_INSERT)return e;if((e.type===c.PATTERN||e.type===c.PATH)&&e.graph)return t[e.graph.value]||(t[e.graph.value]={graph:e.graph,values:[]}),t[e.graph.value].values.push(e),e;const r={},a={},n={};for(let t of Object.keys(e)){const s={};r[t]=A(e[t],s);const i=Object.keys(s);if(i.length>1){let e=x(s[i[0]].values);for(let t=1;t<i.length;++t){const r=x(s[i[t]].values);e=d.createJoin(e,r)}return i.map((e=>delete s[e])),e}if(1===i.length){const e=s[i[0]].graph;a[t]=e,n[e.value]=e}}const s=Object.keys(n);if(s.length>0)if(1===s.length&&e.type!==c.PROJECT)t[s[0]]={graph:n[s[0]],values:[r]};else for(let e of Object.keys(a))a[e].value.length>0&&(r[e]=d.createGraph(r[e],a[e]));return r}function x(e){const t=d.createBgp(e),r=e[0].graph;return 0===r.value.length?t:d.createGraph(t,r)}t.toSparql=function(e,t={}){return new s.Generator(t).stringify(y(e))},t.toSparqlJs=y},41152:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(64063),n=r(22086),s=r(25299),i=r(97100),p=r(13489),o=r(9619).Parser,c=s.types;let u,l=new Set,d=0,y=!1;function f(e,t,r){if(l=new Set,d=0,y=t,!e.type)return u.createNop();if("query"!==e.type&&"update"!==e.type)throw new Error("Translate only works on complete query or update objects.");const a=new Set(Object.keys(m(e)).map(u.createTerm.bind(u)));let n;var s;return"query"===e.type?(n=g({type:"group",patterns:e.where||[]}),n=function(e,t,r){const a=e,n=[],s={};if(a.variables=a.variables&&a.variables.map((e=>x(e,s))),a.having=a.having&&a.having.map((e=>x(e,s))),a.order=a.order&&a.order.map((e=>x(e,s))),a.group||Object.keys(s).length>0){const e=Object.keys(s).map((e=>function(e,t){if("aggregate"!==e.type||!e.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(e)}`);const r=E(e);return r.variable=t,r}(s[e],u.createTerm(e)))),r=[];if(a.group)for(const e of a.group)if(p.default.isSimpleTerm(e.expression))r.push(e.expression);else{const a="variable"in e?e.variable:O();t=u.createExtend(t,a,E(e.expression)),r.push(a)}t=u.createGroup(t,r,e)}if(a.having)for(let e of a.having)t=u.createFilter(t,E(e));e.values&&(t=u.createJoin(t,A(e)));let i=new Set;if("SELECT"===e.queryType||"DESCRIBE"===e.queryType)if(e.variables.some((e=>e&&p.default.isWildcard(e))))i=r;else for(let t of e.variables)h(t)||!("variable"in t)?i.add(t):t.variable&&(i.add(t.variable),n.push(t));for(let e of n)t=u.createExtend(t,e.variable,E(e.expression));return a.order&&(t=u.createOrderBy(t,a.order.map((e=>{let t=E(e.expression);return e.descending&&(t=u.createOperatorExpression(c.DESC,[t])),t})))),"SELECT"===e.queryType&&(t=u.createProject(t,Array.from(i))),a.distinct&&(t=u.createDistinct(t)),a.reduced&&(t=u.createReduced(t)),"CONSTRUCT"===e.queryType?t=u.createConstruct(t,e.template.map(R)):"ASK"===e.queryType?t=u.createAsk(t):"DESCRIBE"===e.queryType&&(t=u.createDescribe(t,Array.from(i))),(a.offset||a.limit)&&(t=u.createSlice(t,a.offset,a.limit)),a.from&&(t=u.createFrom(t,a.from.default,a.from.named)),t}(e,n,a)):"update"===e.type&&(n=1===(s=e).updates.length?j(s.updates[0]):u.createCompositeUpdate(s.updates.map(j))),r&&(n=_(n,a)),n}function h(e){return"Variable"===(null==e?void 0:e.termType)}function m(e){let t={};if(h(e))t[n.termToString(e)]=!0,l.add(e.value);else if(null!==(r=e)&&"object"==typeof r)if("bind"===e.type)m(e.expression),Object.assign(t,m(e.variable));else if("SELECT"===e.queryType){let r=m(e.where);for(let a of e.variables)p.default.isWildcard(a)?Object.assign(t,r):a.variable?Object.assign(t,m(a.variable)):Object.assign(t,m(a));if(e.group)for(let r of e.group)Object.assign(t,m(r))}else for(let r of Object.keys(e))Object.assign(t,m(e[r]));var r;return t}function g(e){let t,r=[],a=[];if("patterns"in e)for(let t of e.patterns)("filter"===t.type?r:a).push(t);if("bgp"===e.type)return function(e){let t=[],r=[];for(let n of e.triples)if("pathType"in n.predicate){let e=T((a=n).subject,b(a.predicate),a.object);for(let a of e)a.type===c.PATH?(t.length>0&&r.push(u.createBgp(t)),t=[],r.push(a)):t.push(a)}else t.push(R(n));var a;return t.length>0&&r.push(u.createBgp(t)),1===r.length?r[0]:r.reduce(((e,t)=>u.createJoin(e,t)))}(e);if("union"===e.type)t=a.map((e=>("group"!==e.type&&(e={type:"group",patterns:[e]}),g(e)))).reduce(((e,t)=>u.createUnion(e,t)));else{if("graph"===e.type)return function(e){let t=g({type:"group",patterns:e.patterns});return t=y?v(t,e.name):u.createGraph(t,e.name),t}(e);if("group"===e.type)t=a.reduce(w,u.createBgp([]));else if("values"===e.type)t=A(e);else{if("query"!==e.type)throw new Error(`Unexpected type: ${e.type}`);t=f(e,y,!1)}}if(r.length>0){let e=r.map((e=>E(e.expression)));e.length>0&&(t=u.createFilter(t,e.reduce(((e,t)=>u.createOperatorExpression("&&",[e,t])))))}return t}function E(e){if(p.default.isSimpleTerm(e)||p.default.isQuad(e))return u.createTermExpression(e);if(p.default.isWildcard(e))return u.createWildcardExpression();if("aggregation"in e)return u.createAggregateExpression(e.aggregation,E(e.expression),e.distinct,e.separator);if("function"in e)return u.createNamedExpression(e.function,e.args.map(E));if("operator"in e)return"exists"===e.operator||"notexists"===e.operator?u.createExistenceExpression("notexists"===e.operator,g(e.args[0])):("in"!==e.operator&&"notin"!==e.operator||(e.args=[e.args[0]].concat(e.args[1])),u.createOperatorExpression(e.operator,e.args.map(E)));throw new Error(`Unknown expression: ${JSON.stringify(e)}`)}function b(e){if(p.default.isSimpleTerm(e)){if("NamedNode"===e.termType)return u.createLink(e);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(e)}`)}if("^"===e.pathType)return u.createInv(b(e.items[0]));if("!"===e.pathType){let t,r=[],a=[];t="pathType"in e.items[0]&&"|"===e.items[0].pathType?e.items[0].items:e.items;for(let e of t)if(p.default.isSimpleTerm(e))r.push(e);else{if("^"!==e.pathType)throw new Error(`Unexpected item: ${JSON.stringify(e)}`);a.push(e.items[0])}let n=u.createNps(r),s=u.createInv(u.createNps(a));return 0===a.length?n:0===r.length?s:u.createAlt(n,s)}if("/"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createSeq(e,t)));if("|"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createAlt(e,t)));if("*"===e.pathType)return u.createZeroOrMorePath(b(e.items[0]));if("+"===e.pathType)return u.createOneOrMorePath(b(e.items[0]));if("?"===e.pathType)return u.createZeroOrOnePath(b(e.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(e)}`)}function T(e,t,r){if(t.type===c.LINK)return[u.createPattern(e,t.iri,r)];if(t.type===c.INV)return T(r,t.path,e);if(t.type===c.SEQ){let a=O(),n=T(e,t.left,a),s=T(a,t.right,r);return n.concat(s)}return[u.createPath(e,t,r)]}function O(){let e="?var"+d++;return l.has(e)?O():(l.add(e),u.createTerm(e))}function R(e){return u.createPattern(e.subject,e.predicate,e.object,e.graph)}t.default=function(e,t){let r;if(t=t||{},u=new i.default(t.dataFactory),"string"==typeof e){let a=new o(t);a._resetBlanks(),r=a.parse(e)}else r=e;return f(r,t.quads,t.blankToVariable)};let S=Object.values(c);function v(e,t,r){if(e.type===c.GRAPH){if(r)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");const t=e;e=v(t.input,t.name)}else if(e.type===c.BGP)e.patterns=e.patterns.map((e=>(r&&(e.subject.equals(t)&&(e.subject=r),e.predicate.equals(t)&&(e.predicate=r),e.object.equals(t)&&(e.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t),e)));else if(e.type===c.PATH){const a=e;r&&(a.subject.equals(t)&&(a.subject=r),a.object.equals(t)&&(a.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t)}else if(e.type!==c.PROJECT||r)if(e.type!==c.EXTEND||r)for(let a of Object.keys(e))Array.isArray(e[a])?e[a]=e[a].map((e=>v(e,t,r))):S.indexOf(e[a].type)>=0?e[a]=v(e[a],t,r):r&&h(e[a])&&e[a].equals(t)&&(e[a]=r);else{const a=e;a.variable.equals(t)&&(r=O()),a.input=v(a.input,t,r)}else{const a=e;a.variables.some((e=>e.equals(t)))||(r=O()),a.input=v(a.input,t,r)}return e}function w(e,t){if("optional"===t.type){const r=g({type:"group",patterns:t.patterns});if(r.type===c.FILTER){const t=r;e=u.createLeftJoin(e,t.input,t.expression)}else e=u.createLeftJoin(e,r)}else if("minus"===t.type){const r=g({type:"group",patterns:t.patterns});e=u.createMinus(e,r)}else if("bind"===t.type)e=u.createExtend(e,t.variable,E(t.expression));else if("service"===t.type){const r={type:"group",patterns:t.patterns};e=P(e,u.createService(g(r),t.name,t.silent))}else e=P(e,g(t));return e}function P(e,t){return e.type===c.BGP&&t.type===c.BGP?e=u.createBgp([].concat(e.patterns,t.patterns)):e.type===c.BGP&&0===e.patterns.length?e=t:t.type===c.BGP&&0===t.patterns.length||(e=u.createJoin(e,t)),e}function A(e){let t=(0===e.values.length?[]:Object.keys(e.values[0])).map(u.createTerm.bind(u)),r=e.values.map((e=>{let t=Object.keys(e);t=t.filter((t=>void 0!==e[t]));let r={};for(let a of t)r[a]=e[a];return r}));return u.createValues(t,r)}function x(e,t){if("type"in e&&"aggregate"===e.type){let r,s=!1;for(let n of Object.keys(t))if(a(t[n],e)){r=u.createTerm(n),s=!0;break}return s||(r=O(),t[n.termToString(r)]=e),r}return"expression"in e&&e.expression?Object.assign(Object.assign({},e),{expression:x(e.expression,t)}):"args"in e&&e.args?Object.assign(Object.assign({},e),{args:e.args.map((e=>x(e,t)))}):e}function j(e){if("type"in e){if("load"===e.type)return function(e){return u.createLoad(e.source,e.destination,e.silent)}(e);if("clear"===e.type||"create"===e.type||"drop"===e.type)return function(e){let t;switch(t=p.default.isSimpleTerm(e.graph)?e.graph:e.graph.all?"ALL":e.graph.default?"DEFAULT":e.graph.named?"NAMED":e.graph.name,e.type){case"clear":return u.createClear(t,e.silent);case"create":return u.createCreate(t,e.silent);case"drop":return u.createDrop(t,e.silent)}}(e);if("add"===e.type||"copy"===e.type||"move"===e.type)return function(e){const t=e.source.default?"DEFAULT":e.source.name,r=e.destination.default?"DEFAULT":e.destination.name;switch(e.type){case"copy":return u.createCopy(t,r,e.silent);case"move":return u.createMove(t,r,e.silent);case"add":return u.createAdd(t,r,e.silent)}}(e)}else if("insertdelete"===e.updateType||"deletewhere"===e.updateType||"delete"===e.updateType||"insert"===e.updateType)return function(e){if(!y)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let t,r=[],a=[];if(e.delete&&(r=p.default.flatten(e.delete.map((t=>N(t,e.graph))))),e.insert&&(a=p.default.flatten(e.insert.map((t=>N(t,e.graph))))),e.where&&e.where.length>0){t=g({type:"group",patterns:e.where});const r=e.using;r?t=u.createFrom(t,r.default,r.named):e.graph&&(t=v(t,e.graph))}else"deletewhere"===e.updateType&&r.length>0&&(t=u.createBgp(r));return u.createDeleteInsert(r.length>0?r:void 0,a.length>0?a:void 0,t)}(e);throw new Error(`Unknown update type ${JSON.stringify(e)}`)}function N(e,t){let r=t;"graph"===e.type&&(r=e.name);let a=e.triples;return r&&(a=a.map((e=>Object.assign(e,{graph:r})))),a.map(R)}function _(e,t){const r={},a=Array.from(t).reduce(((e,t)=>(e[t.value]=!0,e)),{});return p.default.mapOperation(e,{[s.types.DELETE_INSERT]:e=>({result:e,recurse:!1}),[s.types.PATH]:(e,t)=>({result:t.createPath(n(e.subject),e.predicate,n(e.object),n(e.graph)),recurse:!1}),[s.types.PATTERN]:(e,t)=>({result:t.createPattern(n(e.subject),n(e.predicate),n(e.object),n(e.graph)),recurse:!1}),[s.types.CONSTRUCT]:e=>({result:u.createConstruct(_(e.input,t),e.template),recurse:!1})});function n(e){if("BlankNode"===e.termType){let t=r[e.value];return t||(t=p.default.createUniqueVariable(e.value,a,u.dataFactory),a[t.value]=!0,r[e.value]=t),t}return e}}},13489:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(25299),n=r(97100);class s{static flatten(e){return Array.prototype.concat(...e).filter((e=>e))}static objectify(e){if(e.termType){if("Quad"===e.termType)return{type:"pattern",termType:"Quad",subject:s.objectify(e.subject),predicate:s.objectify(e.predicate),object:s.objectify(e.object),graph:s.objectify(e.graph)};{let t={termType:e.termType,value:e.value};return e.language&&(t.language=e.language),e.datatype&&(t.datatype=s.objectify(e.datatype)),t}}if(Array.isArray(e))return e.map((e=>s.objectify(e)));if(e===Object(e)){let t={};for(let r of Object.keys(e))t[r]=s.objectify(e[r]);return t}return e}static inScopeVariables(e){const t=[];function r(e){t.find((t=>e.value===t.value))||t.push(e)}function n(e){"Variable"===e.subject.termType&&r(e.subject),"Variable"===e.predicate.termType&&r(e.predicate),"Variable"===e.object.termType&&r(e.object),"Variable"===e.graph.termType&&r(e.graph),"Quad"===e.subject.termType&&n(e.subject),"Quad"===e.predicate.termType&&n(e.predicate),"Quad"===e.object.termType&&n(e.object),"Quad"===e.graph.termType&&n(e.graph)}return s.recurseOperation(e,{[a.types.EXPRESSION]:e=>{let t=e;return t.expressionType===a.expressionTypes.AGGREGATE&&t.variable&&r(t.variable),!0},[a.types.EXTEND]:e=>(r(e.variable),!0),[a.types.GRAPH]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.GROUP]:e=>(e.variables.forEach(r),!0),[a.types.PATH]:e=>{let t=e;return"Variable"===t.subject.termType&&r(t.subject),"Variable"===t.object.termType&&r(t.object),"Variable"===t.graph.termType&&r(t.graph),"Quad"===t.subject.termType&&n(t.subject),"Quad"===t.object.termType&&n(t.object),"Quad"===t.graph.termType&&n(t.graph),!0},[a.types.PATTERN]:e=>(n(e),!0),[a.types.PROJECT]:e=>(e.variables.forEach(r),!1),[a.types.SERVICE]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.VALUES]:e=>(e.variables.forEach(r),!0)}),t}static recurseOperation(e,t){let r=e,n=!0;if(t[e.type]&&(n=t[e.type](e)),!n)return;let i=e=>s.recurseOperation(e,t);switch(r.type){case a.types.ALT:const e=r;i(e.left),i(e.right);break;case a.types.ASK:i(r.input);break;case a.types.BGP:r.patterns.forEach(i);break;case a.types.CONSTRUCT:const t=r;i(t.input),t.template.map(i);break;case a.types.DESCRIBE:case a.types.DISTINCT:i(r.input);break;case a.types.EXPRESSION:const n=r;n.expressionType===a.expressionTypes.EXISTENCE&&i(n.input);break;case a.types.EXTEND:const s=r;i(s.input),i(s.expression);break;case a.types.FILTER:const p=r;i(p.input),i(p.expression);break;case a.types.FROM:case a.types.GRAPH:i(r.input);break;case a.types.GROUP:const o=r;i(o.input),o.aggregates.forEach(i);break;case a.types.INV:i(r.path);break;case a.types.JOIN:const c=r;i(c.left),i(c.right);break;case a.types.LEFT_JOIN:const u=r;i(u.left),i(u.right),u.expression&&i(u.expression);break;case a.types.LINK:break;case a.types.MINUS:const l=r;i(l.left),i(l.right);break;case a.types.NOP:case a.types.NPS:break;case a.types.ONE_OR_MORE_PATH:i(r.path);break;case a.types.ORDER_BY:const d=r;i(d.input),d.expressions.forEach(i);break;case a.types.PATH:i(r.predicate);break;case a.types.PATTERN:break;case a.types.PROJECT:case a.types.REDUCED:i(r.input);break;case a.types.SEQ:const y=r;i(y.left),i(y.right);break;case a.types.SERVICE:case a.types.SLICE:i(r.input);break;case a.types.UNION:const f=r;i(f.left),i(f.right);break;case a.types.VALUES:break;case a.types.ZERO_OR_MORE_PATH:case a.types.ZERO_OR_ONE_PATH:i(r.path);break;case a.types.COMPOSITE_UPDATE:r.updates.forEach((e=>i(e)));break;case a.types.DELETE_INSERT:const h=r;h.delete&&h.delete.forEach((e=>i(e))),h.insert&&h.insert.forEach((e=>i(e))),h.where&&i(h.where);break;case a.types.LOAD:case a.types.CLEAR:case a.types.CREATE:case a.types.DROP:case a.types.ADD:case a.types.MOVE:case a.types.COPY:break;default:throw new Error(`Unknown Operation type ${r.type}`)}}static mapOperation(e,t,r){let i=e,p=!0;if(r=r||new n.default,t[e.type]&&({result:i,recurse:p}=t[e.type](e,r)),!p)return i;let o=e=>s.mapOperation(e,t,r);switch(i.type){case a.types.ALT:const e=i;return r.createAlt(o(e.left),o(e.right));case a.types.ASK:const n=i;return r.createAsk(o(n.input));case a.types.BGP:const p=i;return r.createBgp(p.patterns.map(o));case a.types.CONSTRUCT:const c=i;return r.createConstruct(o(c.input),c.template.map(o));case a.types.DESCRIBE:const u=i;return r.createDescribe(o(u.input),u.terms);case a.types.DISTINCT:const l=i;return r.createDistinct(o(l.input));case a.types.EXPRESSION:const d=i;return s.mapExpression(d,t,r);case a.types.EXTEND:const y=i;return r.createExtend(o(y.input),y.variable,o(y.expression));case a.types.FILTER:const f=i;return r.createFilter(o(f.input),o(f.expression));case a.types.FROM:const h=i;return r.createFrom(o(h.input),[].concat(h.default),[].concat(h.named));case a.types.GRAPH:const m=i;return r.createGraph(o(m.input),m.name);case a.types.GROUP:const g=i;return r.createGroup(o(g.input),[].concat(g.variables),g.aggregates.map(o));case a.types.INV:const E=i;return r.createInv(o(E.path));case a.types.JOIN:const b=i;return r.createJoin(o(b.left),o(b.right));case a.types.LEFT_JOIN:const T=i;return r.createLeftJoin(o(T.left),o(T.right),T.expression?o(T.expression):void 0);case a.types.LINK:const O=i;return r.createLink(O.iri);case a.types.MINUS:const R=i;return r.createMinus(o(R.left),o(R.right));case a.types.NOP:return r.createNop();case a.types.NPS:const S=i;return r.createNps([].concat(S.iris));case a.types.ONE_OR_MORE_PATH:const v=i;return r.createOneOrMorePath(o(v.path));case a.types.ORDER_BY:const w=i;return r.createOrderBy(o(w.input),w.expressions.map(o));case a.types.PATH:const P=i;return r.createPath(P.subject,o(P.predicate),P.object,P.graph);case a.types.PATTERN:const A=i;return r.createPattern(A.subject,A.predicate,A.object,A.graph);case a.types.PROJECT:const x=i;return r.createProject(o(x.input),[].concat(x.variables));case a.types.REDUCED:const j=i;return r.createReduced(o(j.input));case a.types.SEQ:const N=i;return r.createSeq(o(N.left),o(N.right));case a.types.SERVICE:const _=i;return r.createService(o(_.input),_.name,_.silent);case a.types.SLICE:const I=i;return r.createSlice(o(I.input),I.start,I.length);case a.types.UNION:const C=i;return r.createUnion(o(C.left),o(C.right));case a.types.VALUES:const D=i;return r.createValues([].concat(D.variables),D.bindings.map((e=>Object.assign({},e))));case a.types.ZERO_OR_MORE_PATH:const q=i;return r.createZeroOrMorePath(o(q.path));case a.types.ZERO_OR_ONE_PATH:const M=i;return r.createZeroOrOnePath(o(M.path));case a.types.COMPOSITE_UPDATE:const L=i;return r.createCompositeUpdate(L.updates.map(o));case a.types.DELETE_INSERT:const k=i;return r.createDeleteInsert(k.delete?k.delete.map(o):void 0,k.insert?k.insert.map(o):void 0,k.where?o(k.where):void 0);case a.types.LOAD:const U=i;return r.createLoad(U.source,U.destination,U.silent);case a.types.CLEAR:const G=i;return r.createClear(G.source,G.silent);case a.types.CREATE:const H=i;return r.createCreate(H.source,H.silent);case a.types.DROP:const B=i;return r.createDrop(B.source,B.silent);case a.types.ADD:const F=i;return r.createAdd(F.source,F.destination);case a.types.MOVE:const Q=i;return r.createMove(Q.source,Q.destination);case a.types.COPY:const J=i;return r.createCopy(J.source,J.destination);default:throw new Error(`Unknown Operation type ${i.type}`)}}static mapExpression(e,t,r){let n=e=>s.mapOperation(e,t,r);switch(e.expressionType){case a.expressionTypes.AGGREGATE:if(e.variable){const t=e;return r.createBoundAggregate(t.variable,t.aggregator,n(t.expression),t.distinct,t.separator)}const t=e;return r.createAggregateExpression(t.aggregator,n(t.expression),t.distinct,t.separator);case a.expressionTypes.EXISTENCE:const s=e;return r.createExistenceExpression(s.not,n(s.input));case a.expressionTypes.NAMED:const i=e;return r.createNamedExpression(i.name,i.args.map(n));case a.expressionTypes.OPERATOR:const p=e;return r.createOperatorExpression(p.operator,p.args.map(n));case a.expressionTypes.TERM:const o=e;return r.createTermExpression(o.term);case a.expressionTypes.WILDCARD:return r.createWildcardExpression();default:throw new Error(`Unknown Expression type ${e.expressionType}`)}}static createUniqueVariable(e,t,r){let a=0,n=e;for(;t[n];)n=`${e}${a++}`;return r.variable(n)}static isSimpleTerm(e){return void 0!==e.termType&&"Quad"!==e.termType&&"Wildcard"!==e.termType}static isQuad(e){return"Quad"===e.termType}static isWildcard(e){return"Wildcard"===e.termType}}t.default=s},62299:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(16675),t)},16675:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationLeftJoinLeftDeep=void 0;const a=r(67213),n=r(12444),s=r(55505),i=r(69972);class p extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"leftjoin")}static createLeftDeepStream(e,t,r){return new s.MultiTransformIterator(e,{multiTransform(e){const n=t=>t.merge(e);return new s.TransformIterator((async()=>(await r(a.materializeOperation(t,e))).map(n)),{maxBufferSize:128})},optional:!0})}async testOperation(e,t){return!0}async runOperation(e,t){const r=a.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:e.left,context:t})),s=a.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:e.right,context:t}));s.bindingsStream.close();const i=e.expression?p.FACTORY.createFilter(e.right,e.expression):e.right;return{type:"bindings",bindingsStream:p.createLeftDeepStream(r.bindingsStream,i,(async e=>a.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:e,context:t})).bindingsStream)),metadata:()=>Promise.all([r,s].map((e=>a.getMetadata(e)))).then((e=>e.reduce(((e,t)=>e*t.totalItems),1))).catch((()=>Number.POSITIVE_INFINITY)).then((e=>({totalItems:e}))),variables:n.ActorRdfJoin.joinVariables({entries:[r,s]}),canContainUndefs:!0}}}t.ActorQueryOperationLeftJoinLeftDeep=p,p.FACTORY=new i.Factory},69972:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.toSparqlJs=t.toSparql=t.Factory=t.Algebra=t.translate=void 0;const a=r(8225);t.translate=a.default;const n=r(94522);t.Algebra=n;const s=r(20539);t.Factory=s.default;const i=r(21014);Object.defineProperty(t,"toSparql",{enumerable:!0,get:function(){return i.toSparql}}),Object.defineProperty(t,"toSparqlJs",{enumerable:!0,get:function(){return i.toSparqlJs}});const p=r(87625);t.Util=p.default},94522:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expressionTypes=t.types=void 0,t.types={ALT:"alt",ASK:"ask",BGP:"bgp",CONSTRUCT:"construct",DESC:"desc",DESCRIBE:"describe",DISTINCT:"distinct",EXPRESSION:"expression",EXTEND:"extend",FILTER:"filter",FROM:"from",GRAPH:"graph",GROUP:"group",INV:"inv",JOIN:"join",LEFT_JOIN:"leftjoin",LINK:"link",MINUS:"minus",NOP:"nop",NPS:"nps",ONE_OR_MORE_PATH:"OneOrMorePath",ORDER_BY:"orderby",PATH:"path",PATTERN:"pattern",PROJECT:"project",REDUCED:"reduced",SEQ:"seq",SERVICE:"service",SLICE:"slice",UNION:"union",VALUES:"values",ZERO_OR_MORE_PATH:"ZeroOrMorePath",ZERO_OR_ONE_PATH:"ZeroOrOnePath",COMPOSITE_UPDATE:"compositeupdate",DELETE_INSERT:"deleteinsert",LOAD:"load",CLEAR:"clear",CREATE:"create",DROP:"drop",ADD:"add",MOVE:"move",COPY:"copy"},t.expressionTypes={AGGREGATE:"aggregate",EXISTENCE:"existence",NAMED:"named",OPERATOR:"operator",TERM:"term",WILDCARD:"wildcard"}},20539:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(94522),n=r(41640),s=r(22086),i=r(9619);t.default=class{constructor(e){this.dataFactory=e||new n.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(e,t){return{type:a.types.ALT,left:e,right:t}}createAsk(e){return{type:a.types.ASK,input:e}}createBoundAggregate(e,t,r,a,n){let s=this.createAggregateExpression(t,r,a,n);return s.variable=e,s}createBgp(e){return{type:a.types.BGP,patterns:e}}createConstruct(e,t){return{type:a.types.CONSTRUCT,input:e,template:t}}createDescribe(e,t){return{type:a.types.DESCRIBE,input:e,terms:t}}createDistinct(e){return{type:a.types.DISTINCT,input:e}}createExtend(e,t,r){return{type:a.types.EXTEND,input:e,variable:t,expression:r}}createFrom(e,t,r){return{type:a.types.FROM,input:e,default:t,named:r}}createFilter(e,t){return{type:a.types.FILTER,input:e,expression:t}}createGraph(e,t){return{type:a.types.GRAPH,input:e,name:t}}createGroup(e,t,r){return{type:a.types.GROUP,input:e,variables:t,aggregates:r}}createInv(e){return{type:a.types.INV,path:e}}createJoin(e,t){return{type:a.types.JOIN,left:e,right:t}}createLeftJoin(e,t,r){return r?{type:a.types.LEFT_JOIN,left:e,right:t,expression:r}:{type:a.types.LEFT_JOIN,left:e,right:t}}createLink(e){return{type:a.types.LINK,iri:e}}createMinus(e,t){return{type:a.types.MINUS,left:e,right:t}}createNop(){return{type:a.types.NOP}}createNps(e){return{type:a.types.NPS,iris:e}}createOneOrMorePath(e){return{type:a.types.ONE_OR_MORE_PATH,path:e}}createOrderBy(e,t){return{type:a.types.ORDER_BY,input:e,expressions:t}}createPath(e,t,r,n){return n?{type:a.types.PATH,subject:e,predicate:t,object:r,graph:n}:{type:a.types.PATH,subject:e,predicate:t,object:r,graph:this.dataFactory.defaultGraph()}}createPattern(e,t,r,n){let s=this.dataFactory.quad(e,t,r,n);return s.type=a.types.PATTERN,s}createProject(e,t){return{type:a.types.PROJECT,input:e,variables:t}}createReduced(e){return{type:a.types.REDUCED,input:e}}createSeq(e,t){return{type:a.types.SEQ,left:e,right:t}}createService(e,t,r){return{type:a.types.SERVICE,input:e,name:t,silent:r}}createSlice(e,t,r){return t=t||0,void 0!==r?{type:a.types.SLICE,input:e,start:t,length:r}:{type:a.types.SLICE,input:e,start:t}}createUnion(e,t){return{type:a.types.UNION,left:e,right:t}}createValues(e,t){return{type:a.types.VALUES,variables:e,bindings:t}}createZeroOrMorePath(e){return{type:a.types.ZERO_OR_MORE_PATH,path:e}}createZeroOrOnePath(e){return{type:a.types.ZERO_OR_ONE_PATH,path:e}}createAggregateExpression(e,t,r,n){return n?{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,separator:n,distinct:r}:{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,distinct:r}}createExistenceExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.EXISTENCE,not:e,input:t}}createNamedExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.NAMED,name:e,args:t}}createOperatorExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.OPERATOR,operator:e,args:t}}createTermExpression(e){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.TERM,term:e}}createWildcardExpression(){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.WILDCARD,wildcard:new i.Wildcard}}createTerm(e){return s.stringToTerm(e,this.dataFactory)}createCompositeUpdate(e){return{type:a.types.COMPOSITE_UPDATE,updates:e}}createDeleteInsert(e,t,r){const n={type:a.types.DELETE_INSERT};return e&&(n.delete=e),t&&(n.insert=t),r&&(n.where=r),n}createLoad(e,t,r){const n={type:a.types.LOAD,source:e};return t&&(n.destination=t),this.addSilent(n,r)}createClear(e,t){return this.addSilent({type:a.types.CLEAR,source:e},t)}createCreate(e,t){return this.addSilent({type:a.types.CREATE,source:e},t)}createDrop(e,t){return this.addSilent({type:a.types.DROP,source:e},t)}createAdd(e,t,r){return this.addSilent({type:a.types.ADD,source:e,destination:t},r)}createMove(e,t,r){return this.addSilent({type:a.types.MOVE,source:e,destination:t},r)}createCopy(e,t,r){return this.addSilent({type:a.types.COPY,source:e,destination:t},r)}addSilent(e,t){return t&&(e.silent=t),e}}},21014:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSparqlJs=t.toSparql=void 0;const a=r(76065),n=r(22086),s=r(9619),i=r(94522),p=r(20539),o=r(87625),c=i.types,u=i.expressionTypes;let l;const d=new p.default;function y(e){f();let t=h(e=function(e){return A(e,{})}(e));return"group"===t.type?t.patterns[0]:t}function f(){l={project:!1,extend:[],group:[],aggregates:[],order:[]}}function h(e){switch(e.type!==c.EXTEND&&e.type!==c.ORDER_BY&&e.type!==c.GRAPH&&(l.project=!1),e.type){case c.EXPRESSION:return m(e);case c.ASK:return R(e,c.ASK);case c.BGP:return function(e){let t=e.patterns.map(T);return 0===t.length?null:{type:"bgp",triples:t}}(e);case c.CONSTRUCT:return function(e){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:e.template.map(T),where:o.default.flatten([h(e.input)])}}(e);case c.DESCRIBE:return R(e,c.DESCRIBE);case c.DISTINCT:return function(e){let t=h(e.input);return t.patterns[0].distinct=!0,t}(e);case c.EXTEND:return function(e){return l.project?(l.extend.push(e),h(e.input)):o.default.flatten([h(e.input),{type:"bind",variable:e.variable,expression:m(e.expression)}])}(e);case c.FROM:return function(e){const t=h(e.input);return t.patterns[0].from={default:e.default,named:e.named},t}(e);case c.FILTER:return function(e){return{type:"group",patterns:o.default.flatten([h(e.input),{type:"filter",expression:m(e.expression)}])}}(e);case c.GRAPH:return function(e){return{type:"graph",patterns:o.default.flatten([h(e.input)]),name:e.name}}(e);case c.GROUP:return function(e){const t=h(e.input),r=e.aggregates.map(b);return l.aggregates.push(...r),l.group.push(...e.variables),t}(e);case c.JOIN:return function(e){return o.default.flatten([h(e.left),h(e.right)]).reduce(((e,t)=>("bgp"!==t.type||0==e.length||"bgp"!==e[e.length-1].type?e.push(t):e[e.length-1].triples.push(...t.triples),e)),[])}(e);case c.LEFT_JOIN:return function(e){const t={type:"optional",patterns:[h(e.right)]};return e.expression&&t.patterns.push({type:"filter",expression:m(e.expression)}),t.patterns=o.default.flatten(t.patterns),o.default.flatten([h(e.left),t])}(e);case c.MINUS:return function(e){let t=h(e.right);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),o.default.flatten([h(e.left),{type:"minus",patterns:t}])}(e);case c.NOP:return{};case c.ORDER_BY:return function(e){return l.order.push(...e.expressions),h(e.input)}(e);case c.PATH:return function(e){return{type:"bgp",triples:[{subject:e.subject,predicate:g(e.predicate),object:e.object}]}}(e);case c.PATTERN:return T(e);case c.PROJECT:return R(e,c.PROJECT);case c.REDUCED:return function(e){let t=h(e.input);return t.patterns[0].reduced=!0,t}(e);case c.SERVICE:return function(e){let t=h(e.input);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),{type:"service",name:e.name,silent:e.silent,patterns:t}}(e);case c.SLICE:return function(e){let t=h(e.input),r=t;return t.type&&"group"===t.type&&(r=t.patterns[0]),0!==e.start&&(r.offset=e.start),void 0!==e.length&&(r.limit=e.length),t}(e);case c.UNION:return function(e){return{type:"union",patterns:o.default.flatten([h(e.left),h(e.right)])}}(e);case c.VALUES:return function(e){return{type:"values",values:e.bindings.map((t=>{let r={};for(let a of e.variables){let e=`?${a.value}`;t[e]?r[e]=t[e]:r[e]=void 0}return r}))}}(e);case c.COMPOSITE_UPDATE:return function(e){return{prefixes:{},type:"update",updates:e.updates.map((e=>h(e).updates[0]))}}(e);case c.DELETE_INSERT:return function(e){let t,r=e.where;if(r&&r.type===c.FROM){let a=e.where;r=a.input,t={default:a.default,named:a.named}}const n=[{updateType:"insertdelete",delete:P(e.delete),insert:P(e.insert)}];if(t&&(n[0].using=t),!r||r.type===c.BGP&&0===r.patterns.length)n[0].where=[];else{const e={};let t=h(A(r,e));"group"===t.type?n[0].where=t.patterns:n[0].where=[t];const a=Object.keys(e);if(a.length>0){if(1!==a.length)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");""!==e[a[0]].graph.value&&(n[0].where=[{type:"graph",patterns:n[0].where,name:e[a[0]].graph}])}}return e.delete||e.where?e.insert||e.where?!e.insert&&e.where&&"bgp"===e.where.type&&a.isomorphic(e.delete,e.where.patterns)&&(delete n[0].where,n[0].updateType="deletewhere"):(delete n[0].insert,delete n[0].where,e.delete.some((e=>"Variable"===e.subject.termType||"Variable"===e.predicate.termType||"Variable"===e.object.termType))?n[0].updateType="deletewhere":n[0].updateType="delete"):(n[0].updateType="insert",delete n[0].delete,delete n[0].where),{prefixes:{},type:"update",updates:n}}(e);case c.LOAD:return function(e){const t=[{type:"load",silent:Boolean(e.silent),source:e.source}];return e.destination&&(t[0].destination=e.destination),{prefixes:{},type:"update",updates:t}}(e);case c.CLEAR:return function(e){return v(e,"clear")}(e);case c.CREATE:return function(e){return v(e,"create")}(e);case c.DROP:return function(e){return v(e,"drop")}(e);case c.ADD:return function(e){return w(e,"add")}(e);case c.MOVE:return function(e){return w(e,"move")}(e);case c.COPY:return function(e){return w(e,"copy")}(e)}throw new Error(`Unknown Operation type ${e.type}`)}function m(e){switch(e.expressionType){case u.AGGREGATE:return function(e){const t={expression:m(e.expression),type:"aggregate",aggregation:e.aggregator,distinct:e.distinct};return e.separator&&(t.separator=e.separator),t}(e);case u.EXISTENCE:return function(e){return{type:"operation",operator:e.not?"notexists":"exists",args:o.default.flatten([h(e.input)])}}(e);case u.NAMED:return function(e){return{type:"functionCall",function:e.name,args:e.args.map(m)}}(e);case u.OPERATOR:return function(e){if("desc"===e.operator){return{expression:m(e.args[0]),descending:!0}}const t={type:"operation",operator:e.operator,args:e.args.map(m)};return"in"!==t.operator&&"notin"!==t.operator||(t.args=[t.args[0]].concat([t.args.slice(1)])),t}(e);case u.TERM:return function(e){return e.term}(e);case u.WILDCARD:return function(e){return e.wildcard}(e)}throw new Error(`Unknown Expression Operation type ${e.expressionType}`)}function g(e){switch(e.type){case c.ALT:return function(e){const t=g(e.left),r=g(e.right);return"pathType"in t&&"!"===t.pathType&&"pathType"in r&&"!"===r.pathType?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:[].concat(t.items,r.items)}]}:{type:"path",pathType:"|",items:[t,r]}}(e);case c.INV:return function(e){if(e.path.type===c.NPS){const t=e.path.iris.map((e=>({type:"path",pathType:"^",items:[e]})));return t.length<=1?{type:"path",pathType:"!",items:t}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:t}]}}return{type:"path",pathType:"^",items:[g(e.path)]}}(e);case c.LINK:return function(e){return e.iri}(e);case c.NPS:return function(e){return e.iris.length<=1?{type:"path",pathType:"!",items:e.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:e.iris}]}}(e);case c.ONE_OR_MORE_PATH:return function(e){return{type:"path",pathType:"+",items:[g(e.path)]}}(e);case c.SEQ:return function(e){return{type:"path",pathType:"/",items:[g(e.left),g(e.right)]}}(e);case c.ZERO_OR_MORE_PATH:return function(e){return{type:"path",pathType:"*",items:[g(e.path)]}}(e);case c.ZERO_OR_ONE_PATH:return function(e){return{type:"path",pathType:"?",items:[g(e.path)]}}(e)}throw new Error(`Unknown Path type ${e.type}`)}function E(e){return n.termToString(e)}function b(e){return e}function T(e){return{subject:e.subject,predicate:e.predicate,object:e.object}}function O(e,t){let r=o.default.isSimpleTerm(e)?E(e):e;if("string"==typeof r){if(t[r])return t[r]}else if(Array.isArray(e))e=e.map((e=>O(e,t)));else for(let r of Object.keys(e))e[r]=O(e[r],t);return e}function R(e,t){const r={type:"query",prefixes:{}},a=r;let n;t===c.PROJECT?(r.queryType="SELECT",n=e.variables):t===c.ASK?r.queryType="ASK":t===c.DESCRIBE&&(r.queryType="DESCRIBE",n=e.terms);const i=l.extend,p=l.group,u=l.aggregates,d=l.order;f(),l.project=!0;let y=o.default.flatten([h(e.input)]);1===y.length&&"group"===y[0].type&&(y=y[0].patterns),r.where=y;let g={};for(let e of l.aggregates)g[E(e.variable)]=m(e);let b={};for(let e=l.extend.length-1;e>=0;--e){let t=l.extend[e];b[E(t.variable)]=O(m(t.expression),g)}if(l.group.length>0&&(a.group=l.group.map((e=>{let t=E(e);if(b[t]){let r=b[t];return delete b[t],{variable:e,expression:r}}return{expression:e}}))),l.order.length>0&&(a.order=l.order.map(h).map((e=>e.descending?e:{expression:e}))),n&&(a.variables=n.map((e=>{let t=E(e);return b[t]?{variable:e,expression:b[t]}:e})),0===a.variables.length&&(a.variables=[new s.Wildcard])),r.where.length>0&&"filter"===r.where[r.where.length-1].type){const e=r.where[r.where.length-1];S(e,Object.keys(g))&&(a.having=o.default.flatten([O(e.expression,g)]),r.where.splice(-1))}return l.extend=i,l.group=p,l.aggregates=u,l.order=d,{type:"group",patterns:[a]}}function S(e,t){return o.default.isSimpleTerm(e)?t.indexOf(E(e))>=0:Array.isArray(e)?e.some((e=>S(e,t))):e===Object(e)?Object.keys(e).some((r=>S(e[r],t))):t.indexOf(e)>=0}function v(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return"DEFAULT"===e.source?r[0].graph={default:!0}:"NAMED"===e.source?r[0].graph={named:!0}:"ALL"===e.source?r[0].graph={all:!0}:r[0].graph={type:"graph",name:e.source},{prefixes:{},type:"update",updates:r}}function w(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return r[0].source="DEFAULT"===e.source?{type:"graph",default:!0}:{type:"graph",name:e.source},r[0].destination="DEFAULT"===e.destination?{type:"graph",default:!0}:{type:"graph",name:e.destination},{prefixes:{},type:"update",updates:r}}function P(e){if(!e)return[];const t={};return e.forEach((e=>{const r=e.graph.value;t[r]||(t[r]=[]),t[r].push(e)})),Object.keys(t).map((e=>""===e?{type:"bgp",triples:t[e].map(T)}:{type:"graph",triples:t[e].map(T),name:t[e][0].graph}))}function A(e,t){if(Array.isArray(e))return e.map((e=>A(e,t)));if(!e.type)return e;if(e.type===c.DELETE_INSERT)return e;if((e.type===c.PATTERN||e.type===c.PATH)&&e.graph)return t[e.graph.value]||(t[e.graph.value]={graph:e.graph,values:[]}),t[e.graph.value].values.push(e),e;const r={},a={},n={};for(let t of Object.keys(e)){const s={};r[t]=A(e[t],s);const i=Object.keys(s);if(i.length>1){let e=x(s[i[0]].values);for(let t=1;t<i.length;++t){const r=x(s[i[t]].values);e=d.createJoin(e,r)}return i.map((e=>delete s[e])),e}if(1===i.length){const e=s[i[0]].graph;a[t]=e,n[e.value]=e}}const s=Object.keys(n);if(s.length>0)if(1===s.length&&e.type!==c.PROJECT)t[s[0]]={graph:n[s[0]],values:[r]};else for(let e of Object.keys(a))a[e].value.length>0&&(r[e]=d.createGraph(r[e],a[e]));return r}function x(e){const t=d.createBgp(e),r=e[0].graph;return 0===r.value.length?t:d.createGraph(t,r)}t.toSparql=function(e,t={}){return new s.Generator(t).stringify(y(e))},t.toSparqlJs=y},8225:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(64063),n=r(22086),s=r(94522),i=r(20539),p=r(87625),o=r(9619).Parser,c=s.types;let u,l=new Set,d=0,y=!1;function f(e,t,r){if(l=new Set,d=0,y=t,!e.type)return u.createNop();if("query"!==e.type&&"update"!==e.type)throw new Error("Translate only works on complete query or update objects.");const a=new Set(Object.keys(m(e)).map(u.createTerm.bind(u)));let n;var s;return"query"===e.type?(n=g({type:"group",patterns:e.where||[]}),n=function(e,t,r){const a=e,n=[],s={};if(a.variables=a.variables&&a.variables.map((e=>x(e,s))),a.having=a.having&&a.having.map((e=>x(e,s))),a.order=a.order&&a.order.map((e=>x(e,s))),a.group||Object.keys(s).length>0){const e=Object.keys(s).map((e=>function(e,t){if("aggregate"!==e.type||!e.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(e)}`);const r=E(e);return r.variable=t,r}(s[e],u.createTerm(e)))),r=[];if(a.group)for(const e of a.group)if(p.default.isSimpleTerm(e.expression))r.push(e.expression);else{const a="variable"in e?e.variable:O();t=u.createExtend(t,a,E(e.expression)),r.push(a)}t=u.createGroup(t,r,e)}if(a.having)for(let e of a.having)t=u.createFilter(t,E(e));e.values&&(t=u.createJoin(t,A(e)));let i=new Set;if("SELECT"===e.queryType||"DESCRIBE"===e.queryType)if(e.variables.some((e=>e&&p.default.isWildcard(e))))i=r;else for(let t of e.variables)h(t)||!("variable"in t)?i.add(t):t.variable&&(i.add(t.variable),n.push(t));for(let e of n)t=u.createExtend(t,e.variable,E(e.expression));return a.order&&(t=u.createOrderBy(t,a.order.map((e=>{let t=E(e.expression);return e.descending&&(t=u.createOperatorExpression(c.DESC,[t])),t})))),"SELECT"===e.queryType&&(t=u.createProject(t,Array.from(i))),a.distinct&&(t=u.createDistinct(t)),a.reduced&&(t=u.createReduced(t)),"CONSTRUCT"===e.queryType?t=u.createConstruct(t,e.template.map(R)):"ASK"===e.queryType?t=u.createAsk(t):"DESCRIBE"===e.queryType&&(t=u.createDescribe(t,Array.from(i))),(a.offset||a.limit)&&(t=u.createSlice(t,a.offset,a.limit)),a.from&&(t=u.createFrom(t,a.from.default,a.from.named)),t}(e,n,a)):"update"===e.type&&(n=1===(s=e).updates.length?j(s.updates[0]):u.createCompositeUpdate(s.updates.map(j))),r&&(n=_(n,a)),n}function h(e){return"Variable"===(null==e?void 0:e.termType)}function m(e){let t={};if(h(e))t[n.termToString(e)]=!0,l.add(e.value);else if(null!==(r=e)&&"object"==typeof r)if("bind"===e.type)m(e.expression),Object.assign(t,m(e.variable));else if("SELECT"===e.queryType){let r=m(e.where);for(let a of e.variables)p.default.isWildcard(a)?Object.assign(t,r):a.variable?Object.assign(t,m(a.variable)):Object.assign(t,m(a));if(e.group)for(let r of e.group)Object.assign(t,m(r))}else for(let r of Object.keys(e))Object.assign(t,m(e[r]));var r;return t}function g(e){let t,r=[],a=[];if("patterns"in e)for(let t of e.patterns)("filter"===t.type?r:a).push(t);if("bgp"===e.type)return function(e){let t=[],r=[];for(let n of e.triples)if("pathType"in n.predicate){let e=T((a=n).subject,b(a.predicate),a.object);for(let a of e)a.type===c.PATH?(t.length>0&&r.push(u.createBgp(t)),t=[],r.push(a)):t.push(a)}else t.push(R(n));var a;return t.length>0&&r.push(u.createBgp(t)),1===r.length?r[0]:r.reduce(((e,t)=>u.createJoin(e,t)))}(e);if("union"===e.type)t=a.map((e=>("group"!==e.type&&(e={type:"group",patterns:[e]}),g(e)))).reduce(((e,t)=>u.createUnion(e,t)));else{if("graph"===e.type)return function(e){let t=g({type:"group",patterns:e.patterns});return t=y?v(t,e.name):u.createGraph(t,e.name),t}(e);if("group"===e.type)t=a.reduce(w,u.createBgp([]));else if("values"===e.type)t=A(e);else{if("query"!==e.type)throw new Error(`Unexpected type: ${e.type}`);t=f(e,y,!1)}}if(r.length>0){let e=r.map((e=>E(e.expression)));e.length>0&&(t=u.createFilter(t,e.reduce(((e,t)=>u.createOperatorExpression("&&",[e,t])))))}return t}function E(e){if(p.default.isSimpleTerm(e)||p.default.isQuad(e))return u.createTermExpression(e);if(p.default.isWildcard(e))return u.createWildcardExpression();if("aggregation"in e)return u.createAggregateExpression(e.aggregation,E(e.expression),e.distinct,e.separator);if("function"in e)return u.createNamedExpression(e.function,e.args.map(E));if("operator"in e)return"exists"===e.operator||"notexists"===e.operator?u.createExistenceExpression("notexists"===e.operator,g(e.args[0])):("in"!==e.operator&&"notin"!==e.operator||(e.args=[e.args[0]].concat(e.args[1])),u.createOperatorExpression(e.operator,e.args.map(E)));throw new Error(`Unknown expression: ${JSON.stringify(e)}`)}function b(e){if(p.default.isSimpleTerm(e)){if("NamedNode"===e.termType)return u.createLink(e);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(e)}`)}if("^"===e.pathType)return u.createInv(b(e.items[0]));if("!"===e.pathType){let t,r=[],a=[];t="pathType"in e.items[0]&&"|"===e.items[0].pathType?e.items[0].items:e.items;for(let e of t)if(p.default.isSimpleTerm(e))r.push(e);else{if("^"!==e.pathType)throw new Error(`Unexpected item: ${JSON.stringify(e)}`);a.push(e.items[0])}let n=u.createNps(r),s=u.createInv(u.createNps(a));return 0===a.length?n:0===r.length?s:u.createAlt(n,s)}if("/"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createSeq(e,t)));if("|"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createAlt(e,t)));if("*"===e.pathType)return u.createZeroOrMorePath(b(e.items[0]));if("+"===e.pathType)return u.createOneOrMorePath(b(e.items[0]));if("?"===e.pathType)return u.createZeroOrOnePath(b(e.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(e)}`)}function T(e,t,r){if(t.type===c.LINK)return[u.createPattern(e,t.iri,r)];if(t.type===c.INV)return T(r,t.path,e);if(t.type===c.SEQ){let a=O(),n=T(e,t.left,a),s=T(a,t.right,r);return n.concat(s)}return[u.createPath(e,t,r)]}function O(){let e="?var"+d++;return l.has(e)?O():(l.add(e),u.createTerm(e))}function R(e){return u.createPattern(e.subject,e.predicate,e.object,e.graph)}t.default=function(e,t){let r;if(t=t||{},u=new i.default(t.dataFactory),"string"==typeof e){let a=new o(t);a._resetBlanks(),r=a.parse(e)}else r=e;return f(r,t.quads,t.blankToVariable)};let S=Object.values(c);function v(e,t,r){if(e.type===c.GRAPH){if(r)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");const t=e;e=v(t.input,t.name)}else if(e.type===c.BGP)e.patterns=e.patterns.map((e=>(r&&(e.subject.equals(t)&&(e.subject=r),e.predicate.equals(t)&&(e.predicate=r),e.object.equals(t)&&(e.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t),e)));else if(e.type===c.PATH){const a=e;r&&(a.subject.equals(t)&&(a.subject=r),a.object.equals(t)&&(a.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t)}else if(e.type!==c.PROJECT||r)if(e.type!==c.EXTEND||r)for(let a of Object.keys(e))Array.isArray(e[a])?e[a]=e[a].map((e=>v(e,t,r))):S.indexOf(e[a].type)>=0?e[a]=v(e[a],t,r):r&&h(e[a])&&e[a].equals(t)&&(e[a]=r);else{const a=e;a.variable.equals(t)&&(r=O()),a.input=v(a.input,t,r)}else{const a=e;a.variables.some((e=>e.equals(t)))||(r=O()),a.input=v(a.input,t,r)}return e}function w(e,t){if("optional"===t.type){const r=g({type:"group",patterns:t.patterns});if(r.type===c.FILTER){const t=r;e=u.createLeftJoin(e,t.input,t.expression)}else e=u.createLeftJoin(e,r)}else if("minus"===t.type){const r=g({type:"group",patterns:t.patterns});e=u.createMinus(e,r)}else if("bind"===t.type)e=u.createExtend(e,t.variable,E(t.expression));else if("service"===t.type){const r={type:"group",patterns:t.patterns};e=P(e,u.createService(g(r),t.name,t.silent))}else e=P(e,g(t));return e}function P(e,t){return e.type===c.BGP&&t.type===c.BGP?e=u.createBgp([].concat(e.patterns,t.patterns)):e.type===c.BGP&&0===e.patterns.length?e=t:t.type===c.BGP&&0===t.patterns.length||(e=u.createJoin(e,t)),e}function A(e){let t=(0===e.values.length?[]:Object.keys(e.values[0])).map(u.createTerm.bind(u)),r=e.values.map((e=>{let t=Object.keys(e);t=t.filter((t=>void 0!==e[t]));let r={};for(let a of t)r[a]=e[a];return r}));return u.createValues(t,r)}function x(e,t){if("type"in e&&"aggregate"===e.type){let r,s=!1;for(let n of Object.keys(t))if(a(t[n],e)){r=u.createTerm(n),s=!0;break}return s||(r=O(),t[n.termToString(r)]=e),r}return"expression"in e&&e.expression?Object.assign(Object.assign({},e),{expression:x(e.expression,t)}):"args"in e&&e.args?Object.assign(Object.assign({},e),{args:e.args.map((e=>x(e,t)))}):e}function j(e){if("type"in e){if("load"===e.type)return function(e){return u.createLoad(e.source,e.destination,e.silent)}(e);if("clear"===e.type||"create"===e.type||"drop"===e.type)return function(e){let t;switch(t=p.default.isSimpleTerm(e.graph)?e.graph:e.graph.all?"ALL":e.graph.default?"DEFAULT":e.graph.named?"NAMED":e.graph.name,e.type){case"clear":return u.createClear(t,e.silent);case"create":return u.createCreate(t,e.silent);case"drop":return u.createDrop(t,e.silent)}}(e);if("add"===e.type||"copy"===e.type||"move"===e.type)return function(e){const t=e.source.default?"DEFAULT":e.source.name,r=e.destination.default?"DEFAULT":e.destination.name;switch(e.type){case"copy":return u.createCopy(t,r,e.silent);case"move":return u.createMove(t,r,e.silent);case"add":return u.createAdd(t,r,e.silent)}}(e)}else if("insertdelete"===e.updateType||"deletewhere"===e.updateType||"delete"===e.updateType||"insert"===e.updateType)return function(e){if(!y)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let t,r=[],a=[];if(e.delete&&(r=p.default.flatten(e.delete.map((t=>N(t,e.graph))))),e.insert&&(a=p.default.flatten(e.insert.map((t=>N(t,e.graph))))),e.where&&e.where.length>0){t=g({type:"group",patterns:e.where});const r=e.using;r?t=u.createFrom(t,r.default,r.named):e.graph&&(t=v(t,e.graph))}else"deletewhere"===e.updateType&&r.length>0&&(t=u.createBgp(r));return u.createDeleteInsert(r.length>0?r:void 0,a.length>0?a:void 0,t)}(e);throw new Error(`Unknown update type ${JSON.stringify(e)}`)}function N(e,t){let r=t;"graph"===e.type&&(r=e.name);let a=e.triples;return r&&(a=a.map((e=>Object.assign(e,{graph:r})))),a.map(R)}function _(e,t){const r={},a=Array.from(t).reduce(((e,t)=>(e[t.value]=!0,e)),{});return p.default.mapOperation(e,{[s.types.DELETE_INSERT]:e=>({result:e,recurse:!1}),[s.types.PATH]:(e,t)=>({result:t.createPath(n(e.subject),e.predicate,n(e.object),n(e.graph)),recurse:!1}),[s.types.PATTERN]:(e,t)=>({result:t.createPattern(n(e.subject),n(e.predicate),n(e.object),n(e.graph)),recurse:!1}),[s.types.CONSTRUCT]:e=>({result:u.createConstruct(_(e.input,t),e.template),recurse:!1})});function n(e){if("BlankNode"===e.termType){let t=r[e.value];return t||(t=p.default.createUniqueVariable(e.value,a,u.dataFactory),a[t.value]=!0,r[e.value]=t),t}return e}}},87625:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(94522),n=r(20539);class s{static flatten(e){return Array.prototype.concat(...e).filter((e=>e))}static objectify(e){if(e.termType){if("Quad"===e.termType)return{type:"pattern",termType:"Quad",subject:s.objectify(e.subject),predicate:s.objectify(e.predicate),object:s.objectify(e.object),graph:s.objectify(e.graph)};{let t={termType:e.termType,value:e.value};return e.language&&(t.language=e.language),e.datatype&&(t.datatype=s.objectify(e.datatype)),t}}if(Array.isArray(e))return e.map((e=>s.objectify(e)));if(e===Object(e)){let t={};for(let r of Object.keys(e))t[r]=s.objectify(e[r]);return t}return e}static inScopeVariables(e){const t=[];function r(e){t.find((t=>e.value===t.value))||t.push(e)}function n(e){"Variable"===e.subject.termType&&r(e.subject),"Variable"===e.predicate.termType&&r(e.predicate),"Variable"===e.object.termType&&r(e.object),"Variable"===e.graph.termType&&r(e.graph),"Quad"===e.subject.termType&&n(e.subject),"Quad"===e.predicate.termType&&n(e.predicate),"Quad"===e.object.termType&&n(e.object),"Quad"===e.graph.termType&&n(e.graph)}return s.recurseOperation(e,{[a.types.EXPRESSION]:e=>{let t=e;return t.expressionType===a.expressionTypes.AGGREGATE&&t.variable&&r(t.variable),!0},[a.types.EXTEND]:e=>(r(e.variable),!0),[a.types.GRAPH]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.GROUP]:e=>(e.variables.forEach(r),!0),[a.types.PATH]:e=>{let t=e;return"Variable"===t.subject.termType&&r(t.subject),"Variable"===t.object.termType&&r(t.object),"Variable"===t.graph.termType&&r(t.graph),"Quad"===t.subject.termType&&n(t.subject),"Quad"===t.object.termType&&n(t.object),"Quad"===t.graph.termType&&n(t.graph),!0},[a.types.PATTERN]:e=>(n(e),!0),[a.types.PROJECT]:e=>(e.variables.forEach(r),!1),[a.types.SERVICE]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.VALUES]:e=>(e.variables.forEach(r),!0)}),t}static recurseOperation(e,t){let r=e,n=!0;if(t[e.type]&&(n=t[e.type](e)),!n)return;let i=e=>s.recurseOperation(e,t);switch(r.type){case a.types.ALT:const e=r;i(e.left),i(e.right);break;case a.types.ASK:i(r.input);break;case a.types.BGP:r.patterns.forEach(i);break;case a.types.CONSTRUCT:const t=r;i(t.input),t.template.map(i);break;case a.types.DESCRIBE:case a.types.DISTINCT:i(r.input);break;case a.types.EXPRESSION:const n=r;n.expressionType===a.expressionTypes.EXISTENCE&&i(n.input);break;case a.types.EXTEND:const s=r;i(s.input),i(s.expression);break;case a.types.FILTER:const p=r;i(p.input),i(p.expression);break;case a.types.FROM:case a.types.GRAPH:i(r.input);break;case a.types.GROUP:const o=r;i(o.input),o.aggregates.forEach(i);break;case a.types.INV:i(r.path);break;case a.types.JOIN:const c=r;i(c.left),i(c.right);break;case a.types.LEFT_JOIN:const u=r;i(u.left),i(u.right),u.expression&&i(u.expression);break;case a.types.LINK:break;case a.types.MINUS:const l=r;i(l.left),i(l.right);break;case a.types.NOP:case a.types.NPS:break;case a.types.ONE_OR_MORE_PATH:i(r.path);break;case a.types.ORDER_BY:const d=r;i(d.input),d.expressions.forEach(i);break;case a.types.PATH:i(r.predicate);break;case a.types.PATTERN:break;case a.types.PROJECT:case a.types.REDUCED:i(r.input);break;case a.types.SEQ:const y=r;i(y.left),i(y.right);break;case a.types.SERVICE:case a.types.SLICE:i(r.input);break;case a.types.UNION:const f=r;i(f.left),i(f.right);break;case a.types.VALUES:break;case a.types.ZERO_OR_MORE_PATH:case a.types.ZERO_OR_ONE_PATH:i(r.path);break;case a.types.COMPOSITE_UPDATE:r.updates.forEach((e=>i(e)));break;case a.types.DELETE_INSERT:const h=r;h.delete&&h.delete.forEach((e=>i(e))),h.insert&&h.insert.forEach((e=>i(e))),h.where&&i(h.where);break;case a.types.LOAD:case a.types.CLEAR:case a.types.CREATE:case a.types.DROP:case a.types.ADD:case a.types.MOVE:case a.types.COPY:break;default:throw new Error(`Unknown Operation type ${r.type}`)}}static mapOperation(e,t,r){let i=e,p=!0;if(r=r||new n.default,t[e.type]&&({result:i,recurse:p}=t[e.type](e,r)),!p)return i;let o=e=>s.mapOperation(e,t,r);switch(i.type){case a.types.ALT:const e=i;return r.createAlt(o(e.left),o(e.right));case a.types.ASK:const n=i;return r.createAsk(o(n.input));case a.types.BGP:const p=i;return r.createBgp(p.patterns.map(o));case a.types.CONSTRUCT:const c=i;return r.createConstruct(o(c.input),c.template.map(o));case a.types.DESCRIBE:const u=i;return r.createDescribe(o(u.input),u.terms);case a.types.DISTINCT:const l=i;return r.createDistinct(o(l.input));case a.types.EXPRESSION:const d=i;return s.mapExpression(d,t,r);case a.types.EXTEND:const y=i;return r.createExtend(o(y.input),y.variable,o(y.expression));case a.types.FILTER:const f=i;return r.createFilter(o(f.input),o(f.expression));case a.types.FROM:const h=i;return r.createFrom(o(h.input),[].concat(h.default),[].concat(h.named));case a.types.GRAPH:const m=i;return r.createGraph(o(m.input),m.name);case a.types.GROUP:const g=i;return r.createGroup(o(g.input),[].concat(g.variables),g.aggregates.map(o));case a.types.INV:const E=i;return r.createInv(o(E.path));case a.types.JOIN:const b=i;return r.createJoin(o(b.left),o(b.right));case a.types.LEFT_JOIN:const T=i;return r.createLeftJoin(o(T.left),o(T.right),T.expression?o(T.expression):void 0);case a.types.LINK:const O=i;return r.createLink(O.iri);case a.types.MINUS:const R=i;return r.createMinus(o(R.left),o(R.right));case a.types.NOP:return r.createNop();case a.types.NPS:const S=i;return r.createNps([].concat(S.iris));case a.types.ONE_OR_MORE_PATH:const v=i;return r.createOneOrMorePath(o(v.path));case a.types.ORDER_BY:const w=i;return r.createOrderBy(o(w.input),w.expressions.map(o));case a.types.PATH:const P=i;return r.createPath(P.subject,o(P.predicate),P.object,P.graph);case a.types.PATTERN:const A=i;return r.createPattern(A.subject,A.predicate,A.object,A.graph);case a.types.PROJECT:const x=i;return r.createProject(o(x.input),[].concat(x.variables));case a.types.REDUCED:const j=i;return r.createReduced(o(j.input));case a.types.SEQ:const N=i;return r.createSeq(o(N.left),o(N.right));case a.types.SERVICE:const _=i;return r.createService(o(_.input),_.name,_.silent);case a.types.SLICE:const I=i;return r.createSlice(o(I.input),I.start,I.length);case a.types.UNION:const C=i;return r.createUnion(o(C.left),o(C.right));case a.types.VALUES:const D=i;return r.createValues([].concat(D.variables),D.bindings.map((e=>Object.assign({},e))));case a.types.ZERO_OR_MORE_PATH:const q=i;return r.createZeroOrMorePath(o(q.path));case a.types.ZERO_OR_ONE_PATH:const M=i;return r.createZeroOrOnePath(o(M.path));case a.types.COMPOSITE_UPDATE:const L=i;return r.createCompositeUpdate(L.updates.map(o));case a.types.DELETE_INSERT:const k=i;return r.createDeleteInsert(k.delete?k.delete.map(o):void 0,k.insert?k.insert.map(o):void 0,k.where?o(k.where):void 0);case a.types.LOAD:const U=i;return r.createLoad(U.source,U.destination,U.silent);case a.types.CLEAR:const G=i;return r.createClear(G.source,G.silent);case a.types.CREATE:const H=i;return r.createCreate(H.source,H.silent);case a.types.DROP:const B=i;return r.createDrop(B.source,B.silent);case a.types.ADD:const F=i;return r.createAdd(F.source,F.destination);case a.types.MOVE:const Q=i;return r.createMove(Q.source,Q.destination);case a.types.COPY:const J=i;return r.createCopy(J.source,J.destination);default:throw new Error(`Unknown Operation type ${i.type}`)}}static mapExpression(e,t,r){let n=e=>s.mapOperation(e,t,r);switch(e.expressionType){case a.expressionTypes.AGGREGATE:if(e.variable){const t=e;return r.createBoundAggregate(t.variable,t.aggregator,n(t.expression),t.distinct,t.separator)}const t=e;return r.createAggregateExpression(t.aggregator,n(t.expression),t.distinct,t.separator);case a.expressionTypes.EXISTENCE:const s=e;return r.createExistenceExpression(s.not,n(s.input));case a.expressionTypes.NAMED:const i=e;return r.createNamedExpression(i.name,i.args.map(n));case a.expressionTypes.OPERATOR:const p=e;return r.createOperatorExpression(p.operator,p.args.map(n));case a.expressionTypes.TERM:const o=e;return r.createTermExpression(o.term);case a.expressionTypes.WILDCARD:return r.createWildcardExpression();default:throw new Error(`Unknown Expression type ${e.expressionType}`)}}static createUniqueVariable(e,t,r){let a=0,n=e;for(;t[n];)n=`${e}${a++}`;return r.variable(n)}static isSimpleTerm(e){return void 0!==e.termType&&"Quad"!==e.termType&&"Wildcard"!==e.termType}static isQuad(e){return"Quad"===e.termType}static isWildcard(e){return"Wildcard"===e.termType}}t.default=s},43411:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(18909),t)},18909:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationNop=void 0;const a=r(67213),n=r(55505);class s extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"nop")}async testOperation(e,t){return!0}async runOperation(e,t){return{bindingsStream:new n.SingletonIterator(a.Bindings({})),metadata:()=>Promise.resolve({totalItems:1}),type:"bindings",variables:[],canContainUndefs:!1}}}t.ActorQueryOperationNop=s},73569:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(98910),t)},98910:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationAddRewrite=void 0;const a=r(67213),n=r(41640),s=r(69827),i=new n.DataFactory;class p extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"add"),this.factory=new s.Factory}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}runOperation(e,t){const r="DEFAULT"===e.destination?i.defaultGraph():e.destination,a="DEFAULT"===e.source?i.defaultGraph():e.source,n=this.factory.createDeleteInsert(void 0,[this.factory.createPattern(i.variable("s"),i.variable("p"),i.variable("o"),r)],this.factory.createPattern(i.variable("s"),i.variable("p"),i.variable("o"),a));return this.mediatorQueryOperation.mediate({operation:n,context:t})}}t.ActorQueryOperationAddRewrite=p},69827:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.toSparqlJs=t.toSparql=t.Factory=t.Algebra=t.translate=void 0;const a=r(10997);t.translate=a.default;const n=r(86569);t.Algebra=n;const s=r(25128);t.Factory=s.default;const i=r(98841);Object.defineProperty(t,"toSparql",{enumerable:!0,get:function(){return i.toSparql}}),Object.defineProperty(t,"toSparqlJs",{enumerable:!0,get:function(){return i.toSparqlJs}});const p=r(27347);t.Util=p.default},86569:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expressionTypes=t.types=void 0,t.types={ALT:"alt",ASK:"ask",BGP:"bgp",CONSTRUCT:"construct",DESC:"desc",DESCRIBE:"describe",DISTINCT:"distinct",EXPRESSION:"expression",EXTEND:"extend",FILTER:"filter",FROM:"from",GRAPH:"graph",GROUP:"group",INV:"inv",JOIN:"join",LEFT_JOIN:"leftjoin",LINK:"link",MINUS:"minus",NOP:"nop",NPS:"nps",ONE_OR_MORE_PATH:"OneOrMorePath",ORDER_BY:"orderby",PATH:"path",PATTERN:"pattern",PROJECT:"project",REDUCED:"reduced",SEQ:"seq",SERVICE:"service",SLICE:"slice",UNION:"union",VALUES:"values",ZERO_OR_MORE_PATH:"ZeroOrMorePath",ZERO_OR_ONE_PATH:"ZeroOrOnePath",COMPOSITE_UPDATE:"compositeupdate",DELETE_INSERT:"deleteinsert",LOAD:"load",CLEAR:"clear",CREATE:"create",DROP:"drop",ADD:"add",MOVE:"move",COPY:"copy"},t.expressionTypes={AGGREGATE:"aggregate",EXISTENCE:"existence",NAMED:"named",OPERATOR:"operator",TERM:"term",WILDCARD:"wildcard"}},25128:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(86569),n=r(41640),s=r(22086),i=r(9619);t.default=class{constructor(e){this.dataFactory=e||new n.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(e,t){return{type:a.types.ALT,left:e,right:t}}createAsk(e){return{type:a.types.ASK,input:e}}createBoundAggregate(e,t,r,a,n){let s=this.createAggregateExpression(t,r,a,n);return s.variable=e,s}createBgp(e){return{type:a.types.BGP,patterns:e}}createConstruct(e,t){return{type:a.types.CONSTRUCT,input:e,template:t}}createDescribe(e,t){return{type:a.types.DESCRIBE,input:e,terms:t}}createDistinct(e){return{type:a.types.DISTINCT,input:e}}createExtend(e,t,r){return{type:a.types.EXTEND,input:e,variable:t,expression:r}}createFrom(e,t,r){return{type:a.types.FROM,input:e,default:t,named:r}}createFilter(e,t){return{type:a.types.FILTER,input:e,expression:t}}createGraph(e,t){return{type:a.types.GRAPH,input:e,name:t}}createGroup(e,t,r){return{type:a.types.GROUP,input:e,variables:t,aggregates:r}}createInv(e){return{type:a.types.INV,path:e}}createJoin(e,t){return{type:a.types.JOIN,left:e,right:t}}createLeftJoin(e,t,r){return r?{type:a.types.LEFT_JOIN,left:e,right:t,expression:r}:{type:a.types.LEFT_JOIN,left:e,right:t}}createLink(e){return{type:a.types.LINK,iri:e}}createMinus(e,t){return{type:a.types.MINUS,left:e,right:t}}createNop(){return{type:a.types.NOP}}createNps(e){return{type:a.types.NPS,iris:e}}createOneOrMorePath(e){return{type:a.types.ONE_OR_MORE_PATH,path:e}}createOrderBy(e,t){return{type:a.types.ORDER_BY,input:e,expressions:t}}createPath(e,t,r,n){return n?{type:a.types.PATH,subject:e,predicate:t,object:r,graph:n}:{type:a.types.PATH,subject:e,predicate:t,object:r,graph:this.dataFactory.defaultGraph()}}createPattern(e,t,r,n){let s=this.dataFactory.quad(e,t,r,n);return s.type=a.types.PATTERN,s}createProject(e,t){return{type:a.types.PROJECT,input:e,variables:t}}createReduced(e){return{type:a.types.REDUCED,input:e}}createSeq(e,t){return{type:a.types.SEQ,left:e,right:t}}createService(e,t,r){return{type:a.types.SERVICE,input:e,name:t,silent:r}}createSlice(e,t,r){return t=t||0,void 0!==r?{type:a.types.SLICE,input:e,start:t,length:r}:{type:a.types.SLICE,input:e,start:t}}createUnion(e,t){return{type:a.types.UNION,left:e,right:t}}createValues(e,t){return{type:a.types.VALUES,variables:e,bindings:t}}createZeroOrMorePath(e){return{type:a.types.ZERO_OR_MORE_PATH,path:e}}createZeroOrOnePath(e){return{type:a.types.ZERO_OR_ONE_PATH,path:e}}createAggregateExpression(e,t,r,n){return n?{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,separator:n,distinct:r}:{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,distinct:r}}createExistenceExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.EXISTENCE,not:e,input:t}}createNamedExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.NAMED,name:e,args:t}}createOperatorExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.OPERATOR,operator:e,args:t}}createTermExpression(e){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.TERM,term:e}}createWildcardExpression(){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.WILDCARD,wildcard:new i.Wildcard}}createTerm(e){return s.stringToTerm(e,this.dataFactory)}createCompositeUpdate(e){return{type:a.types.COMPOSITE_UPDATE,updates:e}}createDeleteInsert(e,t,r){const n={type:a.types.DELETE_INSERT};return e&&(n.delete=e),t&&(n.insert=t),r&&(n.where=r),n}createLoad(e,t,r){const n={type:a.types.LOAD,source:e};return t&&(n.destination=t),this.addSilent(n,r)}createClear(e,t){return this.addSilent({type:a.types.CLEAR,source:e},t)}createCreate(e,t){return this.addSilent({type:a.types.CREATE,source:e},t)}createDrop(e,t){return this.addSilent({type:a.types.DROP,source:e},t)}createAdd(e,t,r){return this.addSilent({type:a.types.ADD,source:e,destination:t},r)}createMove(e,t,r){return this.addSilent({type:a.types.MOVE,source:e,destination:t},r)}createCopy(e,t,r){return this.addSilent({type:a.types.COPY,source:e,destination:t},r)}addSilent(e,t){return t&&(e.silent=t),e}}},98841:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSparqlJs=t.toSparql=void 0;const a=r(76065),n=r(22086),s=r(9619),i=r(86569),p=r(25128),o=r(27347),c=i.types,u=i.expressionTypes;let l;const d=new p.default;function y(e){f();let t=h(e=function(e){return A(e,{})}(e));return"group"===t.type?t.patterns[0]:t}function f(){l={project:!1,extend:[],group:[],aggregates:[],order:[]}}function h(e){switch(e.type!==c.EXTEND&&e.type!==c.ORDER_BY&&e.type!==c.GRAPH&&(l.project=!1),e.type){case c.EXPRESSION:return m(e);case c.ASK:return R(e,c.ASK);case c.BGP:return function(e){let t=e.patterns.map(T);return 0===t.length?null:{type:"bgp",triples:t}}(e);case c.CONSTRUCT:return function(e){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:e.template.map(T),where:o.default.flatten([h(e.input)])}}(e);case c.DESCRIBE:return R(e,c.DESCRIBE);case c.DISTINCT:return function(e){let t=h(e.input);return t.patterns[0].distinct=!0,t}(e);case c.EXTEND:return function(e){return l.project?(l.extend.push(e),h(e.input)):o.default.flatten([h(e.input),{type:"bind",variable:e.variable,expression:m(e.expression)}])}(e);case c.FROM:return function(e){const t=h(e.input);return t.patterns[0].from={default:e.default,named:e.named},t}(e);case c.FILTER:return function(e){return{type:"group",patterns:o.default.flatten([h(e.input),{type:"filter",expression:m(e.expression)}])}}(e);case c.GRAPH:return function(e){return{type:"graph",patterns:o.default.flatten([h(e.input)]),name:e.name}}(e);case c.GROUP:return function(e){const t=h(e.input),r=e.aggregates.map(b);return l.aggregates.push(...r),l.group.push(...e.variables),t}(e);case c.JOIN:return function(e){return o.default.flatten([h(e.left),h(e.right)]).reduce(((e,t)=>("bgp"!==t.type||0==e.length||"bgp"!==e[e.length-1].type?e.push(t):e[e.length-1].triples.push(...t.triples),e)),[])}(e);case c.LEFT_JOIN:return function(e){const t={type:"optional",patterns:[h(e.right)]};return e.expression&&t.patterns.push({type:"filter",expression:m(e.expression)}),t.patterns=o.default.flatten(t.patterns),o.default.flatten([h(e.left),t])}(e);case c.MINUS:return function(e){let t=h(e.right);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),o.default.flatten([h(e.left),{type:"minus",patterns:t}])}(e);case c.NOP:return{};case c.ORDER_BY:return function(e){return l.order.push(...e.expressions),h(e.input)}(e);case c.PATH:return function(e){return{type:"bgp",triples:[{subject:e.subject,predicate:g(e.predicate),object:e.object}]}}(e);case c.PATTERN:return T(e);case c.PROJECT:return R(e,c.PROJECT);case c.REDUCED:return function(e){let t=h(e.input);return t.patterns[0].reduced=!0,t}(e);case c.SERVICE:return function(e){let t=h(e.input);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),{type:"service",name:e.name,silent:e.silent,patterns:t}}(e);case c.SLICE:return function(e){let t=h(e.input),r=t;return t.type&&"group"===t.type&&(r=t.patterns[0]),0!==e.start&&(r.offset=e.start),void 0!==e.length&&(r.limit=e.length),t}(e);case c.UNION:return function(e){return{type:"union",patterns:o.default.flatten([h(e.left),h(e.right)])}}(e);case c.VALUES:return function(e){return{type:"values",values:e.bindings.map((t=>{let r={};for(let a of e.variables){let e=`?${a.value}`;t[e]?r[e]=t[e]:r[e]=void 0}return r}))}}(e);case c.COMPOSITE_UPDATE:return function(e){return{prefixes:{},type:"update",updates:e.updates.map((e=>h(e).updates[0]))}}(e);case c.DELETE_INSERT:return function(e){let t,r=e.where;if(r&&r.type===c.FROM){let a=e.where;r=a.input,t={default:a.default,named:a.named}}const n=[{updateType:"insertdelete",delete:P(e.delete),insert:P(e.insert)}];if(t&&(n[0].using=t),!r||r.type===c.BGP&&0===r.patterns.length)n[0].where=[];else{const e={};let t=h(A(r,e));"group"===t.type?n[0].where=t.patterns:n[0].where=[t];const a=Object.keys(e);if(a.length>0){if(1!==a.length)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");""!==e[a[0]].graph.value&&(n[0].where=[{type:"graph",patterns:n[0].where,name:e[a[0]].graph}])}}return e.delete||e.where?e.insert||e.where?!e.insert&&e.where&&"bgp"===e.where.type&&a.isomorphic(e.delete,e.where.patterns)&&(delete n[0].where,n[0].updateType="deletewhere"):(delete n[0].insert,delete n[0].where,e.delete.some((e=>"Variable"===e.subject.termType||"Variable"===e.predicate.termType||"Variable"===e.object.termType))?n[0].updateType="deletewhere":n[0].updateType="delete"):(n[0].updateType="insert",delete n[0].delete,delete n[0].where),{prefixes:{},type:"update",updates:n}}(e);case c.LOAD:return function(e){const t=[{type:"load",silent:Boolean(e.silent),source:e.source}];return e.destination&&(t[0].destination=e.destination),{prefixes:{},type:"update",updates:t}}(e);case c.CLEAR:return function(e){return v(e,"clear")}(e);case c.CREATE:return function(e){return v(e,"create")}(e);case c.DROP:return function(e){return v(e,"drop")}(e);case c.ADD:return function(e){return w(e,"add")}(e);case c.MOVE:return function(e){return w(e,"move")}(e);case c.COPY:return function(e){return w(e,"copy")}(e)}throw new Error(`Unknown Operation type ${e.type}`)}function m(e){switch(e.expressionType){case u.AGGREGATE:return function(e){const t={expression:m(e.expression),type:"aggregate",aggregation:e.aggregator,distinct:e.distinct};return e.separator&&(t.separator=e.separator),t}(e);case u.EXISTENCE:return function(e){return{type:"operation",operator:e.not?"notexists":"exists",args:o.default.flatten([h(e.input)])}}(e);case u.NAMED:return function(e){return{type:"functionCall",function:e.name,args:e.args.map(m)}}(e);case u.OPERATOR:return function(e){if("desc"===e.operator){return{expression:m(e.args[0]),descending:!0}}const t={type:"operation",operator:e.operator,args:e.args.map(m)};return"in"!==t.operator&&"notin"!==t.operator||(t.args=[t.args[0]].concat([t.args.slice(1)])),t}(e);case u.TERM:return function(e){return e.term}(e);case u.WILDCARD:return function(e){return e.wildcard}(e)}throw new Error(`Unknown Expression Operation type ${e.expressionType}`)}function g(e){switch(e.type){case c.ALT:return function(e){const t=g(e.left),r=g(e.right);return"pathType"in t&&"!"===t.pathType&&"pathType"in r&&"!"===r.pathType?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:[].concat(t.items,r.items)}]}:{type:"path",pathType:"|",items:[t,r]}}(e);case c.INV:return function(e){if(e.path.type===c.NPS){const t=e.path.iris.map((e=>({type:"path",pathType:"^",items:[e]})));return t.length<=1?{type:"path",pathType:"!",items:t}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:t}]}}return{type:"path",pathType:"^",items:[g(e.path)]}}(e);case c.LINK:return function(e){return e.iri}(e);case c.NPS:return function(e){return e.iris.length<=1?{type:"path",pathType:"!",items:e.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:e.iris}]}}(e);case c.ONE_OR_MORE_PATH:return function(e){return{type:"path",pathType:"+",items:[g(e.path)]}}(e);case c.SEQ:return function(e){return{type:"path",pathType:"/",items:[g(e.left),g(e.right)]}}(e);case c.ZERO_OR_MORE_PATH:return function(e){return{type:"path",pathType:"*",items:[g(e.path)]}}(e);case c.ZERO_OR_ONE_PATH:return function(e){return{type:"path",pathType:"?",items:[g(e.path)]}}(e)}throw new Error(`Unknown Path type ${e.type}`)}function E(e){return n.termToString(e)}function b(e){return e}function T(e){return{subject:e.subject,predicate:e.predicate,object:e.object}}function O(e,t){let r=o.default.isSimpleTerm(e)?E(e):e;if("string"==typeof r){if(t[r])return t[r]}else if(Array.isArray(e))e=e.map((e=>O(e,t)));else for(let r of Object.keys(e))e[r]=O(e[r],t);return e}function R(e,t){const r={type:"query",prefixes:{}},a=r;let n;t===c.PROJECT?(r.queryType="SELECT",n=e.variables):t===c.ASK?r.queryType="ASK":t===c.DESCRIBE&&(r.queryType="DESCRIBE",n=e.terms);const i=l.extend,p=l.group,u=l.aggregates,d=l.order;f(),l.project=!0;let y=o.default.flatten([h(e.input)]);1===y.length&&"group"===y[0].type&&(y=y[0].patterns),r.where=y;let g={};for(let e of l.aggregates)g[E(e.variable)]=m(e);let b={};for(let e=l.extend.length-1;e>=0;--e){let t=l.extend[e];b[E(t.variable)]=O(m(t.expression),g)}if(l.group.length>0&&(a.group=l.group.map((e=>{let t=E(e);if(b[t]){let r=b[t];return delete b[t],{variable:e,expression:r}}return{expression:e}}))),l.order.length>0&&(a.order=l.order.map(h).map((e=>e.descending?e:{expression:e}))),n&&(a.variables=n.map((e=>{let t=E(e);return b[t]?{variable:e,expression:b[t]}:e})),0===a.variables.length&&(a.variables=[new s.Wildcard])),r.where.length>0&&"filter"===r.where[r.where.length-1].type){const e=r.where[r.where.length-1];S(e,Object.keys(g))&&(a.having=o.default.flatten([O(e.expression,g)]),r.where.splice(-1))}return l.extend=i,l.group=p,l.aggregates=u,l.order=d,{type:"group",patterns:[a]}}function S(e,t){return o.default.isSimpleTerm(e)?t.indexOf(E(e))>=0:Array.isArray(e)?e.some((e=>S(e,t))):e===Object(e)?Object.keys(e).some((r=>S(e[r],t))):t.indexOf(e)>=0}function v(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return"DEFAULT"===e.source?r[0].graph={default:!0}:"NAMED"===e.source?r[0].graph={named:!0}:"ALL"===e.source?r[0].graph={all:!0}:r[0].graph={type:"graph",name:e.source},{prefixes:{},type:"update",updates:r}}function w(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return r[0].source="DEFAULT"===e.source?{type:"graph",default:!0}:{type:"graph",name:e.source},r[0].destination="DEFAULT"===e.destination?{type:"graph",default:!0}:{type:"graph",name:e.destination},{prefixes:{},type:"update",updates:r}}function P(e){if(!e)return[];const t={};return e.forEach((e=>{const r=e.graph.value;t[r]||(t[r]=[]),t[r].push(e)})),Object.keys(t).map((e=>""===e?{type:"bgp",triples:t[e].map(T)}:{type:"graph",triples:t[e].map(T),name:t[e][0].graph}))}function A(e,t){if(Array.isArray(e))return e.map((e=>A(e,t)));if(!e.type)return e;if(e.type===c.DELETE_INSERT)return e;if((e.type===c.PATTERN||e.type===c.PATH)&&e.graph)return t[e.graph.value]||(t[e.graph.value]={graph:e.graph,values:[]}),t[e.graph.value].values.push(e),e;const r={},a={},n={};for(let t of Object.keys(e)){const s={};r[t]=A(e[t],s);const i=Object.keys(s);if(i.length>1){let e=x(s[i[0]].values);for(let t=1;t<i.length;++t){const r=x(s[i[t]].values);e=d.createJoin(e,r)}return i.map((e=>delete s[e])),e}if(1===i.length){const e=s[i[0]].graph;a[t]=e,n[e.value]=e}}const s=Object.keys(n);if(s.length>0)if(1===s.length&&e.type!==c.PROJECT)t[s[0]]={graph:n[s[0]],values:[r]};else for(let e of Object.keys(a))a[e].value.length>0&&(r[e]=d.createGraph(r[e],a[e]));return r}function x(e){const t=d.createBgp(e),r=e[0].graph;return 0===r.value.length?t:d.createGraph(t,r)}t.toSparql=function(e,t={}){return new s.Generator(t).stringify(y(e))},t.toSparqlJs=y},10997:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(64063),n=r(22086),s=r(86569),i=r(25128),p=r(27347),o=r(9619).Parser,c=s.types;let u,l=new Set,d=0,y=!1;function f(e,t,r){if(l=new Set,d=0,y=t,!e.type)return u.createNop();if("query"!==e.type&&"update"!==e.type)throw new Error("Translate only works on complete query or update objects.");const a=new Set(Object.keys(m(e)).map(u.createTerm.bind(u)));let n;var s;return"query"===e.type?(n=g({type:"group",patterns:e.where||[]}),n=function(e,t,r){const a=e,n=[],s={};if(a.variables=a.variables&&a.variables.map((e=>x(e,s))),a.having=a.having&&a.having.map((e=>x(e,s))),a.order=a.order&&a.order.map((e=>x(e,s))),a.group||Object.keys(s).length>0){const e=Object.keys(s).map((e=>function(e,t){if("aggregate"!==e.type||!e.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(e)}`);const r=E(e);return r.variable=t,r}(s[e],u.createTerm(e)))),r=[];if(a.group)for(const e of a.group)if(p.default.isSimpleTerm(e.expression))r.push(e.expression);else{const a="variable"in e?e.variable:O();t=u.createExtend(t,a,E(e.expression)),r.push(a)}t=u.createGroup(t,r,e)}if(a.having)for(let e of a.having)t=u.createFilter(t,E(e));e.values&&(t=u.createJoin(t,A(e)));let i=new Set;if("SELECT"===e.queryType||"DESCRIBE"===e.queryType)if(e.variables.some((e=>e&&p.default.isWildcard(e))))i=r;else for(let t of e.variables)h(t)||!("variable"in t)?i.add(t):t.variable&&(i.add(t.variable),n.push(t));for(let e of n)t=u.createExtend(t,e.variable,E(e.expression));return a.order&&(t=u.createOrderBy(t,a.order.map((e=>{let t=E(e.expression);return e.descending&&(t=u.createOperatorExpression(c.DESC,[t])),t})))),"SELECT"===e.queryType&&(t=u.createProject(t,Array.from(i))),a.distinct&&(t=u.createDistinct(t)),a.reduced&&(t=u.createReduced(t)),"CONSTRUCT"===e.queryType?t=u.createConstruct(t,e.template.map(R)):"ASK"===e.queryType?t=u.createAsk(t):"DESCRIBE"===e.queryType&&(t=u.createDescribe(t,Array.from(i))),(a.offset||a.limit)&&(t=u.createSlice(t,a.offset,a.limit)),a.from&&(t=u.createFrom(t,a.from.default,a.from.named)),t}(e,n,a)):"update"===e.type&&(n=1===(s=e).updates.length?j(s.updates[0]):u.createCompositeUpdate(s.updates.map(j))),r&&(n=_(n,a)),n}function h(e){return"Variable"===(null==e?void 0:e.termType)}function m(e){let t={};if(h(e))t[n.termToString(e)]=!0,l.add(e.value);else if(null!==(r=e)&&"object"==typeof r)if("bind"===e.type)m(e.expression),Object.assign(t,m(e.variable));else if("SELECT"===e.queryType){let r=m(e.where);for(let a of e.variables)p.default.isWildcard(a)?Object.assign(t,r):a.variable?Object.assign(t,m(a.variable)):Object.assign(t,m(a));if(e.group)for(let r of e.group)Object.assign(t,m(r))}else for(let r of Object.keys(e))Object.assign(t,m(e[r]));var r;return t}function g(e){let t,r=[],a=[];if("patterns"in e)for(let t of e.patterns)("filter"===t.type?r:a).push(t);if("bgp"===e.type)return function(e){let t=[],r=[];for(let n of e.triples)if("pathType"in n.predicate){let e=T((a=n).subject,b(a.predicate),a.object);for(let a of e)a.type===c.PATH?(t.length>0&&r.push(u.createBgp(t)),t=[],r.push(a)):t.push(a)}else t.push(R(n));var a;return t.length>0&&r.push(u.createBgp(t)),1===r.length?r[0]:r.reduce(((e,t)=>u.createJoin(e,t)))}(e);if("union"===e.type)t=a.map((e=>("group"!==e.type&&(e={type:"group",patterns:[e]}),g(e)))).reduce(((e,t)=>u.createUnion(e,t)));else{if("graph"===e.type)return function(e){let t=g({type:"group",patterns:e.patterns});return t=y?v(t,e.name):u.createGraph(t,e.name),t}(e);if("group"===e.type)t=a.reduce(w,u.createBgp([]));else if("values"===e.type)t=A(e);else{if("query"!==e.type)throw new Error(`Unexpected type: ${e.type}`);t=f(e,y,!1)}}if(r.length>0){let e=r.map((e=>E(e.expression)));e.length>0&&(t=u.createFilter(t,e.reduce(((e,t)=>u.createOperatorExpression("&&",[e,t])))))}return t}function E(e){if(p.default.isSimpleTerm(e)||p.default.isQuad(e))return u.createTermExpression(e);if(p.default.isWildcard(e))return u.createWildcardExpression();if("aggregation"in e)return u.createAggregateExpression(e.aggregation,E(e.expression),e.distinct,e.separator);if("function"in e)return u.createNamedExpression(e.function,e.args.map(E));if("operator"in e)return"exists"===e.operator||"notexists"===e.operator?u.createExistenceExpression("notexists"===e.operator,g(e.args[0])):("in"!==e.operator&&"notin"!==e.operator||(e.args=[e.args[0]].concat(e.args[1])),u.createOperatorExpression(e.operator,e.args.map(E)));throw new Error(`Unknown expression: ${JSON.stringify(e)}`)}function b(e){if(p.default.isSimpleTerm(e)){if("NamedNode"===e.termType)return u.createLink(e);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(e)}`)}if("^"===e.pathType)return u.createInv(b(e.items[0]));if("!"===e.pathType){let t,r=[],a=[];t="pathType"in e.items[0]&&"|"===e.items[0].pathType?e.items[0].items:e.items;for(let e of t)if(p.default.isSimpleTerm(e))r.push(e);else{if("^"!==e.pathType)throw new Error(`Unexpected item: ${JSON.stringify(e)}`);a.push(e.items[0])}let n=u.createNps(r),s=u.createInv(u.createNps(a));return 0===a.length?n:0===r.length?s:u.createAlt(n,s)}if("/"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createSeq(e,t)));if("|"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createAlt(e,t)));if("*"===e.pathType)return u.createZeroOrMorePath(b(e.items[0]));if("+"===e.pathType)return u.createOneOrMorePath(b(e.items[0]));if("?"===e.pathType)return u.createZeroOrOnePath(b(e.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(e)}`)}function T(e,t,r){if(t.type===c.LINK)return[u.createPattern(e,t.iri,r)];if(t.type===c.INV)return T(r,t.path,e);if(t.type===c.SEQ){let a=O(),n=T(e,t.left,a),s=T(a,t.right,r);return n.concat(s)}return[u.createPath(e,t,r)]}function O(){let e="?var"+d++;return l.has(e)?O():(l.add(e),u.createTerm(e))}function R(e){return u.createPattern(e.subject,e.predicate,e.object,e.graph)}t.default=function(e,t){let r;if(t=t||{},u=new i.default(t.dataFactory),"string"==typeof e){let a=new o(t);a._resetBlanks(),r=a.parse(e)}else r=e;return f(r,t.quads,t.blankToVariable)};let S=Object.values(c);function v(e,t,r){if(e.type===c.GRAPH){if(r)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");const t=e;e=v(t.input,t.name)}else if(e.type===c.BGP)e.patterns=e.patterns.map((e=>(r&&(e.subject.equals(t)&&(e.subject=r),e.predicate.equals(t)&&(e.predicate=r),e.object.equals(t)&&(e.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t),e)));else if(e.type===c.PATH){const a=e;r&&(a.subject.equals(t)&&(a.subject=r),a.object.equals(t)&&(a.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t)}else if(e.type!==c.PROJECT||r)if(e.type!==c.EXTEND||r)for(let a of Object.keys(e))Array.isArray(e[a])?e[a]=e[a].map((e=>v(e,t,r))):S.indexOf(e[a].type)>=0?e[a]=v(e[a],t,r):r&&h(e[a])&&e[a].equals(t)&&(e[a]=r);else{const a=e;a.variable.equals(t)&&(r=O()),a.input=v(a.input,t,r)}else{const a=e;a.variables.some((e=>e.equals(t)))||(r=O()),a.input=v(a.input,t,r)}return e}function w(e,t){if("optional"===t.type){const r=g({type:"group",patterns:t.patterns});if(r.type===c.FILTER){const t=r;e=u.createLeftJoin(e,t.input,t.expression)}else e=u.createLeftJoin(e,r)}else if("minus"===t.type){const r=g({type:"group",patterns:t.patterns});e=u.createMinus(e,r)}else if("bind"===t.type)e=u.createExtend(e,t.variable,E(t.expression));else if("service"===t.type){const r={type:"group",patterns:t.patterns};e=P(e,u.createService(g(r),t.name,t.silent))}else e=P(e,g(t));return e}function P(e,t){return e.type===c.BGP&&t.type===c.BGP?e=u.createBgp([].concat(e.patterns,t.patterns)):e.type===c.BGP&&0===e.patterns.length?e=t:t.type===c.BGP&&0===t.patterns.length||(e=u.createJoin(e,t)),e}function A(e){let t=(0===e.values.length?[]:Object.keys(e.values[0])).map(u.createTerm.bind(u)),r=e.values.map((e=>{let t=Object.keys(e);t=t.filter((t=>void 0!==e[t]));let r={};for(let a of t)r[a]=e[a];return r}));return u.createValues(t,r)}function x(e,t){if("type"in e&&"aggregate"===e.type){let r,s=!1;for(let n of Object.keys(t))if(a(t[n],e)){r=u.createTerm(n),s=!0;break}return s||(r=O(),t[n.termToString(r)]=e),r}return"expression"in e&&e.expression?Object.assign(Object.assign({},e),{expression:x(e.expression,t)}):"args"in e&&e.args?Object.assign(Object.assign({},e),{args:e.args.map((e=>x(e,t)))}):e}function j(e){if("type"in e){if("load"===e.type)return function(e){return u.createLoad(e.source,e.destination,e.silent)}(e);if("clear"===e.type||"create"===e.type||"drop"===e.type)return function(e){let t;switch(t=p.default.isSimpleTerm(e.graph)?e.graph:e.graph.all?"ALL":e.graph.default?"DEFAULT":e.graph.named?"NAMED":e.graph.name,e.type){case"clear":return u.createClear(t,e.silent);case"create":return u.createCreate(t,e.silent);case"drop":return u.createDrop(t,e.silent)}}(e);if("add"===e.type||"copy"===e.type||"move"===e.type)return function(e){const t=e.source.default?"DEFAULT":e.source.name,r=e.destination.default?"DEFAULT":e.destination.name;switch(e.type){case"copy":return u.createCopy(t,r,e.silent);case"move":return u.createMove(t,r,e.silent);case"add":return u.createAdd(t,r,e.silent)}}(e)}else if("insertdelete"===e.updateType||"deletewhere"===e.updateType||"delete"===e.updateType||"insert"===e.updateType)return function(e){if(!y)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let t,r=[],a=[];if(e.delete&&(r=p.default.flatten(e.delete.map((t=>N(t,e.graph))))),e.insert&&(a=p.default.flatten(e.insert.map((t=>N(t,e.graph))))),e.where&&e.where.length>0){t=g({type:"group",patterns:e.where});const r=e.using;r?t=u.createFrom(t,r.default,r.named):e.graph&&(t=v(t,e.graph))}else"deletewhere"===e.updateType&&r.length>0&&(t=u.createBgp(r));return u.createDeleteInsert(r.length>0?r:void 0,a.length>0?a:void 0,t)}(e);throw new Error(`Unknown update type ${JSON.stringify(e)}`)}function N(e,t){let r=t;"graph"===e.type&&(r=e.name);let a=e.triples;return r&&(a=a.map((e=>Object.assign(e,{graph:r})))),a.map(R)}function _(e,t){const r={},a=Array.from(t).reduce(((e,t)=>(e[t.value]=!0,e)),{});return p.default.mapOperation(e,{[s.types.DELETE_INSERT]:e=>({result:e,recurse:!1}),[s.types.PATH]:(e,t)=>({result:t.createPath(n(e.subject),e.predicate,n(e.object),n(e.graph)),recurse:!1}),[s.types.PATTERN]:(e,t)=>({result:t.createPattern(n(e.subject),n(e.predicate),n(e.object),n(e.graph)),recurse:!1}),[s.types.CONSTRUCT]:e=>({result:u.createConstruct(_(e.input,t),e.template),recurse:!1})});function n(e){if("BlankNode"===e.termType){let t=r[e.value];return t||(t=p.default.createUniqueVariable(e.value,a,u.dataFactory),a[t.value]=!0,r[e.value]=t),t}return e}}},27347:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(86569),n=r(25128);class s{static flatten(e){return Array.prototype.concat(...e).filter((e=>e))}static objectify(e){if(e.termType){if("Quad"===e.termType)return{type:"pattern",termType:"Quad",subject:s.objectify(e.subject),predicate:s.objectify(e.predicate),object:s.objectify(e.object),graph:s.objectify(e.graph)};{let t={termType:e.termType,value:e.value};return e.language&&(t.language=e.language),e.datatype&&(t.datatype=s.objectify(e.datatype)),t}}if(Array.isArray(e))return e.map((e=>s.objectify(e)));if(e===Object(e)){let t={};for(let r of Object.keys(e))t[r]=s.objectify(e[r]);return t}return e}static inScopeVariables(e){const t=[];function r(e){t.find((t=>e.value===t.value))||t.push(e)}function n(e){"Variable"===e.subject.termType&&r(e.subject),"Variable"===e.predicate.termType&&r(e.predicate),"Variable"===e.object.termType&&r(e.object),"Variable"===e.graph.termType&&r(e.graph),"Quad"===e.subject.termType&&n(e.subject),"Quad"===e.predicate.termType&&n(e.predicate),"Quad"===e.object.termType&&n(e.object),"Quad"===e.graph.termType&&n(e.graph)}return s.recurseOperation(e,{[a.types.EXPRESSION]:e=>{let t=e;return t.expressionType===a.expressionTypes.AGGREGATE&&t.variable&&r(t.variable),!0},[a.types.EXTEND]:e=>(r(e.variable),!0),[a.types.GRAPH]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.GROUP]:e=>(e.variables.forEach(r),!0),[a.types.PATH]:e=>{let t=e;return"Variable"===t.subject.termType&&r(t.subject),"Variable"===t.object.termType&&r(t.object),"Variable"===t.graph.termType&&r(t.graph),"Quad"===t.subject.termType&&n(t.subject),"Quad"===t.object.termType&&n(t.object),"Quad"===t.graph.termType&&n(t.graph),!0},[a.types.PATTERN]:e=>(n(e),!0),[a.types.PROJECT]:e=>(e.variables.forEach(r),!1),[a.types.SERVICE]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.VALUES]:e=>(e.variables.forEach(r),!0)}),t}static recurseOperation(e,t){let r=e,n=!0;if(t[e.type]&&(n=t[e.type](e)),!n)return;let i=e=>s.recurseOperation(e,t);switch(r.type){case a.types.ALT:const e=r;i(e.left),i(e.right);break;case a.types.ASK:i(r.input);break;case a.types.BGP:r.patterns.forEach(i);break;case a.types.CONSTRUCT:const t=r;i(t.input),t.template.map(i);break;case a.types.DESCRIBE:case a.types.DISTINCT:i(r.input);break;case a.types.EXPRESSION:const n=r;n.expressionType===a.expressionTypes.EXISTENCE&&i(n.input);break;case a.types.EXTEND:const s=r;i(s.input),i(s.expression);break;case a.types.FILTER:const p=r;i(p.input),i(p.expression);break;case a.types.FROM:case a.types.GRAPH:i(r.input);break;case a.types.GROUP:const o=r;i(o.input),o.aggregates.forEach(i);break;case a.types.INV:i(r.path);break;case a.types.JOIN:const c=r;i(c.left),i(c.right);break;case a.types.LEFT_JOIN:const u=r;i(u.left),i(u.right),u.expression&&i(u.expression);break;case a.types.LINK:break;case a.types.MINUS:const l=r;i(l.left),i(l.right);break;case a.types.NOP:case a.types.NPS:break;case a.types.ONE_OR_MORE_PATH:i(r.path);break;case a.types.ORDER_BY:const d=r;i(d.input),d.expressions.forEach(i);break;case a.types.PATH:i(r.predicate);break;case a.types.PATTERN:break;case a.types.PROJECT:case a.types.REDUCED:i(r.input);break;case a.types.SEQ:const y=r;i(y.left),i(y.right);break;case a.types.SERVICE:case a.types.SLICE:i(r.input);break;case a.types.UNION:const f=r;i(f.left),i(f.right);break;case a.types.VALUES:break;case a.types.ZERO_OR_MORE_PATH:case a.types.ZERO_OR_ONE_PATH:i(r.path);break;case a.types.COMPOSITE_UPDATE:r.updates.forEach((e=>i(e)));break;case a.types.DELETE_INSERT:const h=r;h.delete&&h.delete.forEach((e=>i(e))),h.insert&&h.insert.forEach((e=>i(e))),h.where&&i(h.where);break;case a.types.LOAD:case a.types.CLEAR:case a.types.CREATE:case a.types.DROP:case a.types.ADD:case a.types.MOVE:case a.types.COPY:break;default:throw new Error(`Unknown Operation type ${r.type}`)}}static mapOperation(e,t,r){let i=e,p=!0;if(r=r||new n.default,t[e.type]&&({result:i,recurse:p}=t[e.type](e,r)),!p)return i;let o=e=>s.mapOperation(e,t,r);switch(i.type){case a.types.ALT:const e=i;return r.createAlt(o(e.left),o(e.right));case a.types.ASK:const n=i;return r.createAsk(o(n.input));case a.types.BGP:const p=i;return r.createBgp(p.patterns.map(o));case a.types.CONSTRUCT:const c=i;return r.createConstruct(o(c.input),c.template.map(o));case a.types.DESCRIBE:const u=i;return r.createDescribe(o(u.input),u.terms);case a.types.DISTINCT:const l=i;return r.createDistinct(o(l.input));case a.types.EXPRESSION:const d=i;return s.mapExpression(d,t,r);case a.types.EXTEND:const y=i;return r.createExtend(o(y.input),y.variable,o(y.expression));case a.types.FILTER:const f=i;return r.createFilter(o(f.input),o(f.expression));case a.types.FROM:const h=i;return r.createFrom(o(h.input),[].concat(h.default),[].concat(h.named));case a.types.GRAPH:const m=i;return r.createGraph(o(m.input),m.name);case a.types.GROUP:const g=i;return r.createGroup(o(g.input),[].concat(g.variables),g.aggregates.map(o));case a.types.INV:const E=i;return r.createInv(o(E.path));case a.types.JOIN:const b=i;return r.createJoin(o(b.left),o(b.right));case a.types.LEFT_JOIN:const T=i;return r.createLeftJoin(o(T.left),o(T.right),T.expression?o(T.expression):void 0);case a.types.LINK:const O=i;return r.createLink(O.iri);case a.types.MINUS:const R=i;return r.createMinus(o(R.left),o(R.right));case a.types.NOP:return r.createNop();case a.types.NPS:const S=i;return r.createNps([].concat(S.iris));case a.types.ONE_OR_MORE_PATH:const v=i;return r.createOneOrMorePath(o(v.path));case a.types.ORDER_BY:const w=i;return r.createOrderBy(o(w.input),w.expressions.map(o));case a.types.PATH:const P=i;return r.createPath(P.subject,o(P.predicate),P.object,P.graph);case a.types.PATTERN:const A=i;return r.createPattern(A.subject,A.predicate,A.object,A.graph);case a.types.PROJECT:const x=i;return r.createProject(o(x.input),[].concat(x.variables));case a.types.REDUCED:const j=i;return r.createReduced(o(j.input));case a.types.SEQ:const N=i;return r.createSeq(o(N.left),o(N.right));case a.types.SERVICE:const _=i;return r.createService(o(_.input),_.name,_.silent);case a.types.SLICE:const I=i;return r.createSlice(o(I.input),I.start,I.length);case a.types.UNION:const C=i;return r.createUnion(o(C.left),o(C.right));case a.types.VALUES:const D=i;return r.createValues([].concat(D.variables),D.bindings.map((e=>Object.assign({},e))));case a.types.ZERO_OR_MORE_PATH:const q=i;return r.createZeroOrMorePath(o(q.path));case a.types.ZERO_OR_ONE_PATH:const M=i;return r.createZeroOrOnePath(o(M.path));case a.types.COMPOSITE_UPDATE:const L=i;return r.createCompositeUpdate(L.updates.map(o));case a.types.DELETE_INSERT:const k=i;return r.createDeleteInsert(k.delete?k.delete.map(o):void 0,k.insert?k.insert.map(o):void 0,k.where?o(k.where):void 0);case a.types.LOAD:const U=i;return r.createLoad(U.source,U.destination,U.silent);case a.types.CLEAR:const G=i;return r.createClear(G.source,G.silent);case a.types.CREATE:const H=i;return r.createCreate(H.source,H.silent);case a.types.DROP:const B=i;return r.createDrop(B.source,B.silent);case a.types.ADD:const F=i;return r.createAdd(F.source,F.destination);case a.types.MOVE:const Q=i;return r.createMove(Q.source,Q.destination);case a.types.COPY:const J=i;return r.createCopy(J.source,J.destination);default:throw new Error(`Unknown Operation type ${i.type}`)}}static mapExpression(e,t,r){let n=e=>s.mapOperation(e,t,r);switch(e.expressionType){case a.expressionTypes.AGGREGATE:if(e.variable){const t=e;return r.createBoundAggregate(t.variable,t.aggregator,n(t.expression),t.distinct,t.separator)}const t=e;return r.createAggregateExpression(t.aggregator,n(t.expression),t.distinct,t.separator);case a.expressionTypes.EXISTENCE:const s=e;return r.createExistenceExpression(s.not,n(s.input));case a.expressionTypes.NAMED:const i=e;return r.createNamedExpression(i.name,i.args.map(n));case a.expressionTypes.OPERATOR:const p=e;return r.createOperatorExpression(p.operator,p.args.map(n));case a.expressionTypes.TERM:const o=e;return r.createTermExpression(o.term);case a.expressionTypes.WILDCARD:return r.createWildcardExpression();default:throw new Error(`Unknown Expression type ${e.expressionType}`)}}static createUniqueVariable(e,t,r){let a=0,n=e;for(;t[n];)n=`${e}${a++}`;return r.variable(n)}static isSimpleTerm(e){return void 0!==e.termType&&"Quad"!==e.termType&&"Wildcard"!==e.termType}static isQuad(e){return"Quad"===e.termType}static isWildcard(e){return"Wildcard"===e.termType}}t.default=s},28034:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(74193),t)},74193:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationClear=void 0;const a=r(67213),n=new(r(41640).DataFactory);class s extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"clear")}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}async runOperation(e,t){let r;r="DEFAULT"===e.source?n.defaultGraph():"string"==typeof e.source?e.source:[e.source];const{updateResult:a}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:r,requireExistence:!e.silent,dropGraphs:!1},context:t});return{type:"update",updateResult:a}}}t.ActorQueryOperationClear=s},64207:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(68303),t)},68303:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationUpdateCompositeUpdate=void 0;const a=r(67213);class n extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"compositeupdate")}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}async runOperation(e,t){return{type:"update",updateResult:(async()=>{for(const r of e.updates){const e=a.ActorQueryOperation.getSafeUpdate(await this.mediatorQueryOperation.mediate({operation:r,context:t}));await e.updateResult}})()}}}t.ActorQueryOperationUpdateCompositeUpdate=n},86585:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(23307),t)},23307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationCopyRewrite=void 0;const a=r(67213),n=r(31658);class s extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"copy"),this.factory=new n.Factory}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}runOperation(e,t){if("string"==typeof e.destination&&"string"==typeof e.source&&e.destination===e.source||"string"!=typeof e.destination&&"string"!=typeof e.source&&e.destination.equals(e.source))return Promise.resolve({type:"update",updateResult:Promise.resolve()});const r=this.factory.createCompositeUpdate([this.factory.createDrop(e.destination,!0),this.factory.createAdd(e.source,e.destination,e.silent)]);return this.mediatorQueryOperation.mediate({operation:r,context:t})}}t.ActorQueryOperationCopyRewrite=s},31658:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.toSparqlJs=t.toSparql=t.Factory=t.Algebra=t.translate=void 0;const a=r(79569);t.translate=a.default;const n=r(68040);t.Algebra=n;const s=r(70318);t.Factory=s.default;const i=r(35171);Object.defineProperty(t,"toSparql",{enumerable:!0,get:function(){return i.toSparql}}),Object.defineProperty(t,"toSparqlJs",{enumerable:!0,get:function(){return i.toSparqlJs}});const p=r(93011);t.Util=p.default},68040:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expressionTypes=t.types=void 0,t.types={ALT:"alt",ASK:"ask",BGP:"bgp",CONSTRUCT:"construct",DESC:"desc",DESCRIBE:"describe",DISTINCT:"distinct",EXPRESSION:"expression",EXTEND:"extend",FILTER:"filter",FROM:"from",GRAPH:"graph",GROUP:"group",INV:"inv",JOIN:"join",LEFT_JOIN:"leftjoin",LINK:"link",MINUS:"minus",NOP:"nop",NPS:"nps",ONE_OR_MORE_PATH:"OneOrMorePath",ORDER_BY:"orderby",PATH:"path",PATTERN:"pattern",PROJECT:"project",REDUCED:"reduced",SEQ:"seq",SERVICE:"service",SLICE:"slice",UNION:"union",VALUES:"values",ZERO_OR_MORE_PATH:"ZeroOrMorePath",ZERO_OR_ONE_PATH:"ZeroOrOnePath",COMPOSITE_UPDATE:"compositeupdate",DELETE_INSERT:"deleteinsert",LOAD:"load",CLEAR:"clear",CREATE:"create",DROP:"drop",ADD:"add",MOVE:"move",COPY:"copy"},t.expressionTypes={AGGREGATE:"aggregate",EXISTENCE:"existence",NAMED:"named",OPERATOR:"operator",TERM:"term",WILDCARD:"wildcard"}},70318:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(68040),n=r(41640),s=r(22086),i=r(9619);t.default=class{constructor(e){this.dataFactory=e||new n.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(e,t){return{type:a.types.ALT,left:e,right:t}}createAsk(e){return{type:a.types.ASK,input:e}}createBoundAggregate(e,t,r,a,n){let s=this.createAggregateExpression(t,r,a,n);return s.variable=e,s}createBgp(e){return{type:a.types.BGP,patterns:e}}createConstruct(e,t){return{type:a.types.CONSTRUCT,input:e,template:t}}createDescribe(e,t){return{type:a.types.DESCRIBE,input:e,terms:t}}createDistinct(e){return{type:a.types.DISTINCT,input:e}}createExtend(e,t,r){return{type:a.types.EXTEND,input:e,variable:t,expression:r}}createFrom(e,t,r){return{type:a.types.FROM,input:e,default:t,named:r}}createFilter(e,t){return{type:a.types.FILTER,input:e,expression:t}}createGraph(e,t){return{type:a.types.GRAPH,input:e,name:t}}createGroup(e,t,r){return{type:a.types.GROUP,input:e,variables:t,aggregates:r}}createInv(e){return{type:a.types.INV,path:e}}createJoin(e,t){return{type:a.types.JOIN,left:e,right:t}}createLeftJoin(e,t,r){return r?{type:a.types.LEFT_JOIN,left:e,right:t,expression:r}:{type:a.types.LEFT_JOIN,left:e,right:t}}createLink(e){return{type:a.types.LINK,iri:e}}createMinus(e,t){return{type:a.types.MINUS,left:e,right:t}}createNop(){return{type:a.types.NOP}}createNps(e){return{type:a.types.NPS,iris:e}}createOneOrMorePath(e){return{type:a.types.ONE_OR_MORE_PATH,path:e}}createOrderBy(e,t){return{type:a.types.ORDER_BY,input:e,expressions:t}}createPath(e,t,r,n){return n?{type:a.types.PATH,subject:e,predicate:t,object:r,graph:n}:{type:a.types.PATH,subject:e,predicate:t,object:r,graph:this.dataFactory.defaultGraph()}}createPattern(e,t,r,n){let s=this.dataFactory.quad(e,t,r,n);return s.type=a.types.PATTERN,s}createProject(e,t){return{type:a.types.PROJECT,input:e,variables:t}}createReduced(e){return{type:a.types.REDUCED,input:e}}createSeq(e,t){return{type:a.types.SEQ,left:e,right:t}}createService(e,t,r){return{type:a.types.SERVICE,input:e,name:t,silent:r}}createSlice(e,t,r){return t=t||0,void 0!==r?{type:a.types.SLICE,input:e,start:t,length:r}:{type:a.types.SLICE,input:e,start:t}}createUnion(e,t){return{type:a.types.UNION,left:e,right:t}}createValues(e,t){return{type:a.types.VALUES,variables:e,bindings:t}}createZeroOrMorePath(e){return{type:a.types.ZERO_OR_MORE_PATH,path:e}}createZeroOrOnePath(e){return{type:a.types.ZERO_OR_ONE_PATH,path:e}}createAggregateExpression(e,t,r,n){return n?{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,separator:n,distinct:r}:{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,distinct:r}}createExistenceExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.EXISTENCE,not:e,input:t}}createNamedExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.NAMED,name:e,args:t}}createOperatorExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.OPERATOR,operator:e,args:t}}createTermExpression(e){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.TERM,term:e}}createWildcardExpression(){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.WILDCARD,wildcard:new i.Wildcard}}createTerm(e){return s.stringToTerm(e,this.dataFactory)}createCompositeUpdate(e){return{type:a.types.COMPOSITE_UPDATE,updates:e}}createDeleteInsert(e,t,r){const n={type:a.types.DELETE_INSERT};return e&&(n.delete=e),t&&(n.insert=t),r&&(n.where=r),n}createLoad(e,t,r){const n={type:a.types.LOAD,source:e};return t&&(n.destination=t),this.addSilent(n,r)}createClear(e,t){return this.addSilent({type:a.types.CLEAR,source:e},t)}createCreate(e,t){return this.addSilent({type:a.types.CREATE,source:e},t)}createDrop(e,t){return this.addSilent({type:a.types.DROP,source:e},t)}createAdd(e,t,r){return this.addSilent({type:a.types.ADD,source:e,destination:t},r)}createMove(e,t,r){return this.addSilent({type:a.types.MOVE,source:e,destination:t},r)}createCopy(e,t,r){return this.addSilent({type:a.types.COPY,source:e,destination:t},r)}addSilent(e,t){return t&&(e.silent=t),e}}},35171:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSparqlJs=t.toSparql=void 0;const a=r(76065),n=r(22086),s=r(9619),i=r(68040),p=r(70318),o=r(93011),c=i.types,u=i.expressionTypes;let l;const d=new p.default;function y(e){f();let t=h(e=function(e){return A(e,{})}(e));return"group"===t.type?t.patterns[0]:t}function f(){l={project:!1,extend:[],group:[],aggregates:[],order:[]}}function h(e){switch(e.type!==c.EXTEND&&e.type!==c.ORDER_BY&&e.type!==c.GRAPH&&(l.project=!1),e.type){case c.EXPRESSION:return m(e);case c.ASK:return R(e,c.ASK);case c.BGP:return function(e){let t=e.patterns.map(T);return 0===t.length?null:{type:"bgp",triples:t}}(e);case c.CONSTRUCT:return function(e){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:e.template.map(T),where:o.default.flatten([h(e.input)])}}(e);case c.DESCRIBE:return R(e,c.DESCRIBE);case c.DISTINCT:return function(e){let t=h(e.input);return t.patterns[0].distinct=!0,t}(e);case c.EXTEND:return function(e){return l.project?(l.extend.push(e),h(e.input)):o.default.flatten([h(e.input),{type:"bind",variable:e.variable,expression:m(e.expression)}])}(e);case c.FROM:return function(e){const t=h(e.input);return t.patterns[0].from={default:e.default,named:e.named},t}(e);case c.FILTER:return function(e){return{type:"group",patterns:o.default.flatten([h(e.input),{type:"filter",expression:m(e.expression)}])}}(e);case c.GRAPH:return function(e){return{type:"graph",patterns:o.default.flatten([h(e.input)]),name:e.name}}(e);case c.GROUP:return function(e){const t=h(e.input),r=e.aggregates.map(b);return l.aggregates.push(...r),l.group.push(...e.variables),t}(e);case c.JOIN:return function(e){return o.default.flatten([h(e.left),h(e.right)]).reduce(((e,t)=>("bgp"!==t.type||0==e.length||"bgp"!==e[e.length-1].type?e.push(t):e[e.length-1].triples.push(...t.triples),e)),[])}(e);case c.LEFT_JOIN:return function(e){const t={type:"optional",patterns:[h(e.right)]};return e.expression&&t.patterns.push({type:"filter",expression:m(e.expression)}),t.patterns=o.default.flatten(t.patterns),o.default.flatten([h(e.left),t])}(e);case c.MINUS:return function(e){let t=h(e.right);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),o.default.flatten([h(e.left),{type:"minus",patterns:t}])}(e);case c.NOP:return{};case c.ORDER_BY:return function(e){return l.order.push(...e.expressions),h(e.input)}(e);case c.PATH:return function(e){return{type:"bgp",triples:[{subject:e.subject,predicate:g(e.predicate),object:e.object}]}}(e);case c.PATTERN:return T(e);case c.PROJECT:return R(e,c.PROJECT);case c.REDUCED:return function(e){let t=h(e.input);return t.patterns[0].reduced=!0,t}(e);case c.SERVICE:return function(e){let t=h(e.input);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),{type:"service",name:e.name,silent:e.silent,patterns:t}}(e);case c.SLICE:return function(e){let t=h(e.input),r=t;return t.type&&"group"===t.type&&(r=t.patterns[0]),0!==e.start&&(r.offset=e.start),void 0!==e.length&&(r.limit=e.length),t}(e);case c.UNION:return function(e){return{type:"union",patterns:o.default.flatten([h(e.left),h(e.right)])}}(e);case c.VALUES:return function(e){return{type:"values",values:e.bindings.map((t=>{let r={};for(let a of e.variables){let e=`?${a.value}`;t[e]?r[e]=t[e]:r[e]=void 0}return r}))}}(e);case c.COMPOSITE_UPDATE:return function(e){return{prefixes:{},type:"update",updates:e.updates.map((e=>h(e).updates[0]))}}(e);case c.DELETE_INSERT:return function(e){let t,r=e.where;if(r&&r.type===c.FROM){let a=e.where;r=a.input,t={default:a.default,named:a.named}}const n=[{updateType:"insertdelete",delete:P(e.delete),insert:P(e.insert)}];if(t&&(n[0].using=t),!r||r.type===c.BGP&&0===r.patterns.length)n[0].where=[];else{const e={};let t=h(A(r,e));"group"===t.type?n[0].where=t.patterns:n[0].where=[t];const a=Object.keys(e);if(a.length>0){if(1!==a.length)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");""!==e[a[0]].graph.value&&(n[0].where=[{type:"graph",patterns:n[0].where,name:e[a[0]].graph}])}}return e.delete||e.where?e.insert||e.where?!e.insert&&e.where&&"bgp"===e.where.type&&a.isomorphic(e.delete,e.where.patterns)&&(delete n[0].where,n[0].updateType="deletewhere"):(delete n[0].insert,delete n[0].where,e.delete.some((e=>"Variable"===e.subject.termType||"Variable"===e.predicate.termType||"Variable"===e.object.termType))?n[0].updateType="deletewhere":n[0].updateType="delete"):(n[0].updateType="insert",delete n[0].delete,delete n[0].where),{prefixes:{},type:"update",updates:n}}(e);case c.LOAD:return function(e){const t=[{type:"load",silent:Boolean(e.silent),source:e.source}];return e.destination&&(t[0].destination=e.destination),{prefixes:{},type:"update",updates:t}}(e);case c.CLEAR:return function(e){return v(e,"clear")}(e);case c.CREATE:return function(e){return v(e,"create")}(e);case c.DROP:return function(e){return v(e,"drop")}(e);case c.ADD:return function(e){return w(e,"add")}(e);case c.MOVE:return function(e){return w(e,"move")}(e);case c.COPY:return function(e){return w(e,"copy")}(e)}throw new Error(`Unknown Operation type ${e.type}`)}function m(e){switch(e.expressionType){case u.AGGREGATE:return function(e){const t={expression:m(e.expression),type:"aggregate",aggregation:e.aggregator,distinct:e.distinct};return e.separator&&(t.separator=e.separator),t}(e);case u.EXISTENCE:return function(e){return{type:"operation",operator:e.not?"notexists":"exists",args:o.default.flatten([h(e.input)])}}(e);case u.NAMED:return function(e){return{type:"functionCall",function:e.name,args:e.args.map(m)}}(e);case u.OPERATOR:return function(e){if("desc"===e.operator){return{expression:m(e.args[0]),descending:!0}}const t={type:"operation",operator:e.operator,args:e.args.map(m)};return"in"!==t.operator&&"notin"!==t.operator||(t.args=[t.args[0]].concat([t.args.slice(1)])),t}(e);case u.TERM:return function(e){return e.term}(e);case u.WILDCARD:return function(e){return e.wildcard}(e)}throw new Error(`Unknown Expression Operation type ${e.expressionType}`)}function g(e){switch(e.type){case c.ALT:return function(e){const t=g(e.left),r=g(e.right);return"pathType"in t&&"!"===t.pathType&&"pathType"in r&&"!"===r.pathType?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:[].concat(t.items,r.items)}]}:{type:"path",pathType:"|",items:[t,r]}}(e);case c.INV:return function(e){if(e.path.type===c.NPS){const t=e.path.iris.map((e=>({type:"path",pathType:"^",items:[e]})));return t.length<=1?{type:"path",pathType:"!",items:t}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:t}]}}return{type:"path",pathType:"^",items:[g(e.path)]}}(e);case c.LINK:return function(e){return e.iri}(e);case c.NPS:return function(e){return e.iris.length<=1?{type:"path",pathType:"!",items:e.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:e.iris}]}}(e);case c.ONE_OR_MORE_PATH:return function(e){return{type:"path",pathType:"+",items:[g(e.path)]}}(e);case c.SEQ:return function(e){return{type:"path",pathType:"/",items:[g(e.left),g(e.right)]}}(e);case c.ZERO_OR_MORE_PATH:return function(e){return{type:"path",pathType:"*",items:[g(e.path)]}}(e);case c.ZERO_OR_ONE_PATH:return function(e){return{type:"path",pathType:"?",items:[g(e.path)]}}(e)}throw new Error(`Unknown Path type ${e.type}`)}function E(e){return n.termToString(e)}function b(e){return e}function T(e){return{subject:e.subject,predicate:e.predicate,object:e.object}}function O(e,t){let r=o.default.isSimpleTerm(e)?E(e):e;if("string"==typeof r){if(t[r])return t[r]}else if(Array.isArray(e))e=e.map((e=>O(e,t)));else for(let r of Object.keys(e))e[r]=O(e[r],t);return e}function R(e,t){const r={type:"query",prefixes:{}},a=r;let n;t===c.PROJECT?(r.queryType="SELECT",n=e.variables):t===c.ASK?r.queryType="ASK":t===c.DESCRIBE&&(r.queryType="DESCRIBE",n=e.terms);const i=l.extend,p=l.group,u=l.aggregates,d=l.order;f(),l.project=!0;let y=o.default.flatten([h(e.input)]);1===y.length&&"group"===y[0].type&&(y=y[0].patterns),r.where=y;let g={};for(let e of l.aggregates)g[E(e.variable)]=m(e);let b={};for(let e=l.extend.length-1;e>=0;--e){let t=l.extend[e];b[E(t.variable)]=O(m(t.expression),g)}if(l.group.length>0&&(a.group=l.group.map((e=>{let t=E(e);if(b[t]){let r=b[t];return delete b[t],{variable:e,expression:r}}return{expression:e}}))),l.order.length>0&&(a.order=l.order.map(h).map((e=>e.descending?e:{expression:e}))),n&&(a.variables=n.map((e=>{let t=E(e);return b[t]?{variable:e,expression:b[t]}:e})),0===a.variables.length&&(a.variables=[new s.Wildcard])),r.where.length>0&&"filter"===r.where[r.where.length-1].type){const e=r.where[r.where.length-1];S(e,Object.keys(g))&&(a.having=o.default.flatten([O(e.expression,g)]),r.where.splice(-1))}return l.extend=i,l.group=p,l.aggregates=u,l.order=d,{type:"group",patterns:[a]}}function S(e,t){return o.default.isSimpleTerm(e)?t.indexOf(E(e))>=0:Array.isArray(e)?e.some((e=>S(e,t))):e===Object(e)?Object.keys(e).some((r=>S(e[r],t))):t.indexOf(e)>=0}function v(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return"DEFAULT"===e.source?r[0].graph={default:!0}:"NAMED"===e.source?r[0].graph={named:!0}:"ALL"===e.source?r[0].graph={all:!0}:r[0].graph={type:"graph",name:e.source},{prefixes:{},type:"update",updates:r}}function w(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return r[0].source="DEFAULT"===e.source?{type:"graph",default:!0}:{type:"graph",name:e.source},r[0].destination="DEFAULT"===e.destination?{type:"graph",default:!0}:{type:"graph",name:e.destination},{prefixes:{},type:"update",updates:r}}function P(e){if(!e)return[];const t={};return e.forEach((e=>{const r=e.graph.value;t[r]||(t[r]=[]),t[r].push(e)})),Object.keys(t).map((e=>""===e?{type:"bgp",triples:t[e].map(T)}:{type:"graph",triples:t[e].map(T),name:t[e][0].graph}))}function A(e,t){if(Array.isArray(e))return e.map((e=>A(e,t)));if(!e.type)return e;if(e.type===c.DELETE_INSERT)return e;if((e.type===c.PATTERN||e.type===c.PATH)&&e.graph)return t[e.graph.value]||(t[e.graph.value]={graph:e.graph,values:[]}),t[e.graph.value].values.push(e),e;const r={},a={},n={};for(let t of Object.keys(e)){const s={};r[t]=A(e[t],s);const i=Object.keys(s);if(i.length>1){let e=x(s[i[0]].values);for(let t=1;t<i.length;++t){const r=x(s[i[t]].values);e=d.createJoin(e,r)}return i.map((e=>delete s[e])),e}if(1===i.length){const e=s[i[0]].graph;a[t]=e,n[e.value]=e}}const s=Object.keys(n);if(s.length>0)if(1===s.length&&e.type!==c.PROJECT)t[s[0]]={graph:n[s[0]],values:[r]};else for(let e of Object.keys(a))a[e].value.length>0&&(r[e]=d.createGraph(r[e],a[e]));return r}function x(e){const t=d.createBgp(e),r=e[0].graph;return 0===r.value.length?t:d.createGraph(t,r)}t.toSparql=function(e,t={}){return new s.Generator(t).stringify(y(e))},t.toSparqlJs=y},79569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(64063),n=r(22086),s=r(68040),i=r(70318),p=r(93011),o=r(9619).Parser,c=s.types;let u,l=new Set,d=0,y=!1;function f(e,t,r){if(l=new Set,d=0,y=t,!e.type)return u.createNop();if("query"!==e.type&&"update"!==e.type)throw new Error("Translate only works on complete query or update objects.");const a=new Set(Object.keys(m(e)).map(u.createTerm.bind(u)));let n;var s;return"query"===e.type?(n=g({type:"group",patterns:e.where||[]}),n=function(e,t,r){const a=e,n=[],s={};if(a.variables=a.variables&&a.variables.map((e=>x(e,s))),a.having=a.having&&a.having.map((e=>x(e,s))),a.order=a.order&&a.order.map((e=>x(e,s))),a.group||Object.keys(s).length>0){const e=Object.keys(s).map((e=>function(e,t){if("aggregate"!==e.type||!e.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(e)}`);const r=E(e);return r.variable=t,r}(s[e],u.createTerm(e)))),r=[];if(a.group)for(const e of a.group)if(p.default.isSimpleTerm(e.expression))r.push(e.expression);else{const a="variable"in e?e.variable:O();t=u.createExtend(t,a,E(e.expression)),r.push(a)}t=u.createGroup(t,r,e)}if(a.having)for(let e of a.having)t=u.createFilter(t,E(e));e.values&&(t=u.createJoin(t,A(e)));let i=new Set;if("SELECT"===e.queryType||"DESCRIBE"===e.queryType)if(e.variables.some((e=>e&&p.default.isWildcard(e))))i=r;else for(let t of e.variables)h(t)||!("variable"in t)?i.add(t):t.variable&&(i.add(t.variable),n.push(t));for(let e of n)t=u.createExtend(t,e.variable,E(e.expression));return a.order&&(t=u.createOrderBy(t,a.order.map((e=>{let t=E(e.expression);return e.descending&&(t=u.createOperatorExpression(c.DESC,[t])),t})))),"SELECT"===e.queryType&&(t=u.createProject(t,Array.from(i))),a.distinct&&(t=u.createDistinct(t)),a.reduced&&(t=u.createReduced(t)),"CONSTRUCT"===e.queryType?t=u.createConstruct(t,e.template.map(R)):"ASK"===e.queryType?t=u.createAsk(t):"DESCRIBE"===e.queryType&&(t=u.createDescribe(t,Array.from(i))),(a.offset||a.limit)&&(t=u.createSlice(t,a.offset,a.limit)),a.from&&(t=u.createFrom(t,a.from.default,a.from.named)),t}(e,n,a)):"update"===e.type&&(n=1===(s=e).updates.length?j(s.updates[0]):u.createCompositeUpdate(s.updates.map(j))),r&&(n=_(n,a)),n}function h(e){return"Variable"===(null==e?void 0:e.termType)}function m(e){let t={};if(h(e))t[n.termToString(e)]=!0,l.add(e.value);else if(null!==(r=e)&&"object"==typeof r)if("bind"===e.type)m(e.expression),Object.assign(t,m(e.variable));else if("SELECT"===e.queryType){let r=m(e.where);for(let a of e.variables)p.default.isWildcard(a)?Object.assign(t,r):a.variable?Object.assign(t,m(a.variable)):Object.assign(t,m(a));if(e.group)for(let r of e.group)Object.assign(t,m(r))}else for(let r of Object.keys(e))Object.assign(t,m(e[r]));var r;return t}function g(e){let t,r=[],a=[];if("patterns"in e)for(let t of e.patterns)("filter"===t.type?r:a).push(t);if("bgp"===e.type)return function(e){let t=[],r=[];for(let n of e.triples)if("pathType"in n.predicate){let e=T((a=n).subject,b(a.predicate),a.object);for(let a of e)a.type===c.PATH?(t.length>0&&r.push(u.createBgp(t)),t=[],r.push(a)):t.push(a)}else t.push(R(n));var a;return t.length>0&&r.push(u.createBgp(t)),1===r.length?r[0]:r.reduce(((e,t)=>u.createJoin(e,t)))}(e);if("union"===e.type)t=a.map((e=>("group"!==e.type&&(e={type:"group",patterns:[e]}),g(e)))).reduce(((e,t)=>u.createUnion(e,t)));else{if("graph"===e.type)return function(e){let t=g({type:"group",patterns:e.patterns});return t=y?v(t,e.name):u.createGraph(t,e.name),t}(e);if("group"===e.type)t=a.reduce(w,u.createBgp([]));else if("values"===e.type)t=A(e);else{if("query"!==e.type)throw new Error(`Unexpected type: ${e.type}`);t=f(e,y,!1)}}if(r.length>0){let e=r.map((e=>E(e.expression)));e.length>0&&(t=u.createFilter(t,e.reduce(((e,t)=>u.createOperatorExpression("&&",[e,t])))))}return t}function E(e){if(p.default.isSimpleTerm(e)||p.default.isQuad(e))return u.createTermExpression(e);if(p.default.isWildcard(e))return u.createWildcardExpression();if("aggregation"in e)return u.createAggregateExpression(e.aggregation,E(e.expression),e.distinct,e.separator);if("function"in e)return u.createNamedExpression(e.function,e.args.map(E));if("operator"in e)return"exists"===e.operator||"notexists"===e.operator?u.createExistenceExpression("notexists"===e.operator,g(e.args[0])):("in"!==e.operator&&"notin"!==e.operator||(e.args=[e.args[0]].concat(e.args[1])),u.createOperatorExpression(e.operator,e.args.map(E)));throw new Error(`Unknown expression: ${JSON.stringify(e)}`)}function b(e){if(p.default.isSimpleTerm(e)){if("NamedNode"===e.termType)return u.createLink(e);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(e)}`)}if("^"===e.pathType)return u.createInv(b(e.items[0]));if("!"===e.pathType){let t,r=[],a=[];t="pathType"in e.items[0]&&"|"===e.items[0].pathType?e.items[0].items:e.items;for(let e of t)if(p.default.isSimpleTerm(e))r.push(e);else{if("^"!==e.pathType)throw new Error(`Unexpected item: ${JSON.stringify(e)}`);a.push(e.items[0])}let n=u.createNps(r),s=u.createInv(u.createNps(a));return 0===a.length?n:0===r.length?s:u.createAlt(n,s)}if("/"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createSeq(e,t)));if("|"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createAlt(e,t)));if("*"===e.pathType)return u.createZeroOrMorePath(b(e.items[0]));if("+"===e.pathType)return u.createOneOrMorePath(b(e.items[0]));if("?"===e.pathType)return u.createZeroOrOnePath(b(e.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(e)}`)}function T(e,t,r){if(t.type===c.LINK)return[u.createPattern(e,t.iri,r)];if(t.type===c.INV)return T(r,t.path,e);if(t.type===c.SEQ){let a=O(),n=T(e,t.left,a),s=T(a,t.right,r);return n.concat(s)}return[u.createPath(e,t,r)]}function O(){let e="?var"+d++;return l.has(e)?O():(l.add(e),u.createTerm(e))}function R(e){return u.createPattern(e.subject,e.predicate,e.object,e.graph)}t.default=function(e,t){let r;if(t=t||{},u=new i.default(t.dataFactory),"string"==typeof e){let a=new o(t);a._resetBlanks(),r=a.parse(e)}else r=e;return f(r,t.quads,t.blankToVariable)};let S=Object.values(c);function v(e,t,r){if(e.type===c.GRAPH){if(r)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");const t=e;e=v(t.input,t.name)}else if(e.type===c.BGP)e.patterns=e.patterns.map((e=>(r&&(e.subject.equals(t)&&(e.subject=r),e.predicate.equals(t)&&(e.predicate=r),e.object.equals(t)&&(e.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t),e)));else if(e.type===c.PATH){const a=e;r&&(a.subject.equals(t)&&(a.subject=r),a.object.equals(t)&&(a.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t)}else if(e.type!==c.PROJECT||r)if(e.type!==c.EXTEND||r)for(let a of Object.keys(e))Array.isArray(e[a])?e[a]=e[a].map((e=>v(e,t,r))):S.indexOf(e[a].type)>=0?e[a]=v(e[a],t,r):r&&h(e[a])&&e[a].equals(t)&&(e[a]=r);else{const a=e;a.variable.equals(t)&&(r=O()),a.input=v(a.input,t,r)}else{const a=e;a.variables.some((e=>e.equals(t)))||(r=O()),a.input=v(a.input,t,r)}return e}function w(e,t){if("optional"===t.type){const r=g({type:"group",patterns:t.patterns});if(r.type===c.FILTER){const t=r;e=u.createLeftJoin(e,t.input,t.expression)}else e=u.createLeftJoin(e,r)}else if("minus"===t.type){const r=g({type:"group",patterns:t.patterns});e=u.createMinus(e,r)}else if("bind"===t.type)e=u.createExtend(e,t.variable,E(t.expression));else if("service"===t.type){const r={type:"group",patterns:t.patterns};e=P(e,u.createService(g(r),t.name,t.silent))}else e=P(e,g(t));return e}function P(e,t){return e.type===c.BGP&&t.type===c.BGP?e=u.createBgp([].concat(e.patterns,t.patterns)):e.type===c.BGP&&0===e.patterns.length?e=t:t.type===c.BGP&&0===t.patterns.length||(e=u.createJoin(e,t)),e}function A(e){let t=(0===e.values.length?[]:Object.keys(e.values[0])).map(u.createTerm.bind(u)),r=e.values.map((e=>{let t=Object.keys(e);t=t.filter((t=>void 0!==e[t]));let r={};for(let a of t)r[a]=e[a];return r}));return u.createValues(t,r)}function x(e,t){if("type"in e&&"aggregate"===e.type){let r,s=!1;for(let n of Object.keys(t))if(a(t[n],e)){r=u.createTerm(n),s=!0;break}return s||(r=O(),t[n.termToString(r)]=e),r}return"expression"in e&&e.expression?Object.assign(Object.assign({},e),{expression:x(e.expression,t)}):"args"in e&&e.args?Object.assign(Object.assign({},e),{args:e.args.map((e=>x(e,t)))}):e}function j(e){if("type"in e){if("load"===e.type)return function(e){return u.createLoad(e.source,e.destination,e.silent)}(e);if("clear"===e.type||"create"===e.type||"drop"===e.type)return function(e){let t;switch(t=p.default.isSimpleTerm(e.graph)?e.graph:e.graph.all?"ALL":e.graph.default?"DEFAULT":e.graph.named?"NAMED":e.graph.name,e.type){case"clear":return u.createClear(t,e.silent);case"create":return u.createCreate(t,e.silent);case"drop":return u.createDrop(t,e.silent)}}(e);if("add"===e.type||"copy"===e.type||"move"===e.type)return function(e){const t=e.source.default?"DEFAULT":e.source.name,r=e.destination.default?"DEFAULT":e.destination.name;switch(e.type){case"copy":return u.createCopy(t,r,e.silent);case"move":return u.createMove(t,r,e.silent);case"add":return u.createAdd(t,r,e.silent)}}(e)}else if("insertdelete"===e.updateType||"deletewhere"===e.updateType||"delete"===e.updateType||"insert"===e.updateType)return function(e){if(!y)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let t,r=[],a=[];if(e.delete&&(r=p.default.flatten(e.delete.map((t=>N(t,e.graph))))),e.insert&&(a=p.default.flatten(e.insert.map((t=>N(t,e.graph))))),e.where&&e.where.length>0){t=g({type:"group",patterns:e.where});const r=e.using;r?t=u.createFrom(t,r.default,r.named):e.graph&&(t=v(t,e.graph))}else"deletewhere"===e.updateType&&r.length>0&&(t=u.createBgp(r));return u.createDeleteInsert(r.length>0?r:void 0,a.length>0?a:void 0,t)}(e);throw new Error(`Unknown update type ${JSON.stringify(e)}`)}function N(e,t){let r=t;"graph"===e.type&&(r=e.name);let a=e.triples;return r&&(a=a.map((e=>Object.assign(e,{graph:r})))),a.map(R)}function _(e,t){const r={},a=Array.from(t).reduce(((e,t)=>(e[t.value]=!0,e)),{});return p.default.mapOperation(e,{[s.types.DELETE_INSERT]:e=>({result:e,recurse:!1}),[s.types.PATH]:(e,t)=>({result:t.createPath(n(e.subject),e.predicate,n(e.object),n(e.graph)),recurse:!1}),[s.types.PATTERN]:(e,t)=>({result:t.createPattern(n(e.subject),n(e.predicate),n(e.object),n(e.graph)),recurse:!1}),[s.types.CONSTRUCT]:e=>({result:u.createConstruct(_(e.input,t),e.template),recurse:!1})});function n(e){if("BlankNode"===e.termType){let t=r[e.value];return t||(t=p.default.createUniqueVariable(e.value,a,u.dataFactory),a[t.value]=!0,r[e.value]=t),t}return e}}},93011:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(68040),n=r(70318);class s{static flatten(e){return Array.prototype.concat(...e).filter((e=>e))}static objectify(e){if(e.termType){if("Quad"===e.termType)return{type:"pattern",termType:"Quad",subject:s.objectify(e.subject),predicate:s.objectify(e.predicate),object:s.objectify(e.object),graph:s.objectify(e.graph)};{let t={termType:e.termType,value:e.value};return e.language&&(t.language=e.language),e.datatype&&(t.datatype=s.objectify(e.datatype)),t}}if(Array.isArray(e))return e.map((e=>s.objectify(e)));if(e===Object(e)){let t={};for(let r of Object.keys(e))t[r]=s.objectify(e[r]);return t}return e}static inScopeVariables(e){const t=[];function r(e){t.find((t=>e.value===t.value))||t.push(e)}function n(e){"Variable"===e.subject.termType&&r(e.subject),"Variable"===e.predicate.termType&&r(e.predicate),"Variable"===e.object.termType&&r(e.object),"Variable"===e.graph.termType&&r(e.graph),"Quad"===e.subject.termType&&n(e.subject),"Quad"===e.predicate.termType&&n(e.predicate),"Quad"===e.object.termType&&n(e.object),"Quad"===e.graph.termType&&n(e.graph)}return s.recurseOperation(e,{[a.types.EXPRESSION]:e=>{let t=e;return t.expressionType===a.expressionTypes.AGGREGATE&&t.variable&&r(t.variable),!0},[a.types.EXTEND]:e=>(r(e.variable),!0),[a.types.GRAPH]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.GROUP]:e=>(e.variables.forEach(r),!0),[a.types.PATH]:e=>{let t=e;return"Variable"===t.subject.termType&&r(t.subject),"Variable"===t.object.termType&&r(t.object),"Variable"===t.graph.termType&&r(t.graph),"Quad"===t.subject.termType&&n(t.subject),"Quad"===t.object.termType&&n(t.object),"Quad"===t.graph.termType&&n(t.graph),!0},[a.types.PATTERN]:e=>(n(e),!0),[a.types.PROJECT]:e=>(e.variables.forEach(r),!1),[a.types.SERVICE]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.VALUES]:e=>(e.variables.forEach(r),!0)}),t}static recurseOperation(e,t){let r=e,n=!0;if(t[e.type]&&(n=t[e.type](e)),!n)return;let i=e=>s.recurseOperation(e,t);switch(r.type){case a.types.ALT:const e=r;i(e.left),i(e.right);break;case a.types.ASK:i(r.input);break;case a.types.BGP:r.patterns.forEach(i);break;case a.types.CONSTRUCT:const t=r;i(t.input),t.template.map(i);break;case a.types.DESCRIBE:case a.types.DISTINCT:i(r.input);break;case a.types.EXPRESSION:const n=r;n.expressionType===a.expressionTypes.EXISTENCE&&i(n.input);break;case a.types.EXTEND:const s=r;i(s.input),i(s.expression);break;case a.types.FILTER:const p=r;i(p.input),i(p.expression);break;case a.types.FROM:case a.types.GRAPH:i(r.input);break;case a.types.GROUP:const o=r;i(o.input),o.aggregates.forEach(i);break;case a.types.INV:i(r.path);break;case a.types.JOIN:const c=r;i(c.left),i(c.right);break;case a.types.LEFT_JOIN:const u=r;i(u.left),i(u.right),u.expression&&i(u.expression);break;case a.types.LINK:break;case a.types.MINUS:const l=r;i(l.left),i(l.right);break;case a.types.NOP:case a.types.NPS:break;case a.types.ONE_OR_MORE_PATH:i(r.path);break;case a.types.ORDER_BY:const d=r;i(d.input),d.expressions.forEach(i);break;case a.types.PATH:i(r.predicate);break;case a.types.PATTERN:break;case a.types.PROJECT:case a.types.REDUCED:i(r.input);break;case a.types.SEQ:const y=r;i(y.left),i(y.right);break;case a.types.SERVICE:case a.types.SLICE:i(r.input);break;case a.types.UNION:const f=r;i(f.left),i(f.right);break;case a.types.VALUES:break;case a.types.ZERO_OR_MORE_PATH:case a.types.ZERO_OR_ONE_PATH:i(r.path);break;case a.types.COMPOSITE_UPDATE:r.updates.forEach((e=>i(e)));break;case a.types.DELETE_INSERT:const h=r;h.delete&&h.delete.forEach((e=>i(e))),h.insert&&h.insert.forEach((e=>i(e))),h.where&&i(h.where);break;case a.types.LOAD:case a.types.CLEAR:case a.types.CREATE:case a.types.DROP:case a.types.ADD:case a.types.MOVE:case a.types.COPY:break;default:throw new Error(`Unknown Operation type ${r.type}`)}}static mapOperation(e,t,r){let i=e,p=!0;if(r=r||new n.default,t[e.type]&&({result:i,recurse:p}=t[e.type](e,r)),!p)return i;let o=e=>s.mapOperation(e,t,r);switch(i.type){case a.types.ALT:const e=i;return r.createAlt(o(e.left),o(e.right));case a.types.ASK:const n=i;return r.createAsk(o(n.input));case a.types.BGP:const p=i;return r.createBgp(p.patterns.map(o));case a.types.CONSTRUCT:const c=i;return r.createConstruct(o(c.input),c.template.map(o));case a.types.DESCRIBE:const u=i;return r.createDescribe(o(u.input),u.terms);case a.types.DISTINCT:const l=i;return r.createDistinct(o(l.input));case a.types.EXPRESSION:const d=i;return s.mapExpression(d,t,r);case a.types.EXTEND:const y=i;return r.createExtend(o(y.input),y.variable,o(y.expression));case a.types.FILTER:const f=i;return r.createFilter(o(f.input),o(f.expression));case a.types.FROM:const h=i;return r.createFrom(o(h.input),[].concat(h.default),[].concat(h.named));case a.types.GRAPH:const m=i;return r.createGraph(o(m.input),m.name);case a.types.GROUP:const g=i;return r.createGroup(o(g.input),[].concat(g.variables),g.aggregates.map(o));case a.types.INV:const E=i;return r.createInv(o(E.path));case a.types.JOIN:const b=i;return r.createJoin(o(b.left),o(b.right));case a.types.LEFT_JOIN:const T=i;return r.createLeftJoin(o(T.left),o(T.right),T.expression?o(T.expression):void 0);case a.types.LINK:const O=i;return r.createLink(O.iri);case a.types.MINUS:const R=i;return r.createMinus(o(R.left),o(R.right));case a.types.NOP:return r.createNop();case a.types.NPS:const S=i;return r.createNps([].concat(S.iris));case a.types.ONE_OR_MORE_PATH:const v=i;return r.createOneOrMorePath(o(v.path));case a.types.ORDER_BY:const w=i;return r.createOrderBy(o(w.input),w.expressions.map(o));case a.types.PATH:const P=i;return r.createPath(P.subject,o(P.predicate),P.object,P.graph);case a.types.PATTERN:const A=i;return r.createPattern(A.subject,A.predicate,A.object,A.graph);case a.types.PROJECT:const x=i;return r.createProject(o(x.input),[].concat(x.variables));case a.types.REDUCED:const j=i;return r.createReduced(o(j.input));case a.types.SEQ:const N=i;return r.createSeq(o(N.left),o(N.right));case a.types.SERVICE:const _=i;return r.createService(o(_.input),_.name,_.silent);case a.types.SLICE:const I=i;return r.createSlice(o(I.input),I.start,I.length);case a.types.UNION:const C=i;return r.createUnion(o(C.left),o(C.right));case a.types.VALUES:const D=i;return r.createValues([].concat(D.variables),D.bindings.map((e=>Object.assign({},e))));case a.types.ZERO_OR_MORE_PATH:const q=i;return r.createZeroOrMorePath(o(q.path));case a.types.ZERO_OR_ONE_PATH:const M=i;return r.createZeroOrOnePath(o(M.path));case a.types.COMPOSITE_UPDATE:const L=i;return r.createCompositeUpdate(L.updates.map(o));case a.types.DELETE_INSERT:const k=i;return r.createDeleteInsert(k.delete?k.delete.map(o):void 0,k.insert?k.insert.map(o):void 0,k.where?o(k.where):void 0);case a.types.LOAD:const U=i;return r.createLoad(U.source,U.destination,U.silent);case a.types.CLEAR:const G=i;return r.createClear(G.source,G.silent);case a.types.CREATE:const H=i;return r.createCreate(H.source,H.silent);case a.types.DROP:const B=i;return r.createDrop(B.source,B.silent);case a.types.ADD:const F=i;return r.createAdd(F.source,F.destination);case a.types.MOVE:const Q=i;return r.createMove(Q.source,Q.destination);case a.types.COPY:const J=i;return r.createCopy(J.source,J.destination);default:throw new Error(`Unknown Operation type ${i.type}`)}}static mapExpression(e,t,r){let n=e=>s.mapOperation(e,t,r);switch(e.expressionType){case a.expressionTypes.AGGREGATE:if(e.variable){const t=e;return r.createBoundAggregate(t.variable,t.aggregator,n(t.expression),t.distinct,t.separator)}const t=e;return r.createAggregateExpression(t.aggregator,n(t.expression),t.distinct,t.separator);case a.expressionTypes.EXISTENCE:const s=e;return r.createExistenceExpression(s.not,n(s.input));case a.expressionTypes.NAMED:const i=e;return r.createNamedExpression(i.name,i.args.map(n));case a.expressionTypes.OPERATOR:const p=e;return r.createOperatorExpression(p.operator,p.args.map(n));case a.expressionTypes.TERM:const o=e;return r.createTermExpression(o.term);case a.expressionTypes.WILDCARD:return r.createWildcardExpression();default:throw new Error(`Unknown Expression type ${e.expressionType}`)}}static createUniqueVariable(e,t,r){let a=0,n=e;for(;t[n];)n=`${e}${a++}`;return r.variable(n)}static isSimpleTerm(e){return void 0!==e.termType&&"Quad"!==e.termType&&"Wildcard"!==e.termType}static isQuad(e){return"Quad"===e.termType}static isWildcard(e){return"Wildcard"===e.termType}}t.default=s},7632:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(84897),t)},84897:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationCreate=void 0;const a=r(67213);class n extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"create")}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}async runOperation(e,t){const{updateResult:r}=await this.mediatorUpdateQuads.mediate({createGraphs:{graphs:[e.source],requireNonExistence:!e.silent},context:t});return{type:"update",updateResult:r}}}t.ActorQueryOperationCreate=n},96595:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(74024),t)},74024:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationUpdateDeleteInsert=void 0;const a=r(41825),n=r(67213),s=r(55505);class i extends n.ActorQueryOperationTypedMediated{constructor(e){super(e,"deleteinsert"),this.blankNodeCounter=0}async testOperation(e,t){return n.ActorQueryOperation.throwOnReadOnly(t),!0}async runOperation(e,t){const r=e.where?n.ActorQueryOperation.getSafeBindings(await this.mediatorQueryOperation.mediate({operation:e.where,context:t})).bindingsStream:new s.ArrayIterator([n.Bindings({})],{autoStart:!1});let i,p;e.insert&&(i=new a.BindingsToQuadsIterator(e.insert.map(a.BindingsToQuadsIterator.localizeQuad.bind(null,this.blankNodeCounter)),r.clone(),!1),this.blankNodeCounter++),e.delete&&(p=new a.BindingsToQuadsIterator(e.delete.map(a.BindingsToQuadsIterator.localizeQuad.bind(null,this.blankNodeCounter)),r.clone(),!1),this.blankNodeCounter++);const{updateResult:o}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:i,quadStreamDelete:p,context:t});return{type:"update",updateResult:o}}}t.ActorQueryOperationUpdateDeleteInsert=i},287:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(85397),t)},85397:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationDrop=void 0;const a=r(67213),n=new(r(41640).DataFactory);class s extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"drop")}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}async runOperation(e,t){let r;r="DEFAULT"===e.source?n.defaultGraph():"string"==typeof e.source?e.source:[e.source];const{updateResult:a}=await this.mediatorUpdateQuads.mediate({deleteGraphs:{graphs:r,requireExistence:!e.silent,dropGraphs:!0},context:t});return{type:"update",updateResult:a}}}t.ActorQueryOperationDrop=s},55295:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(41888),t)},41888:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CONTEXT_LENIENT=t.KEY_CONTEXT_SOURCES=t.ActorQueryOperationLoad=void 0;const a=r(67213),n=r(41709),s=r(41640),i=r(2599),p=new s.DataFactory;class o extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"load"),this.factory=new i.Factory,this.constructOperation=this.factory.createConstruct(this.factory.createPattern(p.variable("s"),p.variable("p"),p.variable("o")),[this.factory.createPattern(p.variable("s"),p.variable("p"),p.variable("o"))])}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}async runOperation(e,r){r||(r=n.ActionContext({}));let a=r.set(t.KEY_CONTEXT_SOURCES,[e.source.value]);e.silent&&(a=a.set(t.KEY_CONTEXT_LENIENT,!0));let s=o.getSafeQuads(await this.mediatorQueryOperation.mediate({operation:this.constructOperation,context:a})).quadStream;e.destination&&(s=s.map((t=>p.quad(t.subject,t.predicate,t.object,e.destination))));const{updateResult:i}=await this.mediatorUpdateQuads.mediate({quadStreamInsert:s,context:r});return{type:"update",updateResult:i}}}t.ActorQueryOperationLoad=o,t.KEY_CONTEXT_SOURCES="@comunica/bus-rdf-resolve-quad-pattern:sources",t.KEY_CONTEXT_LENIENT="@comunica/actor-init-sparql:lenient"},2599:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.toSparqlJs=t.toSparql=t.Factory=t.Algebra=t.translate=void 0;const a=r(70023);t.translate=a.default;const n=r(2704);t.Algebra=n;const s=r(2657);t.Factory=s.default;const i=r(77655);Object.defineProperty(t,"toSparql",{enumerable:!0,get:function(){return i.toSparql}}),Object.defineProperty(t,"toSparqlJs",{enumerable:!0,get:function(){return i.toSparqlJs}});const p=r(76201);t.Util=p.default},2704:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expressionTypes=t.types=void 0,t.types={ALT:"alt",ASK:"ask",BGP:"bgp",CONSTRUCT:"construct",DESC:"desc",DESCRIBE:"describe",DISTINCT:"distinct",EXPRESSION:"expression",EXTEND:"extend",FILTER:"filter",FROM:"from",GRAPH:"graph",GROUP:"group",INV:"inv",JOIN:"join",LEFT_JOIN:"leftjoin",LINK:"link",MINUS:"minus",NOP:"nop",NPS:"nps",ONE_OR_MORE_PATH:"OneOrMorePath",ORDER_BY:"orderby",PATH:"path",PATTERN:"pattern",PROJECT:"project",REDUCED:"reduced",SEQ:"seq",SERVICE:"service",SLICE:"slice",UNION:"union",VALUES:"values",ZERO_OR_MORE_PATH:"ZeroOrMorePath",ZERO_OR_ONE_PATH:"ZeroOrOnePath",COMPOSITE_UPDATE:"compositeupdate",DELETE_INSERT:"deleteinsert",LOAD:"load",CLEAR:"clear",CREATE:"create",DROP:"drop",ADD:"add",MOVE:"move",COPY:"copy"},t.expressionTypes={AGGREGATE:"aggregate",EXISTENCE:"existence",NAMED:"named",OPERATOR:"operator",TERM:"term",WILDCARD:"wildcard"}},2657:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(2704),n=r(41640),s=r(22086),i=r(9619);t.default=class{constructor(e){this.dataFactory=e||new n.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(e,t){return{type:a.types.ALT,left:e,right:t}}createAsk(e){return{type:a.types.ASK,input:e}}createBoundAggregate(e,t,r,a,n){let s=this.createAggregateExpression(t,r,a,n);return s.variable=e,s}createBgp(e){return{type:a.types.BGP,patterns:e}}createConstruct(e,t){return{type:a.types.CONSTRUCT,input:e,template:t}}createDescribe(e,t){return{type:a.types.DESCRIBE,input:e,terms:t}}createDistinct(e){return{type:a.types.DISTINCT,input:e}}createExtend(e,t,r){return{type:a.types.EXTEND,input:e,variable:t,expression:r}}createFrom(e,t,r){return{type:a.types.FROM,input:e,default:t,named:r}}createFilter(e,t){return{type:a.types.FILTER,input:e,expression:t}}createGraph(e,t){return{type:a.types.GRAPH,input:e,name:t}}createGroup(e,t,r){return{type:a.types.GROUP,input:e,variables:t,aggregates:r}}createInv(e){return{type:a.types.INV,path:e}}createJoin(e,t){return{type:a.types.JOIN,left:e,right:t}}createLeftJoin(e,t,r){return r?{type:a.types.LEFT_JOIN,left:e,right:t,expression:r}:{type:a.types.LEFT_JOIN,left:e,right:t}}createLink(e){return{type:a.types.LINK,iri:e}}createMinus(e,t){return{type:a.types.MINUS,left:e,right:t}}createNop(){return{type:a.types.NOP}}createNps(e){return{type:a.types.NPS,iris:e}}createOneOrMorePath(e){return{type:a.types.ONE_OR_MORE_PATH,path:e}}createOrderBy(e,t){return{type:a.types.ORDER_BY,input:e,expressions:t}}createPath(e,t,r,n){return n?{type:a.types.PATH,subject:e,predicate:t,object:r,graph:n}:{type:a.types.PATH,subject:e,predicate:t,object:r,graph:this.dataFactory.defaultGraph()}}createPattern(e,t,r,n){let s=this.dataFactory.quad(e,t,r,n);return s.type=a.types.PATTERN,s}createProject(e,t){return{type:a.types.PROJECT,input:e,variables:t}}createReduced(e){return{type:a.types.REDUCED,input:e}}createSeq(e,t){return{type:a.types.SEQ,left:e,right:t}}createService(e,t,r){return{type:a.types.SERVICE,input:e,name:t,silent:r}}createSlice(e,t,r){return t=t||0,void 0!==r?{type:a.types.SLICE,input:e,start:t,length:r}:{type:a.types.SLICE,input:e,start:t}}createUnion(e,t){return{type:a.types.UNION,left:e,right:t}}createValues(e,t){return{type:a.types.VALUES,variables:e,bindings:t}}createZeroOrMorePath(e){return{type:a.types.ZERO_OR_MORE_PATH,path:e}}createZeroOrOnePath(e){return{type:a.types.ZERO_OR_ONE_PATH,path:e}}createAggregateExpression(e,t,r,n){return n?{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,separator:n,distinct:r}:{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,distinct:r}}createExistenceExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.EXISTENCE,not:e,input:t}}createNamedExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.NAMED,name:e,args:t}}createOperatorExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.OPERATOR,operator:e,args:t}}createTermExpression(e){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.TERM,term:e}}createWildcardExpression(){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.WILDCARD,wildcard:new i.Wildcard}}createTerm(e){return s.stringToTerm(e,this.dataFactory)}createCompositeUpdate(e){return{type:a.types.COMPOSITE_UPDATE,updates:e}}createDeleteInsert(e,t,r){const n={type:a.types.DELETE_INSERT};return e&&(n.delete=e),t&&(n.insert=t),r&&(n.where=r),n}createLoad(e,t,r){const n={type:a.types.LOAD,source:e};return t&&(n.destination=t),this.addSilent(n,r)}createClear(e,t){return this.addSilent({type:a.types.CLEAR,source:e},t)}createCreate(e,t){return this.addSilent({type:a.types.CREATE,source:e},t)}createDrop(e,t){return this.addSilent({type:a.types.DROP,source:e},t)}createAdd(e,t,r){return this.addSilent({type:a.types.ADD,source:e,destination:t},r)}createMove(e,t,r){return this.addSilent({type:a.types.MOVE,source:e,destination:t},r)}createCopy(e,t,r){return this.addSilent({type:a.types.COPY,source:e,destination:t},r)}addSilent(e,t){return t&&(e.silent=t),e}}},77655:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSparqlJs=t.toSparql=void 0;const a=r(76065),n=r(22086),s=r(9619),i=r(2704),p=r(2657),o=r(76201),c=i.types,u=i.expressionTypes;let l;const d=new p.default;function y(e){f();let t=h(e=function(e){return A(e,{})}(e));return"group"===t.type?t.patterns[0]:t}function f(){l={project:!1,extend:[],group:[],aggregates:[],order:[]}}function h(e){switch(e.type!==c.EXTEND&&e.type!==c.ORDER_BY&&e.type!==c.GRAPH&&(l.project=!1),e.type){case c.EXPRESSION:return m(e);case c.ASK:return R(e,c.ASK);case c.BGP:return function(e){let t=e.patterns.map(T);return 0===t.length?null:{type:"bgp",triples:t}}(e);case c.CONSTRUCT:return function(e){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:e.template.map(T),where:o.default.flatten([h(e.input)])}}(e);case c.DESCRIBE:return R(e,c.DESCRIBE);case c.DISTINCT:return function(e){let t=h(e.input);return t.patterns[0].distinct=!0,t}(e);case c.EXTEND:return function(e){return l.project?(l.extend.push(e),h(e.input)):o.default.flatten([h(e.input),{type:"bind",variable:e.variable,expression:m(e.expression)}])}(e);case c.FROM:return function(e){const t=h(e.input);return t.patterns[0].from={default:e.default,named:e.named},t}(e);case c.FILTER:return function(e){return{type:"group",patterns:o.default.flatten([h(e.input),{type:"filter",expression:m(e.expression)}])}}(e);case c.GRAPH:return function(e){return{type:"graph",patterns:o.default.flatten([h(e.input)]),name:e.name}}(e);case c.GROUP:return function(e){const t=h(e.input),r=e.aggregates.map(b);return l.aggregates.push(...r),l.group.push(...e.variables),t}(e);case c.JOIN:return function(e){return o.default.flatten([h(e.left),h(e.right)]).reduce(((e,t)=>("bgp"!==t.type||0==e.length||"bgp"!==e[e.length-1].type?e.push(t):e[e.length-1].triples.push(...t.triples),e)),[])}(e);case c.LEFT_JOIN:return function(e){const t={type:"optional",patterns:[h(e.right)]};return e.expression&&t.patterns.push({type:"filter",expression:m(e.expression)}),t.patterns=o.default.flatten(t.patterns),o.default.flatten([h(e.left),t])}(e);case c.MINUS:return function(e){let t=h(e.right);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),o.default.flatten([h(e.left),{type:"minus",patterns:t}])}(e);case c.NOP:return{};case c.ORDER_BY:return function(e){return l.order.push(...e.expressions),h(e.input)}(e);case c.PATH:return function(e){return{type:"bgp",triples:[{subject:e.subject,predicate:g(e.predicate),object:e.object}]}}(e);case c.PATTERN:return T(e);case c.PROJECT:return R(e,c.PROJECT);case c.REDUCED:return function(e){let t=h(e.input);return t.patterns[0].reduced=!0,t}(e);case c.SERVICE:return function(e){let t=h(e.input);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),{type:"service",name:e.name,silent:e.silent,patterns:t}}(e);case c.SLICE:return function(e){let t=h(e.input),r=t;return t.type&&"group"===t.type&&(r=t.patterns[0]),0!==e.start&&(r.offset=e.start),void 0!==e.length&&(r.limit=e.length),t}(e);case c.UNION:return function(e){return{type:"union",patterns:o.default.flatten([h(e.left),h(e.right)])}}(e);case c.VALUES:return function(e){return{type:"values",values:e.bindings.map((t=>{let r={};for(let a of e.variables){let e=`?${a.value}`;t[e]?r[e]=t[e]:r[e]=void 0}return r}))}}(e);case c.COMPOSITE_UPDATE:return function(e){return{prefixes:{},type:"update",updates:e.updates.map((e=>h(e).updates[0]))}}(e);case c.DELETE_INSERT:return function(e){let t,r=e.where;if(r&&r.type===c.FROM){let a=e.where;r=a.input,t={default:a.default,named:a.named}}const n=[{updateType:"insertdelete",delete:P(e.delete),insert:P(e.insert)}];if(t&&(n[0].using=t),!r||r.type===c.BGP&&0===r.patterns.length)n[0].where=[];else{const e={};let t=h(A(r,e));"group"===t.type?n[0].where=t.patterns:n[0].where=[t];const a=Object.keys(e);if(a.length>0){if(1!==a.length)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");""!==e[a[0]].graph.value&&(n[0].where=[{type:"graph",patterns:n[0].where,name:e[a[0]].graph}])}}return e.delete||e.where?e.insert||e.where?!e.insert&&e.where&&"bgp"===e.where.type&&a.isomorphic(e.delete,e.where.patterns)&&(delete n[0].where,n[0].updateType="deletewhere"):(delete n[0].insert,delete n[0].where,e.delete.some((e=>"Variable"===e.subject.termType||"Variable"===e.predicate.termType||"Variable"===e.object.termType))?n[0].updateType="deletewhere":n[0].updateType="delete"):(n[0].updateType="insert",delete n[0].delete,delete n[0].where),{prefixes:{},type:"update",updates:n}}(e);case c.LOAD:return function(e){const t=[{type:"load",silent:Boolean(e.silent),source:e.source}];return e.destination&&(t[0].destination=e.destination),{prefixes:{},type:"update",updates:t}}(e);case c.CLEAR:return function(e){return v(e,"clear")}(e);case c.CREATE:return function(e){return v(e,"create")}(e);case c.DROP:return function(e){return v(e,"drop")}(e);case c.ADD:return function(e){return w(e,"add")}(e);case c.MOVE:return function(e){return w(e,"move")}(e);case c.COPY:return function(e){return w(e,"copy")}(e)}throw new Error(`Unknown Operation type ${e.type}`)}function m(e){switch(e.expressionType){case u.AGGREGATE:return function(e){const t={expression:m(e.expression),type:"aggregate",aggregation:e.aggregator,distinct:e.distinct};return e.separator&&(t.separator=e.separator),t}(e);case u.EXISTENCE:return function(e){return{type:"operation",operator:e.not?"notexists":"exists",args:o.default.flatten([h(e.input)])}}(e);case u.NAMED:return function(e){return{type:"functionCall",function:e.name,args:e.args.map(m)}}(e);case u.OPERATOR:return function(e){if("desc"===e.operator){return{expression:m(e.args[0]),descending:!0}}const t={type:"operation",operator:e.operator,args:e.args.map(m)};return"in"!==t.operator&&"notin"!==t.operator||(t.args=[t.args[0]].concat([t.args.slice(1)])),t}(e);case u.TERM:return function(e){return e.term}(e);case u.WILDCARD:return function(e){return e.wildcard}(e)}throw new Error(`Unknown Expression Operation type ${e.expressionType}`)}function g(e){switch(e.type){case c.ALT:return function(e){const t=g(e.left),r=g(e.right);return"pathType"in t&&"!"===t.pathType&&"pathType"in r&&"!"===r.pathType?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:[].concat(t.items,r.items)}]}:{type:"path",pathType:"|",items:[t,r]}}(e);case c.INV:return function(e){if(e.path.type===c.NPS){const t=e.path.iris.map((e=>({type:"path",pathType:"^",items:[e]})));return t.length<=1?{type:"path",pathType:"!",items:t}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:t}]}}return{type:"path",pathType:"^",items:[g(e.path)]}}(e);case c.LINK:return function(e){return e.iri}(e);case c.NPS:return function(e){return e.iris.length<=1?{type:"path",pathType:"!",items:e.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:e.iris}]}}(e);case c.ONE_OR_MORE_PATH:return function(e){return{type:"path",pathType:"+",items:[g(e.path)]}}(e);case c.SEQ:return function(e){return{type:"path",pathType:"/",items:[g(e.left),g(e.right)]}}(e);case c.ZERO_OR_MORE_PATH:return function(e){return{type:"path",pathType:"*",items:[g(e.path)]}}(e);case c.ZERO_OR_ONE_PATH:return function(e){return{type:"path",pathType:"?",items:[g(e.path)]}}(e)}throw new Error(`Unknown Path type ${e.type}`)}function E(e){return n.termToString(e)}function b(e){return e}function T(e){return{subject:e.subject,predicate:e.predicate,object:e.object}}function O(e,t){let r=o.default.isSimpleTerm(e)?E(e):e;if("string"==typeof r){if(t[r])return t[r]}else if(Array.isArray(e))e=e.map((e=>O(e,t)));else for(let r of Object.keys(e))e[r]=O(e[r],t);return e}function R(e,t){const r={type:"query",prefixes:{}},a=r;let n;t===c.PROJECT?(r.queryType="SELECT",n=e.variables):t===c.ASK?r.queryType="ASK":t===c.DESCRIBE&&(r.queryType="DESCRIBE",n=e.terms);const i=l.extend,p=l.group,u=l.aggregates,d=l.order;f(),l.project=!0;let y=o.default.flatten([h(e.input)]);1===y.length&&"group"===y[0].type&&(y=y[0].patterns),r.where=y;let g={};for(let e of l.aggregates)g[E(e.variable)]=m(e);let b={};for(let e=l.extend.length-1;e>=0;--e){let t=l.extend[e];b[E(t.variable)]=O(m(t.expression),g)}if(l.group.length>0&&(a.group=l.group.map((e=>{let t=E(e);if(b[t]){let r=b[t];return delete b[t],{variable:e,expression:r}}return{expression:e}}))),l.order.length>0&&(a.order=l.order.map(h).map((e=>e.descending?e:{expression:e}))),n&&(a.variables=n.map((e=>{let t=E(e);return b[t]?{variable:e,expression:b[t]}:e})),0===a.variables.length&&(a.variables=[new s.Wildcard])),r.where.length>0&&"filter"===r.where[r.where.length-1].type){const e=r.where[r.where.length-1];S(e,Object.keys(g))&&(a.having=o.default.flatten([O(e.expression,g)]),r.where.splice(-1))}return l.extend=i,l.group=p,l.aggregates=u,l.order=d,{type:"group",patterns:[a]}}function S(e,t){return o.default.isSimpleTerm(e)?t.indexOf(E(e))>=0:Array.isArray(e)?e.some((e=>S(e,t))):e===Object(e)?Object.keys(e).some((r=>S(e[r],t))):t.indexOf(e)>=0}function v(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return"DEFAULT"===e.source?r[0].graph={default:!0}:"NAMED"===e.source?r[0].graph={named:!0}:"ALL"===e.source?r[0].graph={all:!0}:r[0].graph={type:"graph",name:e.source},{prefixes:{},type:"update",updates:r}}function w(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return r[0].source="DEFAULT"===e.source?{type:"graph",default:!0}:{type:"graph",name:e.source},r[0].destination="DEFAULT"===e.destination?{type:"graph",default:!0}:{type:"graph",name:e.destination},{prefixes:{},type:"update",updates:r}}function P(e){if(!e)return[];const t={};return e.forEach((e=>{const r=e.graph.value;t[r]||(t[r]=[]),t[r].push(e)})),Object.keys(t).map((e=>""===e?{type:"bgp",triples:t[e].map(T)}:{type:"graph",triples:t[e].map(T),name:t[e][0].graph}))}function A(e,t){if(Array.isArray(e))return e.map((e=>A(e,t)));if(!e.type)return e;if(e.type===c.DELETE_INSERT)return e;if((e.type===c.PATTERN||e.type===c.PATH)&&e.graph)return t[e.graph.value]||(t[e.graph.value]={graph:e.graph,values:[]}),t[e.graph.value].values.push(e),e;const r={},a={},n={};for(let t of Object.keys(e)){const s={};r[t]=A(e[t],s);const i=Object.keys(s);if(i.length>1){let e=x(s[i[0]].values);for(let t=1;t<i.length;++t){const r=x(s[i[t]].values);e=d.createJoin(e,r)}return i.map((e=>delete s[e])),e}if(1===i.length){const e=s[i[0]].graph;a[t]=e,n[e.value]=e}}const s=Object.keys(n);if(s.length>0)if(1===s.length&&e.type!==c.PROJECT)t[s[0]]={graph:n[s[0]],values:[r]};else for(let e of Object.keys(a))a[e].value.length>0&&(r[e]=d.createGraph(r[e],a[e]));return r}function x(e){const t=d.createBgp(e),r=e[0].graph;return 0===r.value.length?t:d.createGraph(t,r)}t.toSparql=function(e,t={}){return new s.Generator(t).stringify(y(e))},t.toSparqlJs=y},70023:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(64063),n=r(22086),s=r(2704),i=r(2657),p=r(76201),o=r(9619).Parser,c=s.types;let u,l=new Set,d=0,y=!1;function f(e,t,r){if(l=new Set,d=0,y=t,!e.type)return u.createNop();if("query"!==e.type&&"update"!==e.type)throw new Error("Translate only works on complete query or update objects.");const a=new Set(Object.keys(m(e)).map(u.createTerm.bind(u)));let n;var s;return"query"===e.type?(n=g({type:"group",patterns:e.where||[]}),n=function(e,t,r){const a=e,n=[],s={};if(a.variables=a.variables&&a.variables.map((e=>x(e,s))),a.having=a.having&&a.having.map((e=>x(e,s))),a.order=a.order&&a.order.map((e=>x(e,s))),a.group||Object.keys(s).length>0){const e=Object.keys(s).map((e=>function(e,t){if("aggregate"!==e.type||!e.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(e)}`);const r=E(e);return r.variable=t,r}(s[e],u.createTerm(e)))),r=[];if(a.group)for(const e of a.group)if(p.default.isSimpleTerm(e.expression))r.push(e.expression);else{const a="variable"in e?e.variable:O();t=u.createExtend(t,a,E(e.expression)),r.push(a)}t=u.createGroup(t,r,e)}if(a.having)for(let e of a.having)t=u.createFilter(t,E(e));e.values&&(t=u.createJoin(t,A(e)));let i=new Set;if("SELECT"===e.queryType||"DESCRIBE"===e.queryType)if(e.variables.some((e=>e&&p.default.isWildcard(e))))i=r;else for(let t of e.variables)h(t)||!("variable"in t)?i.add(t):t.variable&&(i.add(t.variable),n.push(t));for(let e of n)t=u.createExtend(t,e.variable,E(e.expression));return a.order&&(t=u.createOrderBy(t,a.order.map((e=>{let t=E(e.expression);return e.descending&&(t=u.createOperatorExpression(c.DESC,[t])),t})))),"SELECT"===e.queryType&&(t=u.createProject(t,Array.from(i))),a.distinct&&(t=u.createDistinct(t)),a.reduced&&(t=u.createReduced(t)),"CONSTRUCT"===e.queryType?t=u.createConstruct(t,e.template.map(R)):"ASK"===e.queryType?t=u.createAsk(t):"DESCRIBE"===e.queryType&&(t=u.createDescribe(t,Array.from(i))),(a.offset||a.limit)&&(t=u.createSlice(t,a.offset,a.limit)),a.from&&(t=u.createFrom(t,a.from.default,a.from.named)),t}(e,n,a)):"update"===e.type&&(n=1===(s=e).updates.length?j(s.updates[0]):u.createCompositeUpdate(s.updates.map(j))),r&&(n=_(n,a)),n}function h(e){return"Variable"===(null==e?void 0:e.termType)}function m(e){let t={};if(h(e))t[n.termToString(e)]=!0,l.add(e.value);else if(null!==(r=e)&&"object"==typeof r)if("bind"===e.type)m(e.expression),Object.assign(t,m(e.variable));else if("SELECT"===e.queryType){let r=m(e.where);for(let a of e.variables)p.default.isWildcard(a)?Object.assign(t,r):a.variable?Object.assign(t,m(a.variable)):Object.assign(t,m(a));if(e.group)for(let r of e.group)Object.assign(t,m(r))}else for(let r of Object.keys(e))Object.assign(t,m(e[r]));var r;return t}function g(e){let t,r=[],a=[];if("patterns"in e)for(let t of e.patterns)("filter"===t.type?r:a).push(t);if("bgp"===e.type)return function(e){let t=[],r=[];for(let n of e.triples)if("pathType"in n.predicate){let e=T((a=n).subject,b(a.predicate),a.object);for(let a of e)a.type===c.PATH?(t.length>0&&r.push(u.createBgp(t)),t=[],r.push(a)):t.push(a)}else t.push(R(n));var a;return t.length>0&&r.push(u.createBgp(t)),1===r.length?r[0]:r.reduce(((e,t)=>u.createJoin(e,t)))}(e);if("union"===e.type)t=a.map((e=>("group"!==e.type&&(e={type:"group",patterns:[e]}),g(e)))).reduce(((e,t)=>u.createUnion(e,t)));else{if("graph"===e.type)return function(e){let t=g({type:"group",patterns:e.patterns});return t=y?v(t,e.name):u.createGraph(t,e.name),t}(e);if("group"===e.type)t=a.reduce(w,u.createBgp([]));else if("values"===e.type)t=A(e);else{if("query"!==e.type)throw new Error(`Unexpected type: ${e.type}`);t=f(e,y,!1)}}if(r.length>0){let e=r.map((e=>E(e.expression)));e.length>0&&(t=u.createFilter(t,e.reduce(((e,t)=>u.createOperatorExpression("&&",[e,t])))))}return t}function E(e){if(p.default.isSimpleTerm(e)||p.default.isQuad(e))return u.createTermExpression(e);if(p.default.isWildcard(e))return u.createWildcardExpression();if("aggregation"in e)return u.createAggregateExpression(e.aggregation,E(e.expression),e.distinct,e.separator);if("function"in e)return u.createNamedExpression(e.function,e.args.map(E));if("operator"in e)return"exists"===e.operator||"notexists"===e.operator?u.createExistenceExpression("notexists"===e.operator,g(e.args[0])):("in"!==e.operator&&"notin"!==e.operator||(e.args=[e.args[0]].concat(e.args[1])),u.createOperatorExpression(e.operator,e.args.map(E)));throw new Error(`Unknown expression: ${JSON.stringify(e)}`)}function b(e){if(p.default.isSimpleTerm(e)){if("NamedNode"===e.termType)return u.createLink(e);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(e)}`)}if("^"===e.pathType)return u.createInv(b(e.items[0]));if("!"===e.pathType){let t,r=[],a=[];t="pathType"in e.items[0]&&"|"===e.items[0].pathType?e.items[0].items:e.items;for(let e of t)if(p.default.isSimpleTerm(e))r.push(e);else{if("^"!==e.pathType)throw new Error(`Unexpected item: ${JSON.stringify(e)}`);a.push(e.items[0])}let n=u.createNps(r),s=u.createInv(u.createNps(a));return 0===a.length?n:0===r.length?s:u.createAlt(n,s)}if("/"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createSeq(e,t)));if("|"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createAlt(e,t)));if("*"===e.pathType)return u.createZeroOrMorePath(b(e.items[0]));if("+"===e.pathType)return u.createOneOrMorePath(b(e.items[0]));if("?"===e.pathType)return u.createZeroOrOnePath(b(e.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(e)}`)}function T(e,t,r){if(t.type===c.LINK)return[u.createPattern(e,t.iri,r)];if(t.type===c.INV)return T(r,t.path,e);if(t.type===c.SEQ){let a=O(),n=T(e,t.left,a),s=T(a,t.right,r);return n.concat(s)}return[u.createPath(e,t,r)]}function O(){let e="?var"+d++;return l.has(e)?O():(l.add(e),u.createTerm(e))}function R(e){return u.createPattern(e.subject,e.predicate,e.object,e.graph)}t.default=function(e,t){let r;if(t=t||{},u=new i.default(t.dataFactory),"string"==typeof e){let a=new o(t);a._resetBlanks(),r=a.parse(e)}else r=e;return f(r,t.quads,t.blankToVariable)};let S=Object.values(c);function v(e,t,r){if(e.type===c.GRAPH){if(r)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");const t=e;e=v(t.input,t.name)}else if(e.type===c.BGP)e.patterns=e.patterns.map((e=>(r&&(e.subject.equals(t)&&(e.subject=r),e.predicate.equals(t)&&(e.predicate=r),e.object.equals(t)&&(e.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t),e)));else if(e.type===c.PATH){const a=e;r&&(a.subject.equals(t)&&(a.subject=r),a.object.equals(t)&&(a.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t)}else if(e.type!==c.PROJECT||r)if(e.type!==c.EXTEND||r)for(let a of Object.keys(e))Array.isArray(e[a])?e[a]=e[a].map((e=>v(e,t,r))):S.indexOf(e[a].type)>=0?e[a]=v(e[a],t,r):r&&h(e[a])&&e[a].equals(t)&&(e[a]=r);else{const a=e;a.variable.equals(t)&&(r=O()),a.input=v(a.input,t,r)}else{const a=e;a.variables.some((e=>e.equals(t)))||(r=O()),a.input=v(a.input,t,r)}return e}function w(e,t){if("optional"===t.type){const r=g({type:"group",patterns:t.patterns});if(r.type===c.FILTER){const t=r;e=u.createLeftJoin(e,t.input,t.expression)}else e=u.createLeftJoin(e,r)}else if("minus"===t.type){const r=g({type:"group",patterns:t.patterns});e=u.createMinus(e,r)}else if("bind"===t.type)e=u.createExtend(e,t.variable,E(t.expression));else if("service"===t.type){const r={type:"group",patterns:t.patterns};e=P(e,u.createService(g(r),t.name,t.silent))}else e=P(e,g(t));return e}function P(e,t){return e.type===c.BGP&&t.type===c.BGP?e=u.createBgp([].concat(e.patterns,t.patterns)):e.type===c.BGP&&0===e.patterns.length?e=t:t.type===c.BGP&&0===t.patterns.length||(e=u.createJoin(e,t)),e}function A(e){let t=(0===e.values.length?[]:Object.keys(e.values[0])).map(u.createTerm.bind(u)),r=e.values.map((e=>{let t=Object.keys(e);t=t.filter((t=>void 0!==e[t]));let r={};for(let a of t)r[a]=e[a];return r}));return u.createValues(t,r)}function x(e,t){if("type"in e&&"aggregate"===e.type){let r,s=!1;for(let n of Object.keys(t))if(a(t[n],e)){r=u.createTerm(n),s=!0;break}return s||(r=O(),t[n.termToString(r)]=e),r}return"expression"in e&&e.expression?Object.assign(Object.assign({},e),{expression:x(e.expression,t)}):"args"in e&&e.args?Object.assign(Object.assign({},e),{args:e.args.map((e=>x(e,t)))}):e}function j(e){if("type"in e){if("load"===e.type)return function(e){return u.createLoad(e.source,e.destination,e.silent)}(e);if("clear"===e.type||"create"===e.type||"drop"===e.type)return function(e){let t;switch(t=p.default.isSimpleTerm(e.graph)?e.graph:e.graph.all?"ALL":e.graph.default?"DEFAULT":e.graph.named?"NAMED":e.graph.name,e.type){case"clear":return u.createClear(t,e.silent);case"create":return u.createCreate(t,e.silent);case"drop":return u.createDrop(t,e.silent)}}(e);if("add"===e.type||"copy"===e.type||"move"===e.type)return function(e){const t=e.source.default?"DEFAULT":e.source.name,r=e.destination.default?"DEFAULT":e.destination.name;switch(e.type){case"copy":return u.createCopy(t,r,e.silent);case"move":return u.createMove(t,r,e.silent);case"add":return u.createAdd(t,r,e.silent)}}(e)}else if("insertdelete"===e.updateType||"deletewhere"===e.updateType||"delete"===e.updateType||"insert"===e.updateType)return function(e){if(!y)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let t,r=[],a=[];if(e.delete&&(r=p.default.flatten(e.delete.map((t=>N(t,e.graph))))),e.insert&&(a=p.default.flatten(e.insert.map((t=>N(t,e.graph))))),e.where&&e.where.length>0){t=g({type:"group",patterns:e.where});const r=e.using;r?t=u.createFrom(t,r.default,r.named):e.graph&&(t=v(t,e.graph))}else"deletewhere"===e.updateType&&r.length>0&&(t=u.createBgp(r));return u.createDeleteInsert(r.length>0?r:void 0,a.length>0?a:void 0,t)}(e);throw new Error(`Unknown update type ${JSON.stringify(e)}`)}function N(e,t){let r=t;"graph"===e.type&&(r=e.name);let a=e.triples;return r&&(a=a.map((e=>Object.assign(e,{graph:r})))),a.map(R)}function _(e,t){const r={},a=Array.from(t).reduce(((e,t)=>(e[t.value]=!0,e)),{});return p.default.mapOperation(e,{[s.types.DELETE_INSERT]:e=>({result:e,recurse:!1}),[s.types.PATH]:(e,t)=>({result:t.createPath(n(e.subject),e.predicate,n(e.object),n(e.graph)),recurse:!1}),[s.types.PATTERN]:(e,t)=>({result:t.createPattern(n(e.subject),n(e.predicate),n(e.object),n(e.graph)),recurse:!1}),[s.types.CONSTRUCT]:e=>({result:u.createConstruct(_(e.input,t),e.template),recurse:!1})});function n(e){if("BlankNode"===e.termType){let t=r[e.value];return t||(t=p.default.createUniqueVariable(e.value,a,u.dataFactory),a[t.value]=!0,r[e.value]=t),t}return e}}},76201:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(2704),n=r(2657);class s{static flatten(e){return Array.prototype.concat(...e).filter((e=>e))}static objectify(e){if(e.termType){if("Quad"===e.termType)return{type:"pattern",termType:"Quad",subject:s.objectify(e.subject),predicate:s.objectify(e.predicate),object:s.objectify(e.object),graph:s.objectify(e.graph)};{let t={termType:e.termType,value:e.value};return e.language&&(t.language=e.language),e.datatype&&(t.datatype=s.objectify(e.datatype)),t}}if(Array.isArray(e))return e.map((e=>s.objectify(e)));if(e===Object(e)){let t={};for(let r of Object.keys(e))t[r]=s.objectify(e[r]);return t}return e}static inScopeVariables(e){const t=[];function r(e){t.find((t=>e.value===t.value))||t.push(e)}function n(e){"Variable"===e.subject.termType&&r(e.subject),"Variable"===e.predicate.termType&&r(e.predicate),"Variable"===e.object.termType&&r(e.object),"Variable"===e.graph.termType&&r(e.graph),"Quad"===e.subject.termType&&n(e.subject),"Quad"===e.predicate.termType&&n(e.predicate),"Quad"===e.object.termType&&n(e.object),"Quad"===e.graph.termType&&n(e.graph)}return s.recurseOperation(e,{[a.types.EXPRESSION]:e=>{let t=e;return t.expressionType===a.expressionTypes.AGGREGATE&&t.variable&&r(t.variable),!0},[a.types.EXTEND]:e=>(r(e.variable),!0),[a.types.GRAPH]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.GROUP]:e=>(e.variables.forEach(r),!0),[a.types.PATH]:e=>{let t=e;return"Variable"===t.subject.termType&&r(t.subject),"Variable"===t.object.termType&&r(t.object),"Variable"===t.graph.termType&&r(t.graph),"Quad"===t.subject.termType&&n(t.subject),"Quad"===t.object.termType&&n(t.object),"Quad"===t.graph.termType&&n(t.graph),!0},[a.types.PATTERN]:e=>(n(e),!0),[a.types.PROJECT]:e=>(e.variables.forEach(r),!1),[a.types.SERVICE]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.VALUES]:e=>(e.variables.forEach(r),!0)}),t}static recurseOperation(e,t){let r=e,n=!0;if(t[e.type]&&(n=t[e.type](e)),!n)return;let i=e=>s.recurseOperation(e,t);switch(r.type){case a.types.ALT:const e=r;i(e.left),i(e.right);break;case a.types.ASK:i(r.input);break;case a.types.BGP:r.patterns.forEach(i);break;case a.types.CONSTRUCT:const t=r;i(t.input),t.template.map(i);break;case a.types.DESCRIBE:case a.types.DISTINCT:i(r.input);break;case a.types.EXPRESSION:const n=r;n.expressionType===a.expressionTypes.EXISTENCE&&i(n.input);break;case a.types.EXTEND:const s=r;i(s.input),i(s.expression);break;case a.types.FILTER:const p=r;i(p.input),i(p.expression);break;case a.types.FROM:case a.types.GRAPH:i(r.input);break;case a.types.GROUP:const o=r;i(o.input),o.aggregates.forEach(i);break;case a.types.INV:i(r.path);break;case a.types.JOIN:const c=r;i(c.left),i(c.right);break;case a.types.LEFT_JOIN:const u=r;i(u.left),i(u.right),u.expression&&i(u.expression);break;case a.types.LINK:break;case a.types.MINUS:const l=r;i(l.left),i(l.right);break;case a.types.NOP:case a.types.NPS:break;case a.types.ONE_OR_MORE_PATH:i(r.path);break;case a.types.ORDER_BY:const d=r;i(d.input),d.expressions.forEach(i);break;case a.types.PATH:i(r.predicate);break;case a.types.PATTERN:break;case a.types.PROJECT:case a.types.REDUCED:i(r.input);break;case a.types.SEQ:const y=r;i(y.left),i(y.right);break;case a.types.SERVICE:case a.types.SLICE:i(r.input);break;case a.types.UNION:const f=r;i(f.left),i(f.right);break;case a.types.VALUES:break;case a.types.ZERO_OR_MORE_PATH:case a.types.ZERO_OR_ONE_PATH:i(r.path);break;case a.types.COMPOSITE_UPDATE:r.updates.forEach((e=>i(e)));break;case a.types.DELETE_INSERT:const h=r;h.delete&&h.delete.forEach((e=>i(e))),h.insert&&h.insert.forEach((e=>i(e))),h.where&&i(h.where);break;case a.types.LOAD:case a.types.CLEAR:case a.types.CREATE:case a.types.DROP:case a.types.ADD:case a.types.MOVE:case a.types.COPY:break;default:throw new Error(`Unknown Operation type ${r.type}`)}}static mapOperation(e,t,r){let i=e,p=!0;if(r=r||new n.default,t[e.type]&&({result:i,recurse:p}=t[e.type](e,r)),!p)return i;let o=e=>s.mapOperation(e,t,r);switch(i.type){case a.types.ALT:const e=i;return r.createAlt(o(e.left),o(e.right));case a.types.ASK:const n=i;return r.createAsk(o(n.input));case a.types.BGP:const p=i;return r.createBgp(p.patterns.map(o));case a.types.CONSTRUCT:const c=i;return r.createConstruct(o(c.input),c.template.map(o));case a.types.DESCRIBE:const u=i;return r.createDescribe(o(u.input),u.terms);case a.types.DISTINCT:const l=i;return r.createDistinct(o(l.input));case a.types.EXPRESSION:const d=i;return s.mapExpression(d,t,r);case a.types.EXTEND:const y=i;return r.createExtend(o(y.input),y.variable,o(y.expression));case a.types.FILTER:const f=i;return r.createFilter(o(f.input),o(f.expression));case a.types.FROM:const h=i;return r.createFrom(o(h.input),[].concat(h.default),[].concat(h.named));case a.types.GRAPH:const m=i;return r.createGraph(o(m.input),m.name);case a.types.GROUP:const g=i;return r.createGroup(o(g.input),[].concat(g.variables),g.aggregates.map(o));case a.types.INV:const E=i;return r.createInv(o(E.path));case a.types.JOIN:const b=i;return r.createJoin(o(b.left),o(b.right));case a.types.LEFT_JOIN:const T=i;return r.createLeftJoin(o(T.left),o(T.right),T.expression?o(T.expression):void 0);case a.types.LINK:const O=i;return r.createLink(O.iri);case a.types.MINUS:const R=i;return r.createMinus(o(R.left),o(R.right));case a.types.NOP:return r.createNop();case a.types.NPS:const S=i;return r.createNps([].concat(S.iris));case a.types.ONE_OR_MORE_PATH:const v=i;return r.createOneOrMorePath(o(v.path));case a.types.ORDER_BY:const w=i;return r.createOrderBy(o(w.input),w.expressions.map(o));case a.types.PATH:const P=i;return r.createPath(P.subject,o(P.predicate),P.object,P.graph);case a.types.PATTERN:const A=i;return r.createPattern(A.subject,A.predicate,A.object,A.graph);case a.types.PROJECT:const x=i;return r.createProject(o(x.input),[].concat(x.variables));case a.types.REDUCED:const j=i;return r.createReduced(o(j.input));case a.types.SEQ:const N=i;return r.createSeq(o(N.left),o(N.right));case a.types.SERVICE:const _=i;return r.createService(o(_.input),_.name,_.silent);case a.types.SLICE:const I=i;return r.createSlice(o(I.input),I.start,I.length);case a.types.UNION:const C=i;return r.createUnion(o(C.left),o(C.right));case a.types.VALUES:const D=i;return r.createValues([].concat(D.variables),D.bindings.map((e=>Object.assign({},e))));case a.types.ZERO_OR_MORE_PATH:const q=i;return r.createZeroOrMorePath(o(q.path));case a.types.ZERO_OR_ONE_PATH:const M=i;return r.createZeroOrOnePath(o(M.path));case a.types.COMPOSITE_UPDATE:const L=i;return r.createCompositeUpdate(L.updates.map(o));case a.types.DELETE_INSERT:const k=i;return r.createDeleteInsert(k.delete?k.delete.map(o):void 0,k.insert?k.insert.map(o):void 0,k.where?o(k.where):void 0);case a.types.LOAD:const U=i;return r.createLoad(U.source,U.destination,U.silent);case a.types.CLEAR:const G=i;return r.createClear(G.source,G.silent);case a.types.CREATE:const H=i;return r.createCreate(H.source,H.silent);case a.types.DROP:const B=i;return r.createDrop(B.source,B.silent);case a.types.ADD:const F=i;return r.createAdd(F.source,F.destination);case a.types.MOVE:const Q=i;return r.createMove(Q.source,Q.destination);case a.types.COPY:const J=i;return r.createCopy(J.source,J.destination);default:throw new Error(`Unknown Operation type ${i.type}`)}}static mapExpression(e,t,r){let n=e=>s.mapOperation(e,t,r);switch(e.expressionType){case a.expressionTypes.AGGREGATE:if(e.variable){const t=e;return r.createBoundAggregate(t.variable,t.aggregator,n(t.expression),t.distinct,t.separator)}const t=e;return r.createAggregateExpression(t.aggregator,n(t.expression),t.distinct,t.separator);case a.expressionTypes.EXISTENCE:const s=e;return r.createExistenceExpression(s.not,n(s.input));case a.expressionTypes.NAMED:const i=e;return r.createNamedExpression(i.name,i.args.map(n));case a.expressionTypes.OPERATOR:const p=e;return r.createOperatorExpression(p.operator,p.args.map(n));case a.expressionTypes.TERM:const o=e;return r.createTermExpression(o.term);case a.expressionTypes.WILDCARD:return r.createWildcardExpression();default:throw new Error(`Unknown Expression type ${e.expressionType}`)}}static createUniqueVariable(e,t,r){let a=0,n=e;for(;t[n];)n=`${e}${a++}`;return r.variable(n)}static isSimpleTerm(e){return void 0!==e.termType&&"Quad"!==e.termType&&"Wildcard"!==e.termType}static isQuad(e){return"Quad"===e.termType}static isWildcard(e){return"Wildcard"===e.termType}}t.default=s},63260:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(2365),t)},2365:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorQueryOperationMoveRewrite=void 0;const a=r(67213),n=r(64264);class s extends a.ActorQueryOperationTypedMediated{constructor(e){super(e,"move"),this.factory=new n.Factory}async testOperation(e,t){return a.ActorQueryOperation.throwOnReadOnly(t),!0}runOperation(e,t){if("string"==typeof e.destination&&"string"==typeof e.source&&e.destination===e.source||"string"!=typeof e.destination&&"string"!=typeof e.source&&e.destination.equals(e.source))return Promise.resolve({type:"update",updateResult:Promise.resolve()});const r=[this.factory.createDrop(e.destination,!0),this.factory.createAdd(e.source,e.destination,e.silent),this.factory.createDrop(e.source)],a=this.factory.createCompositeUpdate(r);return this.mediatorQueryOperation.mediate({operation:a,context:t})}}t.ActorQueryOperationMoveRewrite=s},64264:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=t.toSparqlJs=t.toSparql=t.Factory=t.Algebra=t.translate=void 0;const a=r(35557);t.translate=a.default;const n=r(54270);t.Algebra=n;const s=r(4171);t.Factory=s.default;const i=r(70307);Object.defineProperty(t,"toSparql",{enumerable:!0,get:function(){return i.toSparql}}),Object.defineProperty(t,"toSparqlJs",{enumerable:!0,get:function(){return i.toSparqlJs}});const p=r(98453);t.Util=p.default},54270:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.expressionTypes=t.types=void 0,t.types={ALT:"alt",ASK:"ask",BGP:"bgp",CONSTRUCT:"construct",DESC:"desc",DESCRIBE:"describe",DISTINCT:"distinct",EXPRESSION:"expression",EXTEND:"extend",FILTER:"filter",FROM:"from",GRAPH:"graph",GROUP:"group",INV:"inv",JOIN:"join",LEFT_JOIN:"leftjoin",LINK:"link",MINUS:"minus",NOP:"nop",NPS:"nps",ONE_OR_MORE_PATH:"OneOrMorePath",ORDER_BY:"orderby",PATH:"path",PATTERN:"pattern",PROJECT:"project",REDUCED:"reduced",SEQ:"seq",SERVICE:"service",SLICE:"slice",UNION:"union",VALUES:"values",ZERO_OR_MORE_PATH:"ZeroOrMorePath",ZERO_OR_ONE_PATH:"ZeroOrOnePath",COMPOSITE_UPDATE:"compositeupdate",DELETE_INSERT:"deleteinsert",LOAD:"load",CLEAR:"clear",CREATE:"create",DROP:"drop",ADD:"add",MOVE:"move",COPY:"copy"},t.expressionTypes={AGGREGATE:"aggregate",EXISTENCE:"existence",NAMED:"named",OPERATOR:"operator",TERM:"term",WILDCARD:"wildcard"}},4171:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(54270),n=r(41640),s=r(22086),i=r(9619);t.default=class{constructor(e){this.dataFactory=e||new n.DataFactory,this.stringType=this.createTerm("http://www.w3.org/2001/XMLSchema#string")}createAlt(e,t){return{type:a.types.ALT,left:e,right:t}}createAsk(e){return{type:a.types.ASK,input:e}}createBoundAggregate(e,t,r,a,n){let s=this.createAggregateExpression(t,r,a,n);return s.variable=e,s}createBgp(e){return{type:a.types.BGP,patterns:e}}createConstruct(e,t){return{type:a.types.CONSTRUCT,input:e,template:t}}createDescribe(e,t){return{type:a.types.DESCRIBE,input:e,terms:t}}createDistinct(e){return{type:a.types.DISTINCT,input:e}}createExtend(e,t,r){return{type:a.types.EXTEND,input:e,variable:t,expression:r}}createFrom(e,t,r){return{type:a.types.FROM,input:e,default:t,named:r}}createFilter(e,t){return{type:a.types.FILTER,input:e,expression:t}}createGraph(e,t){return{type:a.types.GRAPH,input:e,name:t}}createGroup(e,t,r){return{type:a.types.GROUP,input:e,variables:t,aggregates:r}}createInv(e){return{type:a.types.INV,path:e}}createJoin(e,t){return{type:a.types.JOIN,left:e,right:t}}createLeftJoin(e,t,r){return r?{type:a.types.LEFT_JOIN,left:e,right:t,expression:r}:{type:a.types.LEFT_JOIN,left:e,right:t}}createLink(e){return{type:a.types.LINK,iri:e}}createMinus(e,t){return{type:a.types.MINUS,left:e,right:t}}createNop(){return{type:a.types.NOP}}createNps(e){return{type:a.types.NPS,iris:e}}createOneOrMorePath(e){return{type:a.types.ONE_OR_MORE_PATH,path:e}}createOrderBy(e,t){return{type:a.types.ORDER_BY,input:e,expressions:t}}createPath(e,t,r,n){return n?{type:a.types.PATH,subject:e,predicate:t,object:r,graph:n}:{type:a.types.PATH,subject:e,predicate:t,object:r,graph:this.dataFactory.defaultGraph()}}createPattern(e,t,r,n){let s=this.dataFactory.quad(e,t,r,n);return s.type=a.types.PATTERN,s}createProject(e,t){return{type:a.types.PROJECT,input:e,variables:t}}createReduced(e){return{type:a.types.REDUCED,input:e}}createSeq(e,t){return{type:a.types.SEQ,left:e,right:t}}createService(e,t,r){return{type:a.types.SERVICE,input:e,name:t,silent:r}}createSlice(e,t,r){return t=t||0,void 0!==r?{type:a.types.SLICE,input:e,start:t,length:r}:{type:a.types.SLICE,input:e,start:t}}createUnion(e,t){return{type:a.types.UNION,left:e,right:t}}createValues(e,t){return{type:a.types.VALUES,variables:e,bindings:t}}createZeroOrMorePath(e){return{type:a.types.ZERO_OR_MORE_PATH,path:e}}createZeroOrOnePath(e){return{type:a.types.ZERO_OR_ONE_PATH,path:e}}createAggregateExpression(e,t,r,n){return n?{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,separator:n,distinct:r}:{type:a.types.EXPRESSION,expressionType:a.expressionTypes.AGGREGATE,aggregator:e,expression:t,distinct:r}}createExistenceExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.EXISTENCE,not:e,input:t}}createNamedExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.NAMED,name:e,args:t}}createOperatorExpression(e,t){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.OPERATOR,operator:e,args:t}}createTermExpression(e){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.TERM,term:e}}createWildcardExpression(){return{type:a.types.EXPRESSION,expressionType:a.expressionTypes.WILDCARD,wildcard:new i.Wildcard}}createTerm(e){return s.stringToTerm(e,this.dataFactory)}createCompositeUpdate(e){return{type:a.types.COMPOSITE_UPDATE,updates:e}}createDeleteInsert(e,t,r){const n={type:a.types.DELETE_INSERT};return e&&(n.delete=e),t&&(n.insert=t),r&&(n.where=r),n}createLoad(e,t,r){const n={type:a.types.LOAD,source:e};return t&&(n.destination=t),this.addSilent(n,r)}createClear(e,t){return this.addSilent({type:a.types.CLEAR,source:e},t)}createCreate(e,t){return this.addSilent({type:a.types.CREATE,source:e},t)}createDrop(e,t){return this.addSilent({type:a.types.DROP,source:e},t)}createAdd(e,t,r){return this.addSilent({type:a.types.ADD,source:e,destination:t},r)}createMove(e,t,r){return this.addSilent({type:a.types.MOVE,source:e,destination:t},r)}createCopy(e,t,r){return this.addSilent({type:a.types.COPY,source:e,destination:t},r)}addSilent(e,t){return t&&(e.silent=t),e}}},70307:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.toSparqlJs=t.toSparql=void 0;const a=r(76065),n=r(22086),s=r(9619),i=r(54270),p=r(4171),o=r(98453),c=i.types,u=i.expressionTypes;let l;const d=new p.default;function y(e){f();let t=h(e=function(e){return A(e,{})}(e));return"group"===t.type?t.patterns[0]:t}function f(){l={project:!1,extend:[],group:[],aggregates:[],order:[]}}function h(e){switch(e.type!==c.EXTEND&&e.type!==c.ORDER_BY&&e.type!==c.GRAPH&&(l.project=!1),e.type){case c.EXPRESSION:return m(e);case c.ASK:return R(e,c.ASK);case c.BGP:return function(e){let t=e.patterns.map(T);return 0===t.length?null:{type:"bgp",triples:t}}(e);case c.CONSTRUCT:return function(e){return{type:"query",prefixes:{},queryType:"CONSTRUCT",template:e.template.map(T),where:o.default.flatten([h(e.input)])}}(e);case c.DESCRIBE:return R(e,c.DESCRIBE);case c.DISTINCT:return function(e){let t=h(e.input);return t.patterns[0].distinct=!0,t}(e);case c.EXTEND:return function(e){return l.project?(l.extend.push(e),h(e.input)):o.default.flatten([h(e.input),{type:"bind",variable:e.variable,expression:m(e.expression)}])}(e);case c.FROM:return function(e){const t=h(e.input);return t.patterns[0].from={default:e.default,named:e.named},t}(e);case c.FILTER:return function(e){return{type:"group",patterns:o.default.flatten([h(e.input),{type:"filter",expression:m(e.expression)}])}}(e);case c.GRAPH:return function(e){return{type:"graph",patterns:o.default.flatten([h(e.input)]),name:e.name}}(e);case c.GROUP:return function(e){const t=h(e.input),r=e.aggregates.map(b);return l.aggregates.push(...r),l.group.push(...e.variables),t}(e);case c.JOIN:return function(e){return o.default.flatten([h(e.left),h(e.right)]).reduce(((e,t)=>("bgp"!==t.type||0==e.length||"bgp"!==e[e.length-1].type?e.push(t):e[e.length-1].triples.push(...t.triples),e)),[])}(e);case c.LEFT_JOIN:return function(e){const t={type:"optional",patterns:[h(e.right)]};return e.expression&&t.patterns.push({type:"filter",expression:m(e.expression)}),t.patterns=o.default.flatten(t.patterns),o.default.flatten([h(e.left),t])}(e);case c.MINUS:return function(e){let t=h(e.right);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),o.default.flatten([h(e.left),{type:"minus",patterns:t}])}(e);case c.NOP:return{};case c.ORDER_BY:return function(e){return l.order.push(...e.expressions),h(e.input)}(e);case c.PATH:return function(e){return{type:"bgp",triples:[{subject:e.subject,predicate:g(e.predicate),object:e.object}]}}(e);case c.PATTERN:return T(e);case c.PROJECT:return R(e,c.PROJECT);case c.REDUCED:return function(e){let t=h(e.input);return t.patterns[0].reduced=!0,t}(e);case c.SERVICE:return function(e){let t=h(e.input);return"group"===t.type&&(t=t.patterns),Array.isArray(t)||(t=[t]),{type:"service",name:e.name,silent:e.silent,patterns:t}}(e);case c.SLICE:return function(e){let t=h(e.input),r=t;return t.type&&"group"===t.type&&(r=t.patterns[0]),0!==e.start&&(r.offset=e.start),void 0!==e.length&&(r.limit=e.length),t}(e);case c.UNION:return function(e){return{type:"union",patterns:o.default.flatten([h(e.left),h(e.right)])}}(e);case c.VALUES:return function(e){return{type:"values",values:e.bindings.map((t=>{let r={};for(let a of e.variables){let e=`?${a.value}`;t[e]?r[e]=t[e]:r[e]=void 0}return r}))}}(e);case c.COMPOSITE_UPDATE:return function(e){return{prefixes:{},type:"update",updates:e.updates.map((e=>h(e).updates[0]))}}(e);case c.DELETE_INSERT:return function(e){let t,r=e.where;if(r&&r.type===c.FROM){let a=e.where;r=a.input,t={default:a.default,named:a.named}}const n=[{updateType:"insertdelete",delete:P(e.delete),insert:P(e.insert)}];if(t&&(n[0].using=t),!r||r.type===c.BGP&&0===r.patterns.length)n[0].where=[];else{const e={};let t=h(A(r,e));"group"===t.type?n[0].where=t.patterns:n[0].where=[t];const a=Object.keys(e);if(a.length>0){if(1!==a.length)throw new Error("This is unexpected and might indicate an error in graph handling for updates.");""!==e[a[0]].graph.value&&(n[0].where=[{type:"graph",patterns:n[0].where,name:e[a[0]].graph}])}}return e.delete||e.where?e.insert||e.where?!e.insert&&e.where&&"bgp"===e.where.type&&a.isomorphic(e.delete,e.where.patterns)&&(delete n[0].where,n[0].updateType="deletewhere"):(delete n[0].insert,delete n[0].where,e.delete.some((e=>"Variable"===e.subject.termType||"Variable"===e.predicate.termType||"Variable"===e.object.termType))?n[0].updateType="deletewhere":n[0].updateType="delete"):(n[0].updateType="insert",delete n[0].delete,delete n[0].where),{prefixes:{},type:"update",updates:n}}(e);case c.LOAD:return function(e){const t=[{type:"load",silent:Boolean(e.silent),source:e.source}];return e.destination&&(t[0].destination=e.destination),{prefixes:{},type:"update",updates:t}}(e);case c.CLEAR:return function(e){return v(e,"clear")}(e);case c.CREATE:return function(e){return v(e,"create")}(e);case c.DROP:return function(e){return v(e,"drop")}(e);case c.ADD:return function(e){return w(e,"add")}(e);case c.MOVE:return function(e){return w(e,"move")}(e);case c.COPY:return function(e){return w(e,"copy")}(e)}throw new Error(`Unknown Operation type ${e.type}`)}function m(e){switch(e.expressionType){case u.AGGREGATE:return function(e){const t={expression:m(e.expression),type:"aggregate",aggregation:e.aggregator,distinct:e.distinct};return e.separator&&(t.separator=e.separator),t}(e);case u.EXISTENCE:return function(e){return{type:"operation",operator:e.not?"notexists":"exists",args:o.default.flatten([h(e.input)])}}(e);case u.NAMED:return function(e){return{type:"functionCall",function:e.name,args:e.args.map(m)}}(e);case u.OPERATOR:return function(e){if("desc"===e.operator){return{expression:m(e.args[0]),descending:!0}}const t={type:"operation",operator:e.operator,args:e.args.map(m)};return"in"!==t.operator&&"notin"!==t.operator||(t.args=[t.args[0]].concat([t.args.slice(1)])),t}(e);case u.TERM:return function(e){return e.term}(e);case u.WILDCARD:return function(e){return e.wildcard}(e)}throw new Error(`Unknown Expression Operation type ${e.expressionType}`)}function g(e){switch(e.type){case c.ALT:return function(e){const t=g(e.left),r=g(e.right);return"pathType"in t&&"!"===t.pathType&&"pathType"in r&&"!"===r.pathType?{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:[].concat(t.items,r.items)}]}:{type:"path",pathType:"|",items:[t,r]}}(e);case c.INV:return function(e){if(e.path.type===c.NPS){const t=e.path.iris.map((e=>({type:"path",pathType:"^",items:[e]})));return t.length<=1?{type:"path",pathType:"!",items:t}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:t}]}}return{type:"path",pathType:"^",items:[g(e.path)]}}(e);case c.LINK:return function(e){return e.iri}(e);case c.NPS:return function(e){return e.iris.length<=1?{type:"path",pathType:"!",items:e.iris}:{type:"path",pathType:"!",items:[{type:"path",pathType:"|",items:e.iris}]}}(e);case c.ONE_OR_MORE_PATH:return function(e){return{type:"path",pathType:"+",items:[g(e.path)]}}(e);case c.SEQ:return function(e){return{type:"path",pathType:"/",items:[g(e.left),g(e.right)]}}(e);case c.ZERO_OR_MORE_PATH:return function(e){return{type:"path",pathType:"*",items:[g(e.path)]}}(e);case c.ZERO_OR_ONE_PATH:return function(e){return{type:"path",pathType:"?",items:[g(e.path)]}}(e)}throw new Error(`Unknown Path type ${e.type}`)}function E(e){return n.termToString(e)}function b(e){return e}function T(e){return{subject:e.subject,predicate:e.predicate,object:e.object}}function O(e,t){let r=o.default.isSimpleTerm(e)?E(e):e;if("string"==typeof r){if(t[r])return t[r]}else if(Array.isArray(e))e=e.map((e=>O(e,t)));else for(let r of Object.keys(e))e[r]=O(e[r],t);return e}function R(e,t){const r={type:"query",prefixes:{}},a=r;let n;t===c.PROJECT?(r.queryType="SELECT",n=e.variables):t===c.ASK?r.queryType="ASK":t===c.DESCRIBE&&(r.queryType="DESCRIBE",n=e.terms);const i=l.extend,p=l.group,u=l.aggregates,d=l.order;f(),l.project=!0;let y=o.default.flatten([h(e.input)]);1===y.length&&"group"===y[0].type&&(y=y[0].patterns),r.where=y;let g={};for(let e of l.aggregates)g[E(e.variable)]=m(e);let b={};for(let e=l.extend.length-1;e>=0;--e){let t=l.extend[e];b[E(t.variable)]=O(m(t.expression),g)}if(l.group.length>0&&(a.group=l.group.map((e=>{let t=E(e);if(b[t]){let r=b[t];return delete b[t],{variable:e,expression:r}}return{expression:e}}))),l.order.length>0&&(a.order=l.order.map(h).map((e=>e.descending?e:{expression:e}))),n&&(a.variables=n.map((e=>{let t=E(e);return b[t]?{variable:e,expression:b[t]}:e})),0===a.variables.length&&(a.variables=[new s.Wildcard])),r.where.length>0&&"filter"===r.where[r.where.length-1].type){const e=r.where[r.where.length-1];S(e,Object.keys(g))&&(a.having=o.default.flatten([O(e.expression,g)]),r.where.splice(-1))}return l.extend=i,l.group=p,l.aggregates=u,l.order=d,{type:"group",patterns:[a]}}function S(e,t){return o.default.isSimpleTerm(e)?t.indexOf(E(e))>=0:Array.isArray(e)?e.some((e=>S(e,t))):e===Object(e)?Object.keys(e).some((r=>S(e[r],t))):t.indexOf(e)>=0}function v(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return"DEFAULT"===e.source?r[0].graph={default:!0}:"NAMED"===e.source?r[0].graph={named:!0}:"ALL"===e.source?r[0].graph={all:!0}:r[0].graph={type:"graph",name:e.source},{prefixes:{},type:"update",updates:r}}function w(e,t){const r=[{type:t,silent:Boolean(e.silent)}];return r[0].source="DEFAULT"===e.source?{type:"graph",default:!0}:{type:"graph",name:e.source},r[0].destination="DEFAULT"===e.destination?{type:"graph",default:!0}:{type:"graph",name:e.destination},{prefixes:{},type:"update",updates:r}}function P(e){if(!e)return[];const t={};return e.forEach((e=>{const r=e.graph.value;t[r]||(t[r]=[]),t[r].push(e)})),Object.keys(t).map((e=>""===e?{type:"bgp",triples:t[e].map(T)}:{type:"graph",triples:t[e].map(T),name:t[e][0].graph}))}function A(e,t){if(Array.isArray(e))return e.map((e=>A(e,t)));if(!e.type)return e;if(e.type===c.DELETE_INSERT)return e;if((e.type===c.PATTERN||e.type===c.PATH)&&e.graph)return t[e.graph.value]||(t[e.graph.value]={graph:e.graph,values:[]}),t[e.graph.value].values.push(e),e;const r={},a={},n={};for(let t of Object.keys(e)){const s={};r[t]=A(e[t],s);const i=Object.keys(s);if(i.length>1){let e=x(s[i[0]].values);for(let t=1;t<i.length;++t){const r=x(s[i[t]].values);e=d.createJoin(e,r)}return i.map((e=>delete s[e])),e}if(1===i.length){const e=s[i[0]].graph;a[t]=e,n[e.value]=e}}const s=Object.keys(n);if(s.length>0)if(1===s.length&&e.type!==c.PROJECT)t[s[0]]={graph:n[s[0]],values:[r]};else for(let e of Object.keys(a))a[e].value.length>0&&(r[e]=d.createGraph(r[e],a[e]));return r}function x(e){const t=d.createBgp(e),r=e[0].graph;return 0===r.value.length?t:d.createGraph(t,r)}t.toSparql=function(e,t={}){return new s.Generator(t).stringify(y(e))},t.toSparqlJs=y},35557:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(64063),n=r(22086),s=r(54270),i=r(4171),p=r(98453),o=r(9619).Parser,c=s.types;let u,l=new Set,d=0,y=!1;function f(e,t,r){if(l=new Set,d=0,y=t,!e.type)return u.createNop();if("query"!==e.type&&"update"!==e.type)throw new Error("Translate only works on complete query or update objects.");const a=new Set(Object.keys(m(e)).map(u.createTerm.bind(u)));let n;var s;return"query"===e.type?(n=g({type:"group",patterns:e.where||[]}),n=function(e,t,r){const a=e,n=[],s={};if(a.variables=a.variables&&a.variables.map((e=>x(e,s))),a.having=a.having&&a.having.map((e=>x(e,s))),a.order=a.order&&a.order.map((e=>x(e,s))),a.group||Object.keys(s).length>0){const e=Object.keys(s).map((e=>function(e,t){if("aggregate"!==e.type||!e.aggregation)throw new Error(`Unexpected input: ${JSON.stringify(e)}`);const r=E(e);return r.variable=t,r}(s[e],u.createTerm(e)))),r=[];if(a.group)for(const e of a.group)if(p.default.isSimpleTerm(e.expression))r.push(e.expression);else{const a="variable"in e?e.variable:O();t=u.createExtend(t,a,E(e.expression)),r.push(a)}t=u.createGroup(t,r,e)}if(a.having)for(let e of a.having)t=u.createFilter(t,E(e));e.values&&(t=u.createJoin(t,A(e)));let i=new Set;if("SELECT"===e.queryType||"DESCRIBE"===e.queryType)if(e.variables.some((e=>e&&p.default.isWildcard(e))))i=r;else for(let t of e.variables)h(t)||!("variable"in t)?i.add(t):t.variable&&(i.add(t.variable),n.push(t));for(let e of n)t=u.createExtend(t,e.variable,E(e.expression));return a.order&&(t=u.createOrderBy(t,a.order.map((e=>{let t=E(e.expression);return e.descending&&(t=u.createOperatorExpression(c.DESC,[t])),t})))),"SELECT"===e.queryType&&(t=u.createProject(t,Array.from(i))),a.distinct&&(t=u.createDistinct(t)),a.reduced&&(t=u.createReduced(t)),"CONSTRUCT"===e.queryType?t=u.createConstruct(t,e.template.map(R)):"ASK"===e.queryType?t=u.createAsk(t):"DESCRIBE"===e.queryType&&(t=u.createDescribe(t,Array.from(i))),(a.offset||a.limit)&&(t=u.createSlice(t,a.offset,a.limit)),a.from&&(t=u.createFrom(t,a.from.default,a.from.named)),t}(e,n,a)):"update"===e.type&&(n=1===(s=e).updates.length?j(s.updates[0]):u.createCompositeUpdate(s.updates.map(j))),r&&(n=_(n,a)),n}function h(e){return"Variable"===(null==e?void 0:e.termType)}function m(e){let t={};if(h(e))t[n.termToString(e)]=!0,l.add(e.value);else if(null!==(r=e)&&"object"==typeof r)if("bind"===e.type)m(e.expression),Object.assign(t,m(e.variable));else if("SELECT"===e.queryType){let r=m(e.where);for(let a of e.variables)p.default.isWildcard(a)?Object.assign(t,r):a.variable?Object.assign(t,m(a.variable)):Object.assign(t,m(a));if(e.group)for(let r of e.group)Object.assign(t,m(r))}else for(let r of Object.keys(e))Object.assign(t,m(e[r]));var r;return t}function g(e){let t,r=[],a=[];if("patterns"in e)for(let t of e.patterns)("filter"===t.type?r:a).push(t);if("bgp"===e.type)return function(e){let t=[],r=[];for(let n of e.triples)if("pathType"in n.predicate){let e=T((a=n).subject,b(a.predicate),a.object);for(let a of e)a.type===c.PATH?(t.length>0&&r.push(u.createBgp(t)),t=[],r.push(a)):t.push(a)}else t.push(R(n));var a;return t.length>0&&r.push(u.createBgp(t)),1===r.length?r[0]:r.reduce(((e,t)=>u.createJoin(e,t)))}(e);if("union"===e.type)t=a.map((e=>("group"!==e.type&&(e={type:"group",patterns:[e]}),g(e)))).reduce(((e,t)=>u.createUnion(e,t)));else{if("graph"===e.type)return function(e){let t=g({type:"group",patterns:e.patterns});return t=y?v(t,e.name):u.createGraph(t,e.name),t}(e);if("group"===e.type)t=a.reduce(w,u.createBgp([]));else if("values"===e.type)t=A(e);else{if("query"!==e.type)throw new Error(`Unexpected type: ${e.type}`);t=f(e,y,!1)}}if(r.length>0){let e=r.map((e=>E(e.expression)));e.length>0&&(t=u.createFilter(t,e.reduce(((e,t)=>u.createOperatorExpression("&&",[e,t])))))}return t}function E(e){if(p.default.isSimpleTerm(e)||p.default.isQuad(e))return u.createTermExpression(e);if(p.default.isWildcard(e))return u.createWildcardExpression();if("aggregation"in e)return u.createAggregateExpression(e.aggregation,E(e.expression),e.distinct,e.separator);if("function"in e)return u.createNamedExpression(e.function,e.args.map(E));if("operator"in e)return"exists"===e.operator||"notexists"===e.operator?u.createExistenceExpression("notexists"===e.operator,g(e.args[0])):("in"!==e.operator&&"notin"!==e.operator||(e.args=[e.args[0]].concat(e.args[1])),u.createOperatorExpression(e.operator,e.args.map(E)));throw new Error(`Unknown expression: ${JSON.stringify(e)}`)}function b(e){if(p.default.isSimpleTerm(e)){if("NamedNode"===e.termType)return u.createLink(e);throw new Error(`Path predicate should be a NamedNode, got ${JSON.stringify(e)}`)}if("^"===e.pathType)return u.createInv(b(e.items[0]));if("!"===e.pathType){let t,r=[],a=[];t="pathType"in e.items[0]&&"|"===e.items[0].pathType?e.items[0].items:e.items;for(let e of t)if(p.default.isSimpleTerm(e))r.push(e);else{if("^"!==e.pathType)throw new Error(`Unexpected item: ${JSON.stringify(e)}`);a.push(e.items[0])}let n=u.createNps(r),s=u.createInv(u.createNps(a));return 0===a.length?n:0===r.length?s:u.createAlt(n,s)}if("/"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createSeq(e,t)));if("|"===e.pathType)return e.items.map(b).reduce(((e,t)=>u.createAlt(e,t)));if("*"===e.pathType)return u.createZeroOrMorePath(b(e.items[0]));if("+"===e.pathType)return u.createOneOrMorePath(b(e.items[0]));if("?"===e.pathType)return u.createZeroOrOnePath(b(e.items[0]));throw new Error(`Unable to translate path expression ${JSON.stringify(e)}`)}function T(e,t,r){if(t.type===c.LINK)return[u.createPattern(e,t.iri,r)];if(t.type===c.INV)return T(r,t.path,e);if(t.type===c.SEQ){let a=O(),n=T(e,t.left,a),s=T(a,t.right,r);return n.concat(s)}return[u.createPath(e,t,r)]}function O(){let e="?var"+d++;return l.has(e)?O():(l.add(e),u.createTerm(e))}function R(e){return u.createPattern(e.subject,e.predicate,e.object,e.graph)}t.default=function(e,t){let r;if(t=t||{},u=new i.default(t.dataFactory),"string"==typeof e){let a=new o(t);a._resetBlanks(),r=a.parse(e)}else r=e;return f(r,t.quads,t.blankToVariable)};let S=Object.values(c);function v(e,t,r){if(e.type===c.GRAPH){if(r)throw new Error("Recursing through nested GRAPH statements with a replacement is impossible.");const t=e;e=v(t.input,t.name)}else if(e.type===c.BGP)e.patterns=e.patterns.map((e=>(r&&(e.subject.equals(t)&&(e.subject=r),e.predicate.equals(t)&&(e.predicate=r),e.object.equals(t)&&(e.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t),e)));else if(e.type===c.PATH){const a=e;r&&(a.subject.equals(t)&&(a.subject=r),a.object.equals(t)&&(a.object=r)),"DefaultGraph"===e.graph.termType&&(e.graph=t)}else if(e.type!==c.PROJECT||r)if(e.type!==c.EXTEND||r)for(let a of Object.keys(e))Array.isArray(e[a])?e[a]=e[a].map((e=>v(e,t,r))):S.indexOf(e[a].type)>=0?e[a]=v(e[a],t,r):r&&h(e[a])&&e[a].equals(t)&&(e[a]=r);else{const a=e;a.variable.equals(t)&&(r=O()),a.input=v(a.input,t,r)}else{const a=e;a.variables.some((e=>e.equals(t)))||(r=O()),a.input=v(a.input,t,r)}return e}function w(e,t){if("optional"===t.type){const r=g({type:"group",patterns:t.patterns});if(r.type===c.FILTER){const t=r;e=u.createLeftJoin(e,t.input,t.expression)}else e=u.createLeftJoin(e,r)}else if("minus"===t.type){const r=g({type:"group",patterns:t.patterns});e=u.createMinus(e,r)}else if("bind"===t.type)e=u.createExtend(e,t.variable,E(t.expression));else if("service"===t.type){const r={type:"group",patterns:t.patterns};e=P(e,u.createService(g(r),t.name,t.silent))}else e=P(e,g(t));return e}function P(e,t){return e.type===c.BGP&&t.type===c.BGP?e=u.createBgp([].concat(e.patterns,t.patterns)):e.type===c.BGP&&0===e.patterns.length?e=t:t.type===c.BGP&&0===t.patterns.length||(e=u.createJoin(e,t)),e}function A(e){let t=(0===e.values.length?[]:Object.keys(e.values[0])).map(u.createTerm.bind(u)),r=e.values.map((e=>{let t=Object.keys(e);t=t.filter((t=>void 0!==e[t]));let r={};for(let a of t)r[a]=e[a];return r}));return u.createValues(t,r)}function x(e,t){if("type"in e&&"aggregate"===e.type){let r,s=!1;for(let n of Object.keys(t))if(a(t[n],e)){r=u.createTerm(n),s=!0;break}return s||(r=O(),t[n.termToString(r)]=e),r}return"expression"in e&&e.expression?Object.assign(Object.assign({},e),{expression:x(e.expression,t)}):"args"in e&&e.args?Object.assign(Object.assign({},e),{args:e.args.map((e=>x(e,t)))}):e}function j(e){if("type"in e){if("load"===e.type)return function(e){return u.createLoad(e.source,e.destination,e.silent)}(e);if("clear"===e.type||"create"===e.type||"drop"===e.type)return function(e){let t;switch(t=p.default.isSimpleTerm(e.graph)?e.graph:e.graph.all?"ALL":e.graph.default?"DEFAULT":e.graph.named?"NAMED":e.graph.name,e.type){case"clear":return u.createClear(t,e.silent);case"create":return u.createCreate(t,e.silent);case"drop":return u.createDrop(t,e.silent)}}(e);if("add"===e.type||"copy"===e.type||"move"===e.type)return function(e){const t=e.source.default?"DEFAULT":e.source.name,r=e.destination.default?"DEFAULT":e.destination.name;switch(e.type){case"copy":return u.createCopy(t,r,e.silent);case"move":return u.createMove(t,r,e.silent);case"add":return u.createAdd(t,r,e.silent)}}(e)}else if("insertdelete"===e.updateType||"deletewhere"===e.updateType||"delete"===e.updateType||"insert"===e.updateType)return function(e){if(!y)throw new Error("INSERT/DELETE operations are only supported with quads option enabled");let t,r=[],a=[];if(e.delete&&(r=p.default.flatten(e.delete.map((t=>N(t,e.graph))))),e.insert&&(a=p.default.flatten(e.insert.map((t=>N(t,e.graph))))),e.where&&e.where.length>0){t=g({type:"group",patterns:e.where});const r=e.using;r?t=u.createFrom(t,r.default,r.named):e.graph&&(t=v(t,e.graph))}else"deletewhere"===e.updateType&&r.length>0&&(t=u.createBgp(r));return u.createDeleteInsert(r.length>0?r:void 0,a.length>0?a:void 0,t)}(e);throw new Error(`Unknown update type ${JSON.stringify(e)}`)}function N(e,t){let r=t;"graph"===e.type&&(r=e.name);let a=e.triples;return r&&(a=a.map((e=>Object.assign(e,{graph:r})))),a.map(R)}function _(e,t){const r={},a=Array.from(t).reduce(((e,t)=>(e[t.value]=!0,e)),{});return p.default.mapOperation(e,{[s.types.DELETE_INSERT]:e=>({result:e,recurse:!1}),[s.types.PATH]:(e,t)=>({result:t.createPath(n(e.subject),e.predicate,n(e.object),n(e.graph)),recurse:!1}),[s.types.PATTERN]:(e,t)=>({result:t.createPattern(n(e.subject),n(e.predicate),n(e.object),n(e.graph)),recurse:!1}),[s.types.CONSTRUCT]:e=>({result:u.createConstruct(_(e.input,t),e.template),recurse:!1})});function n(e){if("BlankNode"===e.termType){let t=r[e.value];return t||(t=p.default.createUniqueVariable(e.value,a,u.dataFactory),a[t.value]=!0,r[e.value]=t),t}return e}}},98453:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});const a=r(54270),n=r(4171);class s{static flatten(e){return Array.prototype.concat(...e).filter((e=>e))}static objectify(e){if(e.termType){if("Quad"===e.termType)return{type:"pattern",termType:"Quad",subject:s.objectify(e.subject),predicate:s.objectify(e.predicate),object:s.objectify(e.object),graph:s.objectify(e.graph)};{let t={termType:e.termType,value:e.value};return e.language&&(t.language=e.language),e.datatype&&(t.datatype=s.objectify(e.datatype)),t}}if(Array.isArray(e))return e.map((e=>s.objectify(e)));if(e===Object(e)){let t={};for(let r of Object.keys(e))t[r]=s.objectify(e[r]);return t}return e}static inScopeVariables(e){const t=[];function r(e){t.find((t=>e.value===t.value))||t.push(e)}function n(e){"Variable"===e.subject.termType&&r(e.subject),"Variable"===e.predicate.termType&&r(e.predicate),"Variable"===e.object.termType&&r(e.object),"Variable"===e.graph.termType&&r(e.graph),"Quad"===e.subject.termType&&n(e.subject),"Quad"===e.predicate.termType&&n(e.predicate),"Quad"===e.object.termType&&n(e.object),"Quad"===e.graph.termType&&n(e.graph)}return s.recurseOperation(e,{[a.types.EXPRESSION]:e=>{let t=e;return t.expressionType===a.expressionTypes.AGGREGATE&&t.variable&&r(t.variable),!0},[a.types.EXTEND]:e=>(r(e.variable),!0),[a.types.GRAPH]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.GROUP]:e=>(e.variables.forEach(r),!0),[a.types.PATH]:e=>{let t=e;return"Variable"===t.subject.termType&&r(t.subject),"Variable"===t.object.termType&&r(t.object),"Variable"===t.graph.termType&&r(t.graph),"Quad"===t.subject.termType&&n(t.subject),"Quad"===t.object.termType&&n(t.object),"Quad"===t.graph.termType&&n(t.graph),!0},[a.types.PATTERN]:e=>(n(e),!0),[a.types.PROJECT]:e=>(e.variables.forEach(r),!1),[a.types.SERVICE]:e=>{let t=e;return"Variable"===t.name.termType&&r(t.name),!0},[a.types.VALUES]:e=>(e.variables.forEach(r),!0)}),t}static recurseOperation(e,t){let r=e,n=!0;if(t[e.type]&&(n=t[e.type](e)),!n)return;let i=e=>s.recurseOperation(e,t);switch(r.type){case a.types.ALT:const e=r;i(e.left),i(e.right);break;case a.types.ASK:i(r.input);break;case a.types.BGP:r.patterns.forEach(i);break;case a.types.CONSTRUCT:const t=r;i(t.input),t.template.map(i);break;case a.types.DESCRIBE:case a.types.DISTINCT:i(r.input);break;case a.types.EXPRESSION:const n=r;n.expressionType===a.expressionTypes.EXISTENCE&&i(n.input);break;case a.types.EXTEND:const s=r;i(s.input),i(s.expression);break;case a.types.FILTER:const p=r;i(p.input),i(p.expression);break;case a.types.FROM:case a.types.GRAPH:i(r.input);break;case a.types.GROUP:const o=r;i(o.input),o.aggregates.forEach(i);break;case a.types.INV:i(r.path);break;case a.types.JOIN:const c=r;i(c.left),i(c.right);break;case a.types.LEFT_JOIN:const u=r;i(u.left),i(u.right),u.expression&&i(u.expression);break;case a.types.LINK:break;case a.types.MINUS:const l=r;i(l.left),i(l.right);break;case a.types.NOP:case a.types.NPS:break;case a.types.ONE_OR_MORE_PATH:i(r.path);break;case a.types.ORDER_BY:const d=r;i(d.input),d.expressions.forEach(i);break;case a.types.PATH:i(r.predicate);break;case a.types.PATTERN:break;case a.types.PROJECT:case a.types.REDUCED:i(r.input);break;case a.types.SEQ:const y=r;i(y.left),i(y.right);break;case a.types.SERVICE:case a.types.SLICE:i(r.input);break;case a.types.UNION:const f=r;i(f.left),i(f.right);break;case a.types.VALUES:break;case a.types.ZERO_OR_MORE_PATH:case a.types.ZERO_OR_ONE_PATH:i(r.path);break;case a.types.COMPOSITE_UPDATE:r.updates.forEach((e=>i(e)));break;case a.types.DELETE_INSERT:const h=r;h.delete&&h.delete.forEach((e=>i(e))),h.insert&&h.insert.forEach((e=>i(e))),h.where&&i(h.where);break;case a.types.LOAD:case a.types.CLEAR:case a.types.CREATE:case a.types.DROP:case a.types.ADD:case a.types.MOVE:case a.types.COPY:break;default:throw new Error(`Unknown Operation type ${r.type}`)}}static mapOperation(e,t,r){let i=e,p=!0;if(r=r||new n.default,t[e.type]&&({result:i,recurse:p}=t[e.type](e,r)),!p)return i;let o=e=>s.mapOperation(e,t,r);switch(i.type){case a.types.ALT:const e=i;return r.createAlt(o(e.left),o(e.right));case a.types.ASK:const n=i;return r.createAsk(o(n.input));case a.types.BGP:const p=i;return r.createBgp(p.patterns.map(o));case a.types.CONSTRUCT:const c=i;return r.createConstruct(o(c.input),c.template.map(o));case a.types.DESCRIBE:const u=i;return r.createDescribe(o(u.input),u.terms);case a.types.DISTINCT:const l=i;return r.createDistinct(o(l.input));case a.types.EXPRESSION:const d=i;return s.mapExpression(d,t,r);case a.types.EXTEND:const y=i;return r.createExtend(o(y.input),y.variable,o(y.expression));case a.types.FILTER:const f=i;return r.createFilter(o(f.input),o(f.expression));case a.types.FROM:const h=i;return r.createFrom(o(h.input),[].concat(h.default),[].concat(h.named));case a.types.GRAPH:const m=i;return r.createGraph(o(m.input),m.name);case a.types.GROUP:const g=i;return r.createGroup(o(g.input),[].concat(g.variables),g.aggregates.map(o));case a.types.INV:const E=i;return r.createInv(o(E.path));case a.types.JOIN:const b=i;return r.createJoin(o(b.left),o(b.right));case a.types.LEFT_JOIN:const T=i;return r.createLeftJoin(o(T.left),o(T.right),T.expression?o(T.expression):void 0);case a.types.LINK:const O=i;return r.createLink(O.iri);case a.types.MINUS:const R=i;return r.createMinus(o(R.left),o(R.right));case a.types.NOP:return r.createNop();case a.types.NPS:const S=i;return r.createNps([].concat(S.iris));case a.types.ONE_OR_MORE_PATH:const v=i;return r.createOneOrMorePath(o(v.path));case a.types.ORDER_BY:const w=i;return r.createOrderBy(o(w.input),w.expressions.map(o));case a.types.PATH:const P=i;return r.createPath(P.subject,o(P.predicate),P.object,P.graph);case a.types.PATTERN:const A=i;return r.createPattern(A.subject,A.predicate,A.object,A.graph);case a.types.PROJECT:const x=i;return r.createProject(o(x.input),[].concat(x.variables));case a.types.REDUCED:const j=i;return r.createReduced(o(j.input));case a.types.SEQ:const N=i;return r.createSeq(o(N.left),o(N.right));case a.types.SERVICE:const _=i;return r.createService(o(_.input),_.name,_.silent);case a.types.SLICE:const I=i;return r.createSlice(o(I.input),I.start,I.length);case a.types.UNION:const C=i;return r.createUnion(o(C.left),o(C.right));case a.types.VALUES:const D=i;return r.createValues([].concat(D.variables),D.bindings.map((e=>Object.assign({},e))));case a.types.ZERO_OR_MORE_PATH:const q=i;return r.createZeroOrMorePath(o(q.path));case a.types.ZERO_OR_ONE_PATH:const M=i;return r.createZeroOrOnePath(o(M.path));case a.types.COMPOSITE_UPDATE:const L=i;return r.createCompositeUpdate(L.updates.map(o));case a.types.DELETE_INSERT:const k=i;return r.createDeleteInsert(k.delete?k.delete.map(o):void 0,k.insert?k.insert.map(o):void 0,k.where?o(k.where):void 0);case a.types.LOAD:const U=i;return r.createLoad(U.source,U.destination,U.silent);case a.types.CLEAR:const G=i;return r.createClear(G.source,G.silent);case a.types.CREATE:const H=i;return r.createCreate(H.source,H.silent);case a.types.DROP:const B=i;return r.createDrop(B.source,B.silent);case a.types.ADD:const F=i;return r.createAdd(F.source,F.destination);case a.types.MOVE:const Q=i;return r.createMove(Q.source,Q.destination);case a.types.COPY:const J=i;return r.createCopy(J.source,J.destination);default:throw new Error(`Unknown Operation type ${i.type}`)}}static mapExpression(e,t,r){let n=e=>s.mapOperation(e,t,r);switch(e.expressionType){case a.expressionTypes.AGGREGATE:if(e.variable){const t=e;return r.createBoundAggregate(t.variable,t.aggregator,n(t.expression),t.distinct,t.separator)}const t=e;return r.createAggregateExpression(t.aggregator,n(t.expression),t.distinct,t.separator);case a.expressionTypes.EXISTENCE:const s=e;return r.createExistenceExpression(s.not,n(s.input));case a.expressionTypes.NAMED:const i=e;return r.createNamedExpression(i.name,i.args.map(n));case a.expressionTypes.OPERATOR:const p=e;return r.createOperatorExpression(p.operator,p.args.map(n));case a.expressionTypes.TERM:const o=e;return r.createTermExpression(o.term);case a.expressionTypes.WILDCARD:return r.createWildcardExpression();default:throw new Error(`Unknown Expression type ${e.expressionType}`)}}static createUniqueVariable(e,t,r){let a=0,n=e;for(;t[n];)n=`${e}${a++}`;return r.variable(n)}static isSimpleTerm(e){return void 0!==e.termType&&"Quad"!==e.termType&&"Wildcard"!==e.termType}static isQuad(e){return"Quad"===e.termType}static isWildcard(e){return"Wildcard"===e.termType}}t.default=s},202:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(41010),t)},41010:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfDereferenceFallback=void 0;const a=r(14803);class n extends a.ActorRdfDereference{constructor(e){super(e)}async test(e){return!0}async run(e){return this.handleDereferenceError(e,new Error(`Could not dereference '${e.url}'`))}}t.ActorRdfDereferenceFallback=n},53836:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(32654),t)},32654:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfJoinNestedLoop=void 0;const a=r(67213),n=r(12444),s=r(49912);class i extends n.ActorRdfJoin{constructor(e){super(e,2,void 0,!0)}async getOutput(e){return{type:"bindings",bindingsStream:new s.NestedLoopJoin(e.entries[0].bindingsStream,e.entries[1].bindingsStream,n.ActorRdfJoin.join,{autoStart:!1}),variables:n.ActorRdfJoin.joinVariables(e),canContainUndefs:e.entries.reduce(((e,t)=>e||t.canContainUndefs),!1)}}async getIterations(e){return(await a.getMetadata(e.entries[0])).totalItems*(await a.getMetadata(e.entries[1])).totalItems}}t.ActorRdfJoinNestedLoop=i},60148:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(67936),t)},67936:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfMetadataExtractAllowHttpMethods=void 0;const a=r(79135);class n extends a.ActorRdfMetadataExtract{constructor(e){super(e)}async test(e){return!0}async run(e){const t={};return e.headers&&e.headers.allow&&(t.allowHttpMethods=e.headers.allow.split(/, */u)),{metadata:t}}}t.ActorRdfMetadataExtractAllowHttpMethods=n},18259:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(88779),t)},88779:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfMetadataExtractPatchSparqlUpdate=void 0;const a=r(79135);class n extends a.ActorRdfMetadataExtract{constructor(e){super(e)}async test(e){return!0}async run(e){const t={};return e.headers&&e.headers["accept-patch"]&&e.headers["accept-patch"].includes("application/sparql-update")&&(t.patchSparqlUpdate=!0),{metadata:t}}}t.ActorRdfMetadataExtractPatchSparqlUpdate=n},18085:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(22179),t)},22179:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfMetadataExtractPutAccepted=void 0;const a=r(79135);class n extends a.ActorRdfMetadataExtract{constructor(e){super(e)}async test(e){return!0}async run(e){const t={};return e.headers&&e.headers["accept-put"]&&(t.putAccepted=e.headers["accept-put"].split(/, */u)),{metadata:t}}}t.ActorRdfMetadataExtractPutAccepted=n},66328:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(54292),t)},54292:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfParseHtmlMicrodata=void 0;const a=r(13688),n=r(38793);class s extends a.ActorRdfParseHtml{constructor(e){super(e)}async test(e){return!0}async run(e){const t=e.headers?e.headers.get("content-type"):null,r=null==t?void 0:t.includes("xml"),a=new n.MicrodataRdfParser({baseIRI:e.baseIRI,xmlMode:r});a.on("error",e.error),a.on("data",e.emit);const s=a.onEnd;return a.onEnd=()=>{s.call(a),e.end()},{htmlParseListener:a}}}t.ActorRdfParseHtmlMicrodata=s},87489:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(54243),t)},54243:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfSerializeJsonLd=void 0;const a=r(74264),n=r(6900);class s extends a.ActorRdfSerializeFixedMediaTypes{constructor(e){super(e)}async runHandle(e,t,r){return{data:new n.JsonLdSerializer({space:" ".repeat(this.jsonStringifyIndentSpaces)}).import(e.quadStream)}}}t.ActorRdfSerializeJsonLd=s},80637:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(87857),t)},87857:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfSerializeN3=void 0;const a=r(74264),n=r(99170);class s extends a.ActorRdfSerializeFixedMediaTypes{constructor(e){super(e)}async runHandle(e,t,r){return{data:new n.StreamWriter({format:t}).import(e.quadStream),triples:"text/turtle"===t||"application/n-triples"===t||"text/n3"===t}}}t.ActorRdfSerializeN3=s},26571:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(74817),t),n(r(87781),t)},74817:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfUpdateHypermediaPatchSparqlUpdate=void 0;const a=r(48874),n=r(87781);class s extends a.ActorRdfUpdateHypermedia{constructor(e){super(e,"patchSparqlUpdate")}async testMetadata(e){if(!e.forceDestinationType&&!e.metadata.patchSparqlUpdate)throw new Error(`Actor ${this.name} could not detect a destination with 'application/sparql-update' as 'Accept-Patch' header.`);if(!e.exists)throw new Error(`Actor ${this.name} can only patch a destination that already exists.`);return!0}async run(e){return this.logInfo(e.context,`Identified as patchSparqlUpdate destination: ${e.url}`),{destination:new n.QuadDestinationPatchSparqlUpdate(e.url,e.context,this.mediatorHttp)}}}t.ActorRdfUpdateHypermediaPatchSparqlUpdate=s},87781:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadDestinationPatchSparqlUpdate=void 0;const a=r(42830),n=r(74864),s=r(54098),i=r(71367);t.QuadDestinationPatchSparqlUpdate=class{constructor(e,t,r){this.url=e,this.context=t,this.mediatorHttp=r}insert(e){return this.wrapSparqlUpdateRequest("INSERT",e)}async delete(e){return this.wrapSparqlUpdateRequest("DELETE",e)}async wrapSparqlUpdateRequest(e,t){var r;const p=t.map((e=>{let t=`${i.termToString(e.subject)} ${i.termToString(e.predicate)} ${i.termToString(e.object)} .`;return t="DefaultGraph"!==e.graph.termType?`  GRAPH ${i.termToString(e.graph)} { ${t} }\n`:`  ${t}\n`,t})).prepend([`${e} DATA {\n`]).append(["}"]),o=new a.Readable;o._read=()=>!0,p.on("data",(e=>o.push(e))),p.on("end",(()=>o.push(null)));const c=new s.Headers({"content-type":"application/sparql-update"}),u=await this.mediatorHttp.mediate({context:this.context,init:{headers:c,method:"PATCH",body:n.ActorHttp.toWebReadableStream(o)},input:this.url});if(u.status>=400)throw new Error(`Could not retrieve ${this.url} (${u.status}: ${u.statusText||"unknown error"})`);await(null===(r=u.body)||void 0===r?void 0:r.cancel())}async deleteGraphs(e,t,r){throw new Error("Patch-based SPARQL Update destinations don't support named graphs")}async createGraphs(e,t){throw new Error("Patch-based SPARQL Update destinations don't support named graphs")}}},5208:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(92198),t),n(r(93475),t)},92198:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfUpdateHypermediaPutLdp=void 0;const a=r(48874),n=r(93475);class s extends a.ActorRdfUpdateHypermedia{constructor(e){super(e,"putLdp")}async testMetadata(e){if(!e.forceDestinationType){if(!e.metadata.allowHttpMethods||!e.metadata.allowHttpMethods.includes("PUT"))throw new Error(`Actor ${this.name} could not detect a destination with 'Allow: PUT' header.`);if(e.exists)throw new Error(`Actor ${this.name} can only put on a destination that does not already exists.`)}return!0}async run(e){return this.logInfo(e.context,`Identified as putLdp destination: ${e.url}`),{destination:new n.QuadDestinationPutLdp(e.url,e.context,e.metadata.putAccepted||[],this.mediatorHttp,this.mediatorRdfSerializeMediatypes,this.mediatorRdfSerialize)}}}t.ActorRdfUpdateHypermediaPutLdp=s},93475:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadDestinationPutLdp=void 0;const a=r(74864),n=r(54098);t.QuadDestinationPutLdp=class{constructor(e,t,r,a,n,s){this.url=e,this.context=t,this.mediaTypes=r,this.mediatorHttp=a,this.mediatorRdfSerializeMediatypes=n,this.mediatorRdfSerialize=s}insert(e){return this.wrapRdfUpdateRequest("INSERT",e)}async delete(e){throw new Error("Put-based LDP destinations don't support deletions")}async wrapRdfUpdateRequest(e,t){var r;const{mediaTypes:s}=await this.mediatorRdfSerializeMediatypes.mediate({context:this.context,mediaTypes:!0}),i=this.mediaTypes.filter((e=>e in s)),p=i.length>0?i[0]:Object.keys(s).sort(((e,t)=>s[t]-s[e]))[0],{handle:{data:o}}=await this.mediatorRdfSerialize.mediate({handle:{quadStream:t},handleMediaType:p}),c=new n.Headers({"content-type":p}),u=await this.mediatorHttp.mediate({context:this.context,init:{headers:c,method:"PUT",body:a.ActorHttp.toWebReadableStream(o)},input:this.url});if(u.status>=400)throw new Error(`Could not retrieve ${this.url} (${u.status}: ${u.statusText||"unknown error"})`);await(null===(r=u.body)||void 0===r?void 0:r.cancel())}async deleteGraphs(e,t,r){throw new Error("Put-based LDP destinations don't support named graphs")}async createGraphs(e,t){throw new Error("Put-based LDP destinations don't support named graphs")}}},22951:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(64880),t),n(r(20925),t)},64880:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfUpdateHypermediaSparql=void 0;const a=r(48874),n=r(20925);class s extends a.ActorRdfUpdateHypermedia{constructor(e){super(e,"sparql")}async testMetadata(e){if(!(e.forceDestinationType||e.metadata.sparqlService||this.checkUrlSuffixSparql&&e.url.endsWith("/sparql")||this.checkUrlSuffixUpdate&&e.url.endsWith("/update")))throw new Error(`Actor ${this.name} could not detect a SPARQL service description or URL ending on /sparql or /update.`);return!0}async run(e){return this.logInfo(e.context,`Identified as sparql destination: ${e.url}`),{destination:new n.QuadDestinationSparql(e.metadata.sparqlService||e.url,e.context,this.mediatorHttp)}}}t.ActorRdfUpdateHypermediaSparql=s},20925:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QuadDestinationSparql=void 0;const a=r(53350),n=r(71367),s=r(83858);t.QuadDestinationSparql=class{constructor(e,t,r){this.url=e,this.context=t,this.mediatorHttp=r,this.endpointFetcher=new a.SparqlEndpointFetcher({fetch:(e,t)=>this.mediatorHttp.mediate({input:e,init:t,context:this.context}),prefixVariableQuestionMark:!0})}insert(e){return this.wrapSparqlUpdateRequest("INSERT",e)}async delete(e){return this.wrapSparqlUpdateRequest("DELETE",e)}async wrapSparqlUpdateRequest(e,t){const r=t.map((e=>{let t=`${n.termToString(e.subject)} ${n.termToString(e.predicate)} ${n.termToString(e.object)} .`;return t="DefaultGraph"!==e.graph.termType?`  GRAPH ${n.termToString(e.graph)} { ${t} }\n`:`  ${t}\n`,t})).prepend([`${e} DATA {\n`]).append(["}"]),a=await s(r);await this.endpointFetcher.fetchUpdate(this.url,a)}async deleteGraphs(e,t,r){const a=Array.isArray(e)?e:[e],n=[];for(const e of a){let a;a="string"==typeof e?e:"DefaultGraph"===e.termType?"DEFAULT":`GRAPH <${e.value}>`,n.push(`${r?"DROP":"CLEAR"} ${t?"":"SILENT "}${a}`)}await this.endpointFetcher.fetchUpdate(this.url,n.join("; "))}async createGraphs(e,t){const r=[];for(const a of e)r.push(`CREATE${t?"":" SILENT"} GRAPH <${a.value}>`);await this.endpointFetcher.fetchUpdate(this.url,r.join("; "))}}},71664:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(61282),t)},61282:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfUpdateQuadsHypermedia=void 0;const a=r(5657),n=r(39593);class s extends a.ActorRdfUpdateQuadsDestination{constructor(e){super(e),this.cache=this.cacheSize?new n({max:this.cacheSize}):void 0;const t=this.cache;t&&this.httpInvalidator.addInvalidateListener((({url:e})=>e?t.del(e):t.reset()))}async test(e){if(!this.getContextDestinationUrl(this.getContextDestination(e.context)))throw new Error(`Actor ${this.name} can only update quads against a single destination URL.`);return!0}getDestination(e){const t=this.getContextDestination(e);let r=this.getContextDestinationUrl(t);if(this.cache&&this.cache.has(r))return this.cache.get(r);const n=(async()=>{let n,s;try{const t=await this.mediatorRdfDereference.mediate({context:e,url:r,acceptErrors:!0});s=t.exists,r=t.url;const a=await this.mediatorMetadata.mediate({context:e,url:r,quads:t.quads,triples:t.triples});n=(await this.mediatorMetadataExtract.mediate({context:e,url:r,metadata:a.metadata,headers:t.headers})).metadata}catch(e){n={},s=!1}const{destination:i}=await this.mediatorRdfUpdateHypermedia.mediate({context:e,url:r,metadata:n,exists:s,forceDestinationType:a.getDataDestinationType(t)});return i})();return this.cache&&this.cache.set(r,n),n}}t.ActorRdfUpdateQuadsHypermedia=s},25639:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(56424),t)},56424:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfUpdateQuadsRdfJsStore=void 0;const a=r(5657),n=r(18852);class s extends a.ActorRdfUpdateQuadsDestination{constructor(e){super(e)}async test(e){const t=this.getContextDestination(e.context);if(!t||"string"==typeof t||!("remove"in t)&&"value"in t&&!t.value.remove)throw new Error(`${this.name} received an invalid rdfjsStore.`);return!0}async getDestination(e){const t=this.getContextDestination(e);return new n.RdfJsQuadDestination("remove"in t?t:t.value)}}t.ActorRdfUpdateQuadsRdfJsStore=s},18852:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RdfJsQuadDestination=void 0;const a=r(41640),n=r(22086),s=new a.DataFactory;t.RdfJsQuadDestination=class{constructor(e){this.store=e}promisifyEventEmitter(e){return new Promise(((t,r)=>{e.on("end",t),e.on("error",r)}))}delete(e){return this.promisifyEventEmitter(this.store.remove(e))}insert(e){return this.promisifyEventEmitter(this.store.import(e))}async deleteGraphs(e,t,r){switch(e){case"ALL":await this.promisifyEventEmitter(this.store.deleteGraph(s.defaultGraph()));case"NAMED":const t=this.store.match(),r={};t.on("data",(e=>{"DefaultGraph"!==e.graph.termType&&(r[n.termToString(e.graph)]=!0)})),await this.promisifyEventEmitter(t),await Promise.all(Object.keys(r).map((e=>this.promisifyEventEmitter(this.store.deleteGraph(n.stringToTerm(e))))));break;default:for(const t of Array.isArray(e)?e:[e])await this.promisifyEventEmitter(this.store.deleteGraph(t))}}async createGraphs(e,t){if(t)for(const t of e){const e=this.store.match(void 0,void 0,void 0,t);await new Promise(((r,a)=>{e.once("data",(()=>{a(new Error(`Unable to create graph ${t.value} as it already exists`))})),e.on("end",r),e.on("error",a)}))}}}},50529:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(93258),t)},93258:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorSparqlParseGraphql=void 0;const a=r(99725),n=r(79655);class s extends a.ActorSparqlParse{constructor(e){super(e),this.graphqlToSparql=new n.Converter({requireContext:!0})}async test(e){if("graphql"!==e.queryFormat)throw new Error("This actor can only parse GraphQL queries");return!0}async run(e){const t=e.context&&e.context.has("@context")?e.context.get("@context"):{},r={singularizeVariables:e.context&&e.context.get("@comunica/actor-init-sparql:singularizeVariables")};return{operation:await this.graphqlToSparql.graphqlToSparqlAlgebra(e.query,t,r)}}}t.ActorSparqlParseGraphql=s},21965:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(8569),t)},8569:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorSparqlSerializeSparqlCsv=void 0;const a=r(42830),n=r(78432);class s extends n.ActorSparqlSerializeFixedMediaTypes{constructor(e){super(e)}static bindingToCsvBindings(e){if(!e)return"";let t=e.value;return t="Literal"===e.termType?`${t}`:"BlankNode"===e.termType?`_:${t}`:`<${t}>`,/[",\n\r]/u.test(t)&&(t=`"${t.replace(/"/gu,'""')}"`),t}async testHandleChecked(e,t){if("bindings"!==e.type)throw new Error("This actor can only handle bindings streams.");return!0}async runHandle(e,t,r){const n=e,i=new a.Readable;return i._read=()=>{},i.push(`${n.variables.map((e=>e.slice(1))).join(",")}\r\n`),n.bindingsStream.on("error",(e=>{i.emit("error",e)})),n.bindingsStream.on("data",(e=>{i.push(`${n.variables.map((t=>s.bindingToCsvBindings(e.get(t)))).join(",")}\r\n`)})),n.bindingsStream.on("end",(()=>{i.push(null)})),{data:i}}}t.ActorSparqlSerializeSparqlCsv=s},31052:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(64895),t)},64895:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorSparqlSerializeSparqlTsv=void 0;const a=r(42830),n=r(78432),s=r(71367);class i extends n.ActorSparqlSerializeFixedMediaTypes{constructor(e){super(e)}static bindingToTsvBindings(e){return e?s.termToString(e).replace(/\t/gu,"\\t").replace(/\n/gu,"\\n").replace(/\r/gu,"\\r"):""}async testHandleChecked(e,t){if("bindings"!==e.type)throw new Error("This actor can only handle bindings streams.");return!0}async runHandle(e,t,r){const n=e,s=new a.Readable;return s._read=()=>{},s.push(`${n.variables.map((e=>e.slice(1))).join("\t")}\n`),n.bindingsStream.on("error",(e=>{s.emit("error",e)})),n.bindingsStream.on("data",(e=>{s.push(`${n.variables.map((t=>i.bindingToTsvBindings(e.get(t)))).join("\t")}\n`)})),n.bindingsStream.on("end",(()=>{s.push(null)})),{data:s}}}t.ActorSparqlSerializeSparqlTsv=i},834:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(84624),t)},84624:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorContextPreprocess=void 0;const a=r(41709);class n extends a.Actor{constructor(e){super(e)}}t.ActorContextPreprocess=n},98147:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(30206),t)},30206:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorInit=void 0;const a=r(41709);class n extends a.Actor{constructor(e){super(e)}}t.ActorInit=n},74264:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(70230),t),n(r(96155),t)},70230:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfSerialize=void 0;const a=r(72318);class n extends a.ActorAbstractMediaTyped{constructor(e){super(e)}}t.ActorRdfSerialize=n},96155:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfSerializeFixedMediaTypes=void 0;const a=r(72318);class n extends a.ActorAbstractMediaTypedFixed{constructor(e){super(e)}async testHandleChecked(e){return!0}}t.ActorRdfSerializeFixedMediaTypes=n},48874:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(38884),t)},38884:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ActorRdfUpdateHypermedia=void 0;const a=r(41709);class n extends a.Actor{constructor(e,t){super(e),this.destinationType=t}async test(e){if(e.forceDestinationType&&this.destinationType!==e.forceDestinationType)throw new Error(`Actor ${this.name} is not able to handle destination type ${e.forceDestinationType}.`);return this.testMetadata(e)}}t.ActorRdfUpdateHypermedia=n},6900:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(90575),t),n(r(85448),t)},90575:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JsonLdSerializer=void 0;const a=r(11288),n=r(42830),s=r(75601),i=r(85448);class p extends n.Transform{constructor(e={}){super({objectMode:!0}),this.indentation=0,this.options=e,this.options.baseIRI&&!this.options.context&&(this.options.context={"@base":this.options.baseIRI}),this.options.context?(this.originalContext=this.options.context,this.context=(new a.ContextParser).parse(this.options.context,{baseIRI:this.options.baseIRI})):this.context=Promise.resolve(new a.JsonLdContextNormalized({}))}import(e){const t=new n.PassThrough({objectMode:!0});e.on("error",(e=>r.emit("error",e))),e.on("data",(e=>t.push(e))),e.on("end",(()=>t.push(null)));const r=t.pipe(new p(this.options));return r}_transform(e,t,r){this.context.then((t=>{this.transformQuad(e,t),r()})).catch(r)}async list(e){const t=await this.context;return{"@list":e.map((e=>i.Util.termToValue(e,t,this.options)))}}_flush(e){return this.opened||this.pushDocumentStart(),this.lastPredicate&&this.endPredicate(),this.lastSubject&&this.endSubject(),this.lastGraph&&"DefaultGraph"!==this.lastGraph.termType&&this.endGraph(),this.endDocument(),e(null,null)}transformQuad(e,t){this.opened||this.pushDocumentStart();const r=this.lastGraph&&"DefaultGraph"!==this.lastGraph.termType&&this.lastGraph.equals(e.subject);if(!(r||this.lastGraph&&e.graph.equals(this.lastGraph))){let r="DefaultGraph"!==e.graph.termType&&this.lastSubject&&this.lastSubject.equals(e.graph);this.lastGraph&&("DefaultGraph"!==this.lastGraph.termType?(this.endPredicate(),this.endSubject(),this.endGraph(!0),r=!1):r?(this.endPredicate(!0),this.lastSubject=null):(this.endPredicate(),this.endSubject(!0))),"DefaultGraph"!==e.graph.termType&&(r||this.pushId(e.graph,t),this.pushSeparator(this.options.space?s.SeparatorType.GRAPH_FIELD_NONCOMPACT:s.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++),this.lastGraph=e.graph}this.lastSubject&&e.subject.equals(this.lastSubject)||(r?(this.endPredicate(),this.endSubject(),this.indentation--,this.pushSeparator(s.SeparatorType.ARRAY_END_COMMA),this.lastGraph=e.graph):(this.lastSubject&&(this.endPredicate(),this.endSubject(!0)),this.pushId(e.subject,t)),this.lastSubject=e.subject),this.lastPredicate&&e.predicate.equals(this.lastPredicate)||(this.lastPredicate&&this.endPredicate(!0),this.pushPredicate(e.predicate,t)),this.pushObject(e.object,t)}pushDocumentStart(){this.opened=!0,this.originalContext&&!this.options.excludeContext?(this.pushSeparator(s.SeparatorType.OBJECT_START),this.indentation++,this.pushSeparator(s.SeparatorType.CONTEXT_FIELD),this.pushIndented(JSON.stringify(this.originalContext,null,this.options.space)+","),this.pushSeparator(this.options.space?s.SeparatorType.GRAPH_FIELD_NONCOMPACT:s.SeparatorType.GRAPH_FIELD_COMPACT),this.indentation++):(this.pushSeparator(s.SeparatorType.ARRAY_START),this.indentation++)}pushId(e,t){const r="BlankNode"===e.termType?"_:"+e.value:t.compactIri(e.value,!1);this.pushSeparator(s.SeparatorType.OBJECT_START),this.indentation++,this.pushIndented(this.options.space?`"@id": "${r}",`:`"@id":"${r}",`)}pushPredicate(e,t){let r=e.value;this.options.useRdfType||r!==i.Util.RDF_TYPE||(r="@type",this.objectOptions=Object.assign(Object.assign({},this.options),{compactIds:!0,vocab:!0}));const a=t.compactIri(r,!0);this.pushIndented(this.options.space?`"${a}": [`:`"${a}":[`),this.indentation++,this.lastPredicate=e}pushObject(e,t){let r;this.hadObjectForPredicate?this.pushSeparator(s.SeparatorType.COMMA):this.hadObjectForPredicate=!0;try{r=e["@list"]?e:i.Util.termToValue(e,t,this.objectOptions||this.options)}catch(e){return this.emit("error",e)}this.pushIndented(JSON.stringify(r,null,this.options.space))}endDocument(){this.opened=!1,this.originalContext&&!this.options.excludeContext?(this.indentation--,this.pushSeparator(s.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(s.SeparatorType.OBJECT_END)):(this.indentation--,this.pushSeparator(s.SeparatorType.ARRAY_END))}endPredicate(e){this.indentation--,this.pushSeparator(e?s.SeparatorType.ARRAY_END_COMMA:s.SeparatorType.ARRAY_END),this.hadObjectForPredicate=!1,this.objectOptions=null,this.lastPredicate=null}endSubject(e){this.indentation--,this.pushSeparator(e?s.SeparatorType.OBJECT_END_COMMA:s.SeparatorType.OBJECT_END),this.lastSubject=null}endGraph(e){this.indentation--,this.pushSeparator(s.SeparatorType.ARRAY_END),this.indentation--,this.pushSeparator(e?s.SeparatorType.OBJECT_END_COMMA:s.SeparatorType.OBJECT_END),this.lastGraph=null}pushSeparator(e){this.pushIndented(e.label)}pushIndented(e){const t=this.getIndentPrefix(),r=e.split("\n").map((e=>t+e)).join("\n");this.push(r),this.options.space&&this.push("\n")}getIndentPrefix(){return this.options.space?this.options.space.repeat(this.indentation):""}}t.JsonLdSerializer=p},75601:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SeparatorType=void 0;class r{constructor(e){this.label=e}}t.SeparatorType=r,r.COMMA=new r(","),r.OBJECT_START=new r("{"),r.OBJECT_END=new r("}"),r.OBJECT_END_COMMA=new r("},"),r.ARRAY_START=new r("["),r.ARRAY_END=new r("]"),r.ARRAY_END_COMMA=new r("],"),r.GRAPH_FIELD_NONCOMPACT=new r('"@graph": ['),r.GRAPH_FIELD_COMPACT=new r('"@graph":['),r.CONTEXT_FIELD=new r('"@context":')},85448:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0;const a=r(11288);class n{static termToValue(e,t,r={compactIds:!1,useNativeTypes:!1}){switch(e.termType){case"NamedNode":const s=t.compactIri(e.value,r.vocab);return r.compactIds?s:{"@id":s};case"DefaultGraph":return r.compactIds?e.value:{"@id":e.value};case"BlankNode":const i=`_:${e.value}`;return r.compactIds?i:{"@id":i};case"Literal":if(e.datatype.value===n.RDF_JSON){let t;try{t=JSON.parse(e.value)}catch(e){throw new a.ErrorCoded("Invalid JSON literal: "+e.message,a.ERROR_CODES.INVALID_JSON_LITERAL)}return{"@value":t,"@type":"@json"}}if("i18n-datatype"===r.rdfDirection&&e.datatype.value.startsWith(n.I18N)){const[t,r]=e.datatype.value.substr(n.I18N.length,e.datatype.value.length).split("_");return Object.assign(Object.assign({"@value":e.value},t?{"@language":t}:{}),r?{"@direction":r}:{})}const p=e.datatype.value===n.XSD_STRING,o={"@value":!p&&r.useNativeTypes?n.stringToNativeType(e.value,e.datatype.value):e.value};return e.language?Object.assign(Object.assign({},o),{"@language":e.language}):p||"string"!=typeof o["@value"]?o:Object.assign(Object.assign({},o),{"@type":e.datatype.value})}}static stringToNativeType(e,t){if(t.startsWith(n.XSD))switch(t.substr(n.XSD.length)){case"boolean":if("true"===e)return!0;if("false"===e)return!1;throw new Error(`Invalid xsd:boolean value '${e}'`);case"integer":case"number":case"int":case"byte":case"long":const t=parseInt(e,10);if(isNaN(t))throw new Error(`Invalid xsd:integer value '${e}'`);return t;case"float":case"double":const r=parseFloat(e);if(isNaN(r))throw new Error(`Invalid xsd:float value '${e}'`);return r}return e}}t.Util=n,n.XSD="http://www.w3.org/2001/XMLSchema#",n.XSD_STRING=n.XSD+"string",n.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",n.RDF_TYPE=n.RDF+"type",n.RDF_JSON=n.RDF+"JSON",n.I18N="https://www.w3.org/ns/i18n#"},38793:function(e,t,r){"use strict";var a=this&&this.__createBinding||(Object.create?function(e,t,r,a){void 0===a&&(a=r),Object.defineProperty(e,a,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,a){void 0===a&&(a=r),e[a]=t[r]}),n=this&&this.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||a(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),n(r(55431),t),n(r(6057),t),n(r(53626),t),n(r(17975),t),n(r(63879),t),n(r(29151),t),n(r(414),t),n(r(247),t),n(r(31268),t),n(r(61468),t)},29151:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},414:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},247:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},31268:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MicrodataRdfParser=void 0;const a=r(42830),n=r(23719),s=r(6057),i=r(53626),p=r(17975),o=r(63879),c=r(61468),u=r(1084);class l extends a.Transform{constructor(e){super({readableObjectMode:!0}),this.itemScopeStack=[],this.textBufferStack=[],this.isEmittingReferences=!1,this.pendingItemRefsDomain={},this.pendingItemRefsRangeFinalized={},this.pendingItemRefsRangeCollecting={},e=e||{},this.options=e,this.util=new c.Util(e.dataFactory,e.baseIRI),this.defaultGraph=e.defaultGraph||this.util.dataFactory.defaultGraph(),this.htmlParseListener=e.htmlParseListener,this.vocabRegistry=e.vocabRegistry||u,this.parser=this.initializeParser(!!e.xmlMode)}import(e){const t=new a.PassThrough({readableObjectMode:!0});e.on("error",(e=>r.emit("error",e))),e.on("data",(e=>t.push(e))),e.on("end",(()=>t.push(null)));const r=t.pipe(new l(this.options));return r}_transform(e,t,r){this.parser.write(e),r()}_flush(e){this.parser.end(),e()}getItemScope(e){let t=this.itemScopeStack.length-(e?2:1);for(;t>0&&!this.itemScopeStack[t];)t--;return this.itemScopeStack[t]}getDepth(){return this.itemScopeStack.length}onTagOpen(e,t){if(!this.isEmittingReferences){if("id"in t){const e=t.id;this.pendingItemRefsRangeCollecting[e]={events:[],counter:0,ids:[]}}for(const r of Object.values(this.pendingItemRefsRangeCollecting))r.counter++,r.events.push({type:"open",name:e,attributes:t})}let r;if(this.textBufferStack.push(void 0),"itemscope"in t){let e;if(this.emittingReferencesItemScopeIdGenerator)e=this.emittingReferencesItemScopeIdGenerator();else{e="itemid"in t&&this.util.createSubject(t.itemid)||this.util.dataFactory.blankNode();for(const t of Object.values(this.pendingItemRefsRangeCollecting))t.ids.push(e)}r={subject:e},this.isEmittingReferences&&(r.blockEmission=!0);const a=this.getItemScope();a&&a.vocab&&(r.vocab=a.vocab),this.itemScopeStack.push(r)}else r=this.getItemScope(),this.itemScopeStack.push(void 0);if(r){if("itemtype"in t)for(const e of this.util.createVocabIris(t.itemtype,r,!1))r.vocab||(r.vocab=this.util.deriveVocab(e.value,this.vocabRegistry)),r.blockEmission||this.emitTriple(r.subject,this.util.dataFactory.namedNode(`${c.Util.RDF}type`),e);if("lang"in t&&(r.language=t.lang),"xml:lang"in t&&(r.language=t["xml:lang"]),"itemscope"in t&&!this.isEmittingReferences&&"itemref"in t)for(const e of t.itemref.split(/\s+/u))e in this.pendingItemRefsDomain||(this.pendingItemRefsDomain[e]=[]),this.pendingItemRefsDomain[e].push(r),this.tryToEmitReferences(e,r)}"itemprop"in t&&this.handleItemProperties(t.itemprop,!1,r,e,t),"itemprop-reverse"in t&&this.handleItemProperties(t["itemprop-reverse"],!0,r,e,t)}onText(e){if(!this.isEmittingReferences)for(const t of Object.values(this.pendingItemRefsRangeCollecting))t.events.push({type:"text",data:e});for(const t of this.textBufferStack)t&&t.push(e)}onTagClose(){if(!this.isEmittingReferences)for(const[e,t]of Object.entries(this.pendingItemRefsRangeCollecting))t.counter--,t.events.push({type:"close"}),0===t.counter&&(this.pendingItemRefsRangeFinalized[e]=t,delete this.pendingItemRefsRangeCollecting[e],this.tryToEmitReferences(e));const e=this.getItemScope(!0);if(e){const t=this.getDepth();if(e.predicates&&t in e.predicates)for(const[r,a]of Object.entries(e.predicates[t])){const n=this.util.createLiteral(this.textBufferStack[t].join(""),e);this.emitPredicateTriples(e,a,n,"reverse"===r),delete e.predicates[t][r]}}this.itemScopeStack.pop(),this.textBufferStack.pop()}onEnd(){}initializeParser(e){return new n.Parser({onclosetag:()=>{try{this.onTagClose(),this.htmlParseListener&&this.htmlParseListener.onTagClose()}catch(e){this.emit("error",e)}},onend:()=>{try{this.onEnd(),this.htmlParseListener&&this.htmlParseListener.onEnd()}catch(e){this.emit("error",e)}},onopentag:(e,t)=>{try{this.onTagOpen(e,t),this.htmlParseListener&&this.htmlParseListener.onTagOpen(e,t)}catch(e){this.emit("error",e)}},ontext:e=>{try{this.onText(e),this.htmlParseListener&&this.htmlParseListener.onText(e)}catch(e){this.emit("error",e)}}},{decodeEntities:!0,recognizeSelfClosing:!0,xmlMode:e})}handleItemProperties(e,t,r,a,n){const s=this.getItemScope(!0);if(s){const i=this.getDepth(),p=this.util.createVocabIris(e,s,!0);s.predicates||(s.predicates={}),s.predicates[i]||(s.predicates[i]={});const o=t?"reverse":"forward";s.predicates[i][o]=p;for(const t of this.util.getVocabularyExpansionType(e,s,this.vocabRegistry))p.push(t);if(r&&"itemscope"in n)this.emitPredicateTriples(s,p,r.subject,t),delete s.predicates[i][o];else for(const e of l.ITEM_PROPERTY_HANDLERS)if(e.canHandle(a,n)){const r=e.getObject(n,this.util,s);this.emitPredicateTriples(s,p,r,t),delete s.predicates[i][o]}s.predicates[i][o]&&(this.textBufferStack[i]=[])}}emitPredicateTriples(e,t,r,a){if(!e.blockEmission)for(const n of t)a?"Literal"!==r.termType&&this.emitTriple(r,n,e.subject):this.emitTriple(e.subject,n,r)}emitTriple(e,t,r){this.push(this.util.dataFactory.quad(e,t,r,this.defaultGraph))}tryToEmitReferences(e,t){const r=this.pendingItemRefsRangeFinalized[e];if(r){let a;if(t){a=[t];const r=this.pendingItemRefsDomain[e].indexOf(t);this.pendingItemRefsDomain[e].splice(r,1)}else a=this.pendingItemRefsDomain[e],delete this.pendingItemRefsDomain[e];if(a){const e=this.itemScopeStack,t=this.textBufferStack;this.isEmittingReferences=!0;for(const e of a){this.itemScopeStack=[e],this.textBufferStack=[void 0];const t=r.ids.slice();this.emittingReferencesItemScopeIdGenerator=()=>t.shift();for(const e of r.events)switch(e.type){case"open":this.onTagOpen(e.name,e.attributes);break;case"text":this.onText(e.data);break;case"close":this.onTagClose()}}this.emittingReferencesItemScopeIdGenerator=void 0,this.itemScopeStack=e,this.textBufferStack=t,this.isEmittingReferences=!1}}}}t.MicrodataRdfParser=l,l.ITEM_PROPERTY_HANDLERS=[new s.ItemPropertyHandlerContent,new o.ItemPropertyHandlerUrl("a","href"),new o.ItemPropertyHandlerUrl("area","href"),new o.ItemPropertyHandlerUrl("audio","src"),new o.ItemPropertyHandlerUrl("embed","src"),new o.ItemPropertyHandlerUrl("iframe","src"),new o.ItemPropertyHandlerUrl("img","src"),new o.ItemPropertyHandlerUrl("link","href"),new o.ItemPropertyHandlerUrl("object","data"),new o.ItemPropertyHandlerUrl("source","src"),new o.ItemPropertyHandlerUrl("track","src"),new o.ItemPropertyHandlerUrl("video","src"),new i.ItemPropertyHandlerNumber("data","value"),new i.ItemPropertyHandlerNumber("meter","value"),new p.ItemPropertyHandlerTime]},61468:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Util=void 0;const a=r(41640),n=r(68912);class s{constructor(e,t){this.dataFactory=e||new a.DataFactory,this.baseIRI=t||""}static isValidIri(e){return s.IRI_REGEX.test(e)}createVocabIris(e,t,r){return e.split(/\s+/u).filter((e=>!!e)).map((e=>{if(!s.isValidIri(e)){if(!r)return;e=`${t.vocab||`${this.baseIRI}#`}${e}`}return this.dataFactory.namedNode(e)})).filter((e=>!!e))}getVocabularyExpansionType(e,t,r){const a=e.split(/\s+/u);if(a.includes("subPropertyOf")||a.includes("equivalentProperty"))return[this.dataFactory.namedNode(`${s.RDF}type`)];if(t.vocab&&t.vocab in r&&r[t.vocab].properties){let e=[];for(const[n,s]of Object.entries(r[t.vocab].properties))a.includes(n)&&(e=e.concat(Object.values(s).map((e=>this.dataFactory.namedNode(e)))));return e}return[]}createSubject(e){if(!s.isValidIri(e))try{e=n.resolve(e,this.baseIRI)}catch(e){return}return this.dataFactory.namedNode(e)}createLiteral(e,t){return this.dataFactory.literal(e,t.language)}deriveVocab(e,t){let r;for(const a in t)if(e.startsWith(a)){r=a,r.endsWith("/")||(r+="#");break}if(!r){const t=e.indexOf("#");r=t>0?e.slice(0,t+1):n.resolve(".",e)}return r}}t.Util=s,s.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",s.XSD="http://www.w3.org/2001/XMLSchema#",s.RDFA="http://www.w3.org/ns/rdfa#",s.IRI_REGEX=/^([A-Za-z][\d+-.A-Za-z]*|_):[^ "<>[\\\]`{|}]*$/u},55431:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0})},6057:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemPropertyHandlerContent=void 0,t.ItemPropertyHandlerContent=class{canHandle(e,t){return"content"in t}getObject(e,t,r){return t.createLiteral(e.content,r)}}},53626:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemPropertyHandlerNumber=void 0;const a=r(61468);t.ItemPropertyHandlerNumber=class{constructor(e,t){this.tagName=e,this.attributeName=t}canHandle(e,t){return this.tagName===e&&this.attributeName in t}getObject(e,t,r){const n=e[this.attributeName];let s;return Number.isNaN(Number.parseInt(n,10))||n.includes(".")?Number.isNaN(Number.parseFloat(n))||(s=`${a.Util.XSD}double`):s=`${a.Util.XSD}integer`,t.dataFactory.literal(n,s&&t.dataFactory.namedNode(s))}}},17975:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemPropertyHandlerTime=void 0;const a=r(61468);class n{canHandle(e,t){return"time"===e&&"datetime"in t}getObject(e,t,r){const s=e.datetime;let i;for(const e of n.TIME_REGEXES)if(e.regex.exec(s)){i=t.dataFactory.namedNode(a.Util.XSD+e.type);break}return t.dataFactory.literal(s,i)}}t.ItemPropertyHandlerTime=n,n.TIME_REGEXES=[{regex:/^-?P(\d+Y)?(\d+M)?(\d+D)?(T(\d+H)?(\d+M)?(\d+(\.\d)?S)?)?$/u,type:"duration"},{regex:/^\d+-\d\d-\d\dT\d\d:\d\d:\d\d((Z?)|([+-]\d\d:\d\d))$/u,type:"dateTime"},{regex:/^\d+-\d\d-\d\dZ?$/u,type:"date"},{regex:/^\d\d:\d\d:\d\d((Z?)|([+-]\d\d:\d\d))$/u,type:"time"},{regex:/^\d+-\d\d$/u,type:"gYearMonth"},{regex:/^\d+$/u,type:"gYear"}]},63879:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ItemPropertyHandlerUrl=void 0;const a=r(68912);t.ItemPropertyHandlerUrl=class{constructor(e,t){this.tagName=e,this.attributeName=t}canHandle(e,t){return this.tagName===e&&this.attributeName in t}getObject(e,t,r){return t.dataFactory.namedNode(a.resolve(e[this.attributeName],t.baseIRI))}}},28490:(e,t,r)=>{"use strict";var a=r(17673),n=r(8575),s=r(47529);function i(e){return e&&e.rel}function p(e,t){return t.rel.split(/\s+/).forEach((function(r){e[r]=s(t,{rel:r})})),e}function o(e,t){var r=t.match(/\s*(.+)\s*=\s*"?([^"]+)"?/);return r&&(e[r[1]]=r[2]),e}function c(e){try{var t=e.match(/<?([^>]*)>(.*)/),r=t[1],i=t[2].split(";"),p=n.parse(r),c=a.parse(p.query);i.shift();var u=i.reduce(o,{});return(u=s(c,u)).url=r,u}catch(e){return null}}e.exports=function(e){return e?e.split(/,\s*</).map(c).filter(i).reduce(p,{}):null}},62587:e=>{"use strict";function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,r,a,n){r=r||"&",a=a||"=";var s={};if("string"!=typeof e||0===e.length)return s;var i=/\+/g;e=e.split(r);var p=1e3;n&&"number"==typeof n.maxKeys&&(p=n.maxKeys);var o=e.length;p>0&&o>p&&(o=p);for(var c=0;c<o;++c){var u,l,d,y,f=e[c].replace(i,"%20"),h=f.indexOf(a);h>=0?(u=f.substr(0,h),l=f.substr(h+1)):(u=f,l=""),d=decodeURIComponent(u),y=decodeURIComponent(l),t(s,d)?Array.isArray(s[d])?s[d].push(y):s[d]=[s[d],y]:s[d]=y}return s}},12361:e=>{"use strict";var t=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,r,a,n){return r=r||"&",a=a||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(n){var s=encodeURIComponent(t(n))+a;return Array.isArray(e[n])?e[n].map((function(e){return s+encodeURIComponent(t(e))})).join(r):s+encodeURIComponent(t(e[n]))})).join(r):n?encodeURIComponent(t(n))+a+encodeURIComponent(t(e)):""}},17673:(e,t,r)=>{"use strict";t.decode=t.parse=r(62587),t.encode=t.stringify=r(12361)},71367:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.termToString=t.stringToTerm=t.stringQuadToQuad=t.quadToStringQuad=t.getLiteralValue=t.getLiteralType=t.getLiteralLanguage=void 0;const a=r(49803);Object.defineProperty(t,"getLiteralLanguage",{enumerable:!0,get:function(){return a.getLiteralLanguage}}),Object.defineProperty(t,"getLiteralType",{enumerable:!0,get:function(){return a.getLiteralType}}),Object.defineProperty(t,"getLiteralValue",{enumerable:!0,get:function(){return a.getLiteralValue}}),Object.defineProperty(t,"quadToStringQuad",{enumerable:!0,get:function(){return a.quadToStringQuad}}),Object.defineProperty(t,"stringQuadToQuad",{enumerable:!0,get:function(){return a.stringQuadToQuad}}),Object.defineProperty(t,"stringToTerm",{enumerable:!0,get:function(){return a.stringToTerm}}),Object.defineProperty(t,"termToString",{enumerable:!0,get:function(){return a.termToString}})},49803:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stringQuadToQuad=t.quadToStringQuad=t.stringToTerm=t.getLiteralLanguage=t.getLiteralType=t.getLiteralValue=t.termToString=void 0;const a=new(r(41640).DataFactory);function n(e){if(e)switch(e.termType){case"NamedNode":return"<"+e.value+">";case"BlankNode":return"_:"+e.value;case"Literal":const t=e;return'"'+t.value.replace(/"/gu,'\\"')+'"'+(t.datatype&&"http://www.w3.org/2001/XMLSchema#string"!==t.datatype.value&&"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"!==t.datatype.value?"^^<"+t.datatype.value+">":"")+(t.language?"@"+t.language:"");case"Quad":return`<<${n(e.subject)} ${n(e.predicate)} ${n(e.object)}${"DefaultGraph"===e.graph.termType?"":" "+n(e.graph)}>>`;case"Variable":return"?"+e.value;case"DefaultGraph":return e.value}}function s(e){const t=/^"([^]*)"((\^\^.*)|(@.*))?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1].replace(/\\"/gu,'"')}function i(e){const t=/^"[^]*"(?:\^\^<([^"]+)>|(@)[^@"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]||(t[2]?"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString":"http://www.w3.org/2001/XMLSchema#string")}function p(e){const t=/^"[^]*"(?:@([^@"]+)|\^\^[^"]+)?$/.exec(e);if(!t)throw new Error(e+" is not a literal");return t[1]?t[1].toLowerCase():""}function o(e,t){if(t=t||a,!e||!e.length)return t.defaultGraph();switch(e[0]){case"_":return t.blankNode(e.substr(2));case"?":if(!t.variable)throw new Error("Missing 'variable()' method on the given DataFactory");return t.variable(e.substr(1));case'"':const r=p(e),a=t.namedNode(i(e));return t.literal(s(e),r||a);default:if(e.startsWith("<<")&&e.endsWith(">>")){const r=e.slice(2,-2),a=[];let n=0,s=0;for(let t=0;t<r.length;t++){const i=r[t];if("<"===i&&n++,">"===i){if(0===n)throw new Error("Found closing tag without opening tag in "+e);n--}" "===i&&0===n&&(a.push(r.slice(s,t)),s=t+1)}if(0!==n)throw new Error("Found opening tag without closing tag in "+e);if(a.push(r.slice(s,r.length)),3!==a.length&&4!==a.length)throw new Error("Nested quad syntax error "+e);return t.quad(o(a[0]),o(a[1]),o(a[2]),a[3]?o(a[3]):void 0)}if("<"!==e.charAt(0)||">"!==e.charAt(e.length-1))throw new Error(`Detected invalid iri for named node (must be wrapped in <>): ${e}`);return t.namedNode(e.substring(1,e.length-1))}}t.termToString=n,t.getLiteralValue=s,t.getLiteralType=i,t.getLiteralLanguage=p,t.stringToTerm=o,t.quadToStringQuad=function(e){return{subject:n(e.subject),predicate:n(e.predicate),object:n(e.object),graph:n(e.graph)}},t.stringQuadToQuad=function(e,t){return(t=t||a).quad(o(e.subject,t),o(e.predicate,t),o(e.object,t),o(e.graph,t))}},52511:function(e,t,r){var a;e=r.nmd(e),function(n){t&&t.nodeType,e&&e.nodeType;var s="object"==typeof r.g&&r.g;s.global!==s&&s.window!==s&&s.self;var i,p=2147483647,o=36,c=/^xn--/,u=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},y=Math.floor,f=String.fromCharCode;function h(e){throw RangeError(d[e])}function m(e,t){for(var r=e.length,a=[];r--;)a[r]=t(e[r]);return a}function g(e,t){var r=e.split("@"),a="";return r.length>1&&(a=r[0]+"@",e=r[1]),a+m((e=e.replace(l,".")).split("."),t).join(".")}function E(e){for(var t,r,a=[],n=0,s=e.length;n<s;)(t=e.charCodeAt(n++))>=55296&&t<=56319&&n<s?56320==(64512&(r=e.charCodeAt(n++)))?a.push(((1023&t)<<10)+(1023&r)+65536):(a.push(t),n--):a.push(t);return a}function b(e){return m(e,(function(e){var t="";return e>65535&&(t+=f((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+f(e)})).join("")}function T(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function O(e,t,r){var a=0;for(e=r?y(e/700):e>>1,e+=y(e/t);e>455;a+=o)e=y(e/35);return y(a+36*e/(e+38))}function R(e){var t,r,a,n,s,i,c,u,l,d,f,m=[],g=e.length,E=0,T=128,R=72;for((r=e.lastIndexOf("-"))<0&&(r=0),a=0;a<r;++a)e.charCodeAt(a)>=128&&h("not-basic"),m.push(e.charCodeAt(a));for(n=r>0?r+1:0;n<g;){for(s=E,i=1,c=o;n>=g&&h("invalid-input"),((u=(f=e.charCodeAt(n++))-48<10?f-22:f-65<26?f-65:f-97<26?f-97:o)>=o||u>y((p-E)/i))&&h("overflow"),E+=u*i,!(u<(l=c<=R?1:c>=R+26?26:c-R));c+=o)i>y(p/(d=o-l))&&h("overflow"),i*=d;R=O(E-s,t=m.length+1,0==s),y(E/t)>p-T&&h("overflow"),T+=y(E/t),E%=t,m.splice(E++,0,T)}return b(m)}function S(e){var t,r,a,n,s,i,c,u,l,d,m,g,b,R,S,v=[];for(g=(e=E(e)).length,t=128,r=0,s=72,i=0;i<g;++i)(m=e[i])<128&&v.push(f(m));for(a=n=v.length,n&&v.push("-");a<g;){for(c=p,i=0;i<g;++i)(m=e[i])>=t&&m<c&&(c=m);for(c-t>y((p-r)/(b=a+1))&&h("overflow"),r+=(c-t)*b,t=c,i=0;i<g;++i)if((m=e[i])<t&&++r>p&&h("overflow"),m==t){for(u=r,l=o;!(u<(d=l<=s?1:l>=s+26?26:l-s));l+=o)S=u-d,R=o-d,v.push(f(T(d+S%R,0))),u=y(S/R);v.push(f(T(u,0))),s=O(r,b,a==n),r=0,++a}++r,++t}return v.join("")}i={version:"1.3.2",ucs2:{decode:E,encode:b},decode:R,encode:S,toASCII:function(e){return g(e,(function(e){return u.test(e)?"xn--"+S(e):e}))},toUnicode:function(e){return g(e,(function(e){return c.test(e)?R(e.slice(4).toLowerCase()):e}))}},void 0===(a=function(){return i}.call(t,r,t,e))||(e.exports=a)}()},8575:(e,t,r)=>{"use strict";var a=r(52511),n=r(62502);function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=b,t.resolve=function(e,t){return b(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?b(e,!1,!0).resolveObject(t):t},t.format=function(e){return n.isString(e)&&(e=b(e)),e instanceof s?e.format():s.prototype.format.call(e)},t.Url=s;var i=/^([a-z0-9.+-]+:)/i,p=/:[0-9]*$/,o=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,c=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),u=["'"].concat(c),l=["%","/","?",";","#"].concat(u),d=["/","?","#"],y=/^[+a-z0-9A-Z_-]{0,63}$/,f=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,h={javascript:!0,"javascript:":!0},m={javascript:!0,"javascript:":!0},g={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=r(17673);function b(e,t,r){if(e&&n.isObject(e)&&e instanceof s)return e;var a=new s;return a.parse(e,t,r),a}s.prototype.parse=function(e,t,r){if(!n.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var s=e.indexOf("?"),p=-1!==s&&s<e.indexOf("#")?"?":"#",c=e.split(p);c[0]=c[0].replace(/\\/g,"/");var b=e=c.join(p);if(b=b.trim(),!r&&1===e.split("#").length){var T=o.exec(b);if(T)return this.path=b,this.href=b,this.pathname=T[1],T[2]?(this.search=T[2],this.query=t?E.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var O=i.exec(b);if(O){var R=(O=O[0]).toLowerCase();this.protocol=R,b=b.substr(O.length)}if(r||O||b.match(/^\/\/[^@\/]+@[^@\/]+/)){var S="//"===b.substr(0,2);!S||O&&m[O]||(b=b.substr(2),this.slashes=!0)}if(!m[O]&&(S||O&&!g[O])){for(var v,w,P=-1,A=0;A<d.length;A++)-1!==(x=b.indexOf(d[A]))&&(-1===P||x<P)&&(P=x);for(-1!==(w=-1===P?b.lastIndexOf("@"):b.lastIndexOf("@",P))&&(v=b.slice(0,w),b=b.slice(w+1),this.auth=decodeURIComponent(v)),P=-1,A=0;A<l.length;A++){var x;-1!==(x=b.indexOf(l[A]))&&(-1===P||x<P)&&(P=x)}-1===P&&(P=b.length),this.host=b.slice(0,P),b=b.slice(P),this.parseHost(),this.hostname=this.hostname||"";var j="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!j)for(var N=this.hostname.split(/\./),_=(A=0,N.length);A<_;A++){var I=N[A];if(I&&!I.match(y)){for(var C="",D=0,q=I.length;D<q;D++)I.charCodeAt(D)>127?C+="x":C+=I[D];if(!C.match(y)){var M=N.slice(0,A),L=N.slice(A+1),k=I.match(f);k&&(M.push(k[1]),L.unshift(k[2])),L.length&&(b="/"+L.join(".")+b),this.hostname=M.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),j||(this.hostname=a.toASCII(this.hostname));var U=this.port?":"+this.port:"",G=this.hostname||"";this.host=G+U,this.href+=this.host,j&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==b[0]&&(b="/"+b))}if(!h[R])for(A=0,_=u.length;A<_;A++){var H=u[A];if(-1!==b.indexOf(H)){var B=encodeURIComponent(H);B===H&&(B=escape(H)),b=b.split(H).join(B)}}var F=b.indexOf("#");-1!==F&&(this.hash=b.substr(F),b=b.slice(0,F));var Q=b.indexOf("?");if(-1!==Q?(this.search=b.substr(Q),this.query=b.substr(Q+1),t&&(this.query=E.parse(this.query)),b=b.slice(0,Q)):t&&(this.search="",this.query={}),b&&(this.pathname=b),g[R]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){U=this.pathname||"";var J=this.search||"";this.path=U+J}return this.href=this.format(),this},s.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",a=this.hash||"",s=!1,i="";this.host?s=e+this.host:this.hostname&&(s=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(s+=":"+this.port)),this.query&&n.isObject(this.query)&&Object.keys(this.query).length&&(i=E.stringify(this.query));var p=this.search||i&&"?"+i||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||g[t])&&!1!==s?(s="//"+(s||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):s||(s=""),a&&"#"!==a.charAt(0)&&(a="#"+a),p&&"?"!==p.charAt(0)&&(p="?"+p),t+s+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(p=p.replace("#","%23"))+a},s.prototype.resolve=function(e){return this.resolveObject(b(e,!1,!0)).format()},s.prototype.resolveObject=function(e){if(n.isString(e)){var t=new s;t.parse(e,!1,!0),e=t}for(var r=new s,a=Object.keys(this),i=0;i<a.length;i++){var p=a[i];r[p]=this[p]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var o=Object.keys(e),c=0;c<o.length;c++){var u=o[c];"protocol"!==u&&(r[u]=e[u])}return g[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!g[e.protocol]){for(var l=Object.keys(e),d=0;d<l.length;d++){var y=l[d];r[y]=e[y]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||m[e.protocol])r.pathname=e.pathname;else{for(var f=(e.pathname||"").split("/");f.length&&!(e.host=f.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==f[0]&&f.unshift(""),f.length<2&&f.unshift(""),r.pathname=f.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var h=r.pathname||"",E=r.search||"";r.path=h+E}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var b=r.pathname&&"/"===r.pathname.charAt(0),T=e.host||e.pathname&&"/"===e.pathname.charAt(0),O=T||b||r.host&&e.pathname,R=O,S=r.pathname&&r.pathname.split("/")||[],v=(f=e.pathname&&e.pathname.split("/")||[],r.protocol&&!g[r.protocol]);if(v&&(r.hostname="",r.port=null,r.host&&(""===S[0]?S[0]=r.host:S.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===f[0]?f[0]=e.host:f.unshift(e.host)),e.host=null),O=O&&(""===f[0]||""===S[0])),T)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,S=f;else if(f.length)S||(S=[]),S.pop(),S=S.concat(f),r.search=e.search,r.query=e.query;else if(!n.isNullOrUndefined(e.search))return v&&(r.hostname=r.host=S.shift(),(j=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=j.shift(),r.host=r.hostname=j.shift())),r.search=e.search,r.query=e.query,n.isNull(r.pathname)&&n.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r;if(!S.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var w=S.slice(-1)[0],P=(r.host||e.host||S.length>1)&&("."===w||".."===w)||""===w,A=0,x=S.length;x>=0;x--)"."===(w=S[x])?S.splice(x,1):".."===w?(S.splice(x,1),A++):A&&(S.splice(x,1),A--);if(!O&&!R)for(;A--;A)S.unshift("..");!O||""===S[0]||S[0]&&"/"===S[0].charAt(0)||S.unshift(""),P&&"/"!==S.join("/").substr(-1)&&S.push("");var j,N=""===S[0]||S[0]&&"/"===S[0].charAt(0);return v&&(r.hostname=r.host=N?"":S.length?S.shift():"",(j=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=j.shift(),r.host=r.hostname=j.shift())),(O=O||r.host&&S.length)&&!N&&S.unshift(""),S.length?r.pathname=S.join("/"):(r.pathname=null,r.path=null),n.isNull(r.pathname)&&n.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},s.prototype.parseHost=function(){var e=this.host,t=p.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},62502:e=>{"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},47529:e=>{e.exports=function(){for(var e={},r=0;r<arguments.length;r++){var a=arguments[r];for(var n in a)t.call(a,n)&&(e[n]=a[n])}return e};var t=Object.prototype.hasOwnProperty},1084:e=>{"use strict";e.exports=JSON.parse('{"http://schema.org/":{"properties":{"additionalType":{"subPropertyOf":"http://www.w3.org/1999/02/22-rdf-syntax-ns#type"}}},"http://microformats.org/profile/hcard":{}}')}}]);